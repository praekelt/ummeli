/*

  OpenLayers.js -- OpenLayers Map Viewer Library

  Copyright (c) 2006-2012 by OpenLayers Contributors
  Published under the 2-clause BSD license.
  See http://openlayers.org/dev/license.txt for the full text of the license, and http://openlayers.org/dev/authors.txt for full list of contributors.

  Includes compressed code under the following licenses:

  (For uncompressed versions of the code used, please see the
  OpenLayers Github repository: <https://github.com/openlayers/openlayers>)

*//**
 * Contains XMLHttpRequest.js <http://code.google.com/p/xmlhttprequest/>
 * Copyright 2007 Sergey Ilinsky (http://www.ilinsky.com)
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 *//**
 * OpenLayers.Util.pagePosition is based on Yahoo's getXY method, which is
 * Copyright (c) 2006, Yahoo! Inc.
 * All rights reserved.
 * 
 * Redistribution and use of this software in source and binary forms, with or
 * without modification, are permitted provided that the following conditions
 * are met:
 * 
 * * Redistributions of source code must retain the above copyright notice,
 *   this list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 * 
 * * Neither the name of Yahoo! Inc. nor the names of its contributors may be
 *   used to endorse or promote products derived from this software without
 *   specific prior written permission of Yahoo! Inc.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE 
 * POSSIBILITY OF SUCH DAMAGE.
 *//* ======================================================================
    OpenLayers/SingleFile.js
   ====================================================================== *//* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for 
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */var OpenLayers={VERSION_NUMBER:"Release 2.12",singleFile:!0,_getScriptLocation:function(){var e=new RegExp("(^|(.*?\\/))(OpenLayers[^\\/]*?\\.js)(\\?|$)"),t=document.getElementsByTagName("script"),n,r,i="";for(var s=0,o=t.length;s<o;s++){n=t[s].getAttribute("src");if(n){r=n.match(e);if(r){i=r[1];break}}}return function(){return i}}(),ImgPath:""};OpenLayers.Class=function(){var e=arguments.length,t=arguments[0],n=arguments[e-1],r=typeof n.initialize=="function"?n.initialize:function(){t.prototype.initialize.apply(this,arguments)};if(e>1){var i=[r,t].concat(Array.prototype.slice.call(arguments).slice(1,e-1),n);OpenLayers.inherit.apply(null,i)}else r.prototype=n;return r},OpenLayers.inherit=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n;var r,i,s;for(r=2,i=arguments.length;r<i;r++)s=arguments[r],typeof s=="function"&&(s=s.prototype),OpenLayers.Util.extend(e.prototype,s)},OpenLayers.Util=OpenLayers.Util||{},OpenLayers.Util.extend=function(e,t){e=e||{};if(t){for(var n in t){var r=t[n];r!==undefined&&(e[n]=r)}var i=typeof window.Event=="function"&&t instanceof window.Event;!i&&t.hasOwnProperty&&t.hasOwnProperty("toString")&&(e.toString=t.toString)}return e},OpenLayers.String={startsWith:function(e,t){return e.indexOf(t)==0},contains:function(e,t){return e.indexOf(t)!=-1},trim:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(e){var t=e.split("-"),n=t[0];for(var r=1,i=t.length;r<i;r++){var s=t[r];n+=s.charAt(0).toUpperCase()+s.substring(1)}return n},format:function(e,t,n){t||(t=window);var r=function(e,r){var i,s=r.split(/\.+/);for(var o=0;o<s.length;o++)o==0&&(i=t),i=i[s[o]];return typeof i=="function"&&(i=n?i.apply(null,n):i()),typeof i=="undefined"?"undefined":i};return e.replace(OpenLayers.String.tokenRegEx,r)},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(e){return OpenLayers.String.numberRegEx.test(e)},numericIf:function(e){return OpenLayers.String.isNumeric(e)?parseFloat(e):e}},OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(e,t){var n=0;return t>0&&(n=parseFloat(e.toPrecision(t))),n},format:function(e,t,n,r){t=typeof t!="undefined"?t:0,n=typeof n!="undefined"?n:OpenLayers.Number.thousandsSeparator,r=typeof r!="undefined"?r:OpenLayers.Number.decimalSeparator,t!=null&&(e=parseFloat(e.toFixed(t)));var i=e.toString().split(".");i.length==1&&t==null&&(t=0);var s=i[0];if(n){var o=/(-?[0-9]+)([0-9]{3})/;while(o.test(s))s=s.replace(o,"$1"+n+"$2")}var u;if(t==0)u=s;else{var a=i.length>1?i[1]:"0";t!=null&&(a+=(new Array(t-a.length+1)).join("0")),u=s+r+a}return u}},OpenLayers.Function={bind:function(e,t){var n=Array.prototype.slice.apply(arguments,[2]);return function(){var r=n.concat(Array.prototype.slice.apply(arguments,[0]));return e.apply(t,r)}},bindAsEventListener:function(e,t){return function(n){return e.call(t,n||window.event)}},False:function(){return!1},True:function(){return!0},Void:function(){}},OpenLayers.Array={filter:function(e,t,n){var r=[];if(Array.prototype.filter)r=e.filter(t,n);else{var i=e.length;if(typeof t!="function")throw new TypeError;for(var s=0;s<i;s++)if(s in e){var o=e[s];t.call(n,o,s,e)&&r.push(o)}}return r}},OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(e,t,n,r){OpenLayers.Util.isArray(e)&&(r=e[3],n=e[2],t=e[1],e=e[0]),e!=null&&(this.left=OpenLayers.Util.toFloat(e)),t!=null&&(this.bottom=OpenLayers.Util.toFloat(t)),n!=null&&(this.right=OpenLayers.Util.toFloat(n)),r!=null&&(this.top=OpenLayers.Util.toFloat(r))},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(e){var t=!1;return e!=null&&(t=this.left==e.left&&this.right==e.right&&this.top==e.top&&this.bottom==e.bottom),t},toString:function(){return[this.left,this.bottom,this.right,this.top].join(",")},toArray:function(e){return e===!0?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]},toBBOX:function(e,t){e==null&&(e=6);var n=Math.pow(10,e),r=Math.round(this.left*n)/n,i=Math.round(this.bottom*n)/n,s=Math.round(this.right*n)/n,o=Math.round(this.top*n)/n;return t===!0?i+","+r+","+o+","+s:r+","+i+","+s+","+o},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())},getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){return this.centerLonLat||(this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2)),this.centerLonLat},scale:function(e,t){t==null&&(t=this.getCenterLonLat());var n,r;t.CLASS_NAME=="OpenLayers.LonLat"?(n=t.lon,r=t.lat):(n=t.x,r=t.y);var i=(this.left-n)*e+n,s=(this.bottom-r)*e+r,o=(this.right-n)*e+n,u=(this.top-r)*e+r;return new OpenLayers.Bounds(i,s,o,u)},add:function(e,t){if(e==null||t==null)throw new TypeError("Bounds.add cannot receive null values");return new OpenLayers.Bounds(this.left+e,this.bottom+t,this.right+e,this.top+t)},extend:function(e){var t=null;if(e){switch(e.CLASS_NAME){case"OpenLayers.LonLat":t=new OpenLayers.Bounds(e.lon,e.lat,e.lon,e.lat);break;case"OpenLayers.Geometry.Point":t=new OpenLayers.Bounds(e.x,e.y,e.x,e.y);break;case"OpenLayers.Bounds":t=e}if(t){this.centerLonLat=null;if(this.left==null||t.left<this.left)this.left=t.left;if(this.bottom==null||t.bottom<this.bottom)this.bottom=t.bottom;if(this.right==null||t.right>this.right)this.right=t.right;if(this.top==null||t.top>this.top)this.top=t.top}}},containsLonLat:function(e,t){typeof t=="boolean"&&(t={inclusive:t}),t=t||{};var n=this.contains(e.lon,e.lat,t.inclusive),r=t.worldBounds;if(r&&!n){var i=r.getWidth(),s=(r.left+r.right)/2,o=Math.round((e.lon-s)/i);n=this.containsLonLat({lon:e.lon-o*i,lat:e.lat},{inclusive:t.inclusive})}return n},containsPixel:function(e,t){return this.contains(e.x,e.y,t)},contains:function(e,t,n){n==null&&(n=!0);if(e==null||t==null)return!1;e=OpenLayers.Util.toFloat(e),t=OpenLayers.Util.toFloat(t);var r=!1;return n?r=e>=this.left&&e<=this.right&&t>=this.bottom&&t<=this.top:r=e>this.left&&e<this.right&&t>this.bottom&&t<this.top,r},intersectsBounds:function(e,t){typeof t=="boolean"&&(t={inclusive:t}),t=t||{};if(t.worldBounds){var n=this.wrapDateLine(t.worldBounds);e=e.wrapDateLine(t.worldBounds)}else n=this;t.inclusive==null&&(t.inclusive=!0);var r=!1,i=n.left==e.right||n.right==e.left||n.top==e.bottom||n.bottom==e.top;if(t.inclusive||!i){var s=e.bottom>=n.bottom&&e.bottom<=n.top||n.bottom>=e.bottom&&n.bottom<=e.top,o=e.top>=n.bottom&&e.top<=n.top||n.top>e.bottom&&n.top<e.top,u=e.left>=n.left&&e.left<=n.right||n.left>=e.left&&n.left<=e.right,a=e.right>=n.left&&e.right<=n.right||n.right>=e.left&&n.right<=e.right;r=(s||o)&&(u||a)}if(t.worldBounds&&!r){var f=t.worldBounds,l=f.getWidth(),c=!f.containsBounds(n),h=!f.containsBounds(e);c&&!h?(e=e.add(-l,0),r=n.intersectsBounds(e,{inclusive:t.inclusive})):h&&!c&&(n=n.add(-l,0),r=e.intersectsBounds(n,{inclusive:t.inclusive}))}return r},containsBounds:function(e,t,n){t==null&&(t=!1),n==null&&(n=!0);var r=this.contains(e.left,e.bottom,n),i=this.contains(e.right,e.bottom,n),s=this.contains(e.left,e.top,n),o=this.contains(e.right,e.top,n);return t?r||i||s||o:r&&i&&s&&o},determineQuadrant:function(e){var t="",n=this.getCenterLonLat();return t+=e.lat<n.lat?"b":"t",t+=e.lon<n.lon?"l":"r",t},transform:function(e,t){this.centerLonLat=null;var n=OpenLayers.Projection.transform({x:this.left,y:this.bottom},e,t),r=OpenLayers.Projection.transform({x:this.right,y:this.bottom},e,t),i=OpenLayers.Projection.transform({x:this.left,y:this.top},e,t),s=OpenLayers.Projection.transform({x:this.right,y:this.top},e,t);return this.left=Math.min(n.x,i.x),this.bottom=Math.min(n.y,r.y),this.right=Math.max(r.x,s.x),this.top=Math.max(i.y,s.y),this},wrapDateLine:function(e,t){t=t||{};var n=t.leftTolerance||0,r=t.rightTolerance||0,i=this.clone();if(e){var s=e.getWidth();while(i.left<e.left&&i.right-r<=e.left)i=i.add(s,0);while(i.left+n>=e.right&&i.right>e.right)i=i.add(-s,0);var o=i.left+n;o<e.right&&o>e.left&&i.right-r>e.right&&(i=i.add(-s,0))}return i},CLASS_NAME:"OpenLayers.Bounds"}),OpenLayers.Bounds.fromString=function(e,t){var n=e.split(",");return OpenLayers.Bounds.fromArray(n,t)},OpenLayers.Bounds.fromArray=function(e,t){return t===!0?new OpenLayers.Bounds(e[1],e[0],e[3],e[2]):new OpenLayers.Bounds(e[0],e[1],e[2],e[3])},OpenLayers.Bounds.fromSize=function(e){return new OpenLayers.Bounds(0,e.h,e.w,0)},OpenLayers.Bounds.oppositeQuadrant=function(e){var t="";return t+=e.charAt(0)=="t"?"b":"t",t+=e.charAt(1)=="l"?"r":"l",t},OpenLayers.Element={visible:function(e){return OpenLayers.Util.getElement(e).style.display!="none"},toggle:function(){for(var e=0,t=arguments.length;e<t;e++){var n=OpenLayers.Util.getElement(arguments[e]),r=OpenLayers.Element.visible(n)?"none":"";n.style.display=r}},remove:function(e){e=OpenLayers.Util.getElement(e),e.parentNode.removeChild(e)},getHeight:function(e){return e=OpenLayers.Util.getElement(e),e.offsetHeight},hasClass:function(e,t){var n=e.className;return!!n&&(new RegExp("(^|\\s)"+t+"(\\s|$)")).test(n)},addClass:function(e,t){return OpenLayers.Element.hasClass(e,t)||(e.className+=(e.className?" ":"")+t),e},removeClass:function(e,t){var n=e.className;return n&&(e.className=OpenLayers.String.trim(n.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," "))),e},toggleClass:function(e,t){return OpenLayers.Element.hasClass(e,t)?OpenLayers.Element.removeClass(e,t):OpenLayers.Element.addClass(e,t),e},getStyle:function(e,t){e=OpenLayers.Util.getElement(e);var n=null;if(e&&e.style){n=e.style[OpenLayers.String.camelize(t)];if(!n)if(document.defaultView&&document.defaultView.getComputedStyle){var r=document.defaultView.getComputedStyle(e,null);n=r?r.getPropertyValue(t):null}else e.currentStyle&&(n=e.currentStyle[OpenLayers.String.camelize(t)]);var i=["left","top","right","bottom"];window.opera&&OpenLayers.Util.indexOf(i,t)!=-1&&OpenLayers.Element.getStyle(e,"position")=="static"&&(n="auto")}return n=="auto"?null:n}},OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(e,t){OpenLayers.Util.isArray(e)&&(t=e[1],e=e[0]),this.lon=OpenLayers.Util.toFloat(e),this.lat=OpenLayers.Util.toFloat(t)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(e,t){if(e==null||t==null)throw new TypeError("LonLat.add cannot receive null values");return new OpenLayers.LonLat(this.lon+OpenLayers.Util.toFloat(e),this.lat+OpenLayers.Util.toFloat(t))},equals:function(e){var t=!1;return e!=null&&(t=this.lon==e.lon&&this.lat==e.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(e.lon)&&isNaN(e.lat)),t},transform:function(e,t){var n=OpenLayers.Projection.transform({x:this.lon,y:this.lat},e,t);return this.lon=n.x,this.lat=n.y,this},wrapDateLine:function(e){var t=this.clone();if(e){while(t.lon<e.left)t.lon+=e.getWidth();while(t.lon>e.right)t.lon-=e.getWidth()}return t},CLASS_NAME:"OpenLayers.LonLat"}),OpenLayers.LonLat.fromString=function(e){var t=e.split(",");return new OpenLayers.LonLat(t[0],t[1])},OpenLayers.LonLat.fromArray=function(e){var t=OpenLayers.Util.isArray(e),n=t&&e[0],r=t&&e[1];return new OpenLayers.LonLat(n,r)},OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(e,t){this.x=parseFloat(e),this.y=parseFloat(t)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(e){var t=!1;return e!=null&&(t=this.x==e.x&&this.y==e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)),t},distanceTo:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},add:function(e,t){if(e==null||t==null)throw new TypeError("Pixel.add cannot receive null values");return new OpenLayers.Pixel(this.x+e,this.y+t)},offset:function(e){var t=this.clone();return e&&(t=this.add(e.x,e.y)),t},CLASS_NAME:"OpenLayers.Pixel"}),OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(e,t){this.w=parseFloat(e),this.h=parseFloat(t)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(e){var t=!1;return e!=null&&(t=this.w==e.w&&this.h==e.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(e.w)&&isNaN(e.h)),t},CLASS_NAME:"OpenLayers.Size"}),OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(e){alert(e)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"},function(){var e=document.getElementsByTagName("script");for(var t=0,n=e.length;t<n;++t)if(e[t].src.indexOf("firebug.js")!=-1&&console){OpenLayers.Util.extend(OpenLayers.Console,console);break}}(),OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){return OpenLayers.Lang.code||OpenLayers.Lang.setCode(),OpenLayers.Lang.code},setCode:function(e){var t;e||(e=OpenLayers.BROWSER_NAME=="msie"?navigator.userLanguage:navigator.language);var n=e.split("-");n[0]=n[0].toLowerCase(),typeof OpenLayers.Lang[n[0]]=="object"&&(t=n[0]);if(n[1]){var r=n[0]+"-"+n[1].toUpperCase();typeof OpenLayers.Lang[r]=="object"&&(t=r)}t||(OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+n.join("-")+" dictionary, falling back to default language"),t=OpenLayers.Lang.defaultCode),OpenLayers.Lang.code=t},translate:function(e,t){var n=OpenLayers.Lang[OpenLayers.Lang.getCode()],r=n&&n[e];return r||(r=e),t&&(r=OpenLayers.String.format(r,t)),r}},OpenLayers.i18n=OpenLayers.Lang.translate,OpenLayers.Util=OpenLayers.Util||{},OpenLayers.Util.getElement=function(){var e=[];for(var t=0,n=arguments.length;t<n;t++){var r=arguments[t];typeof r=="string"&&(r=document.getElementById(r));if(arguments.length==1)return r;e.push(r)}return e},OpenLayers.Util.isElement=function(e){return!!e&&e.nodeType===1},OpenLayers.Util.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"},typeof window.$=="undefined"&&(window.$=OpenLayers.Util.getElement),OpenLayers.Util.removeItem=function(e,t){for(var n=e.length-1;n>=0;n--)e[n]==t&&e.splice(n,1);return e},OpenLayers.Util.indexOf=function(e,t){if(typeof e.indexOf=="function")return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]==t)return n;return-1},OpenLayers.Util.modifyDOMElement=function(e,t,n,r,i,s,o,u){t&&(e.id=t),n&&(e.style.left=n.x+"px",e.style.top=n.y+"px"),r&&(e.style.width=r.w+"px",e.style.height=r.h+"px"),i&&(e.style.position=i),s&&(e.style.border=s),o&&(e.style.overflow=o),parseFloat(u)>=0&&parseFloat(u)<1?(e.style.filter="alpha(opacity="+u*100+")",e.style.opacity=u):parseFloat(u)==1&&(e.style.filter="",e.style.opacity="")},OpenLayers.Util.createDiv=function(e,t,n,r,i,s,o,u){var a=document.createElement("div");return r&&(a.style.backgroundImage="url("+r+")"),e||(e=OpenLayers.Util.createUniqueID("OpenLayersDiv")),i||(i="absolute"),OpenLayers.Util.modifyDOMElement(a,e,t,n,i,s,o,u),a},OpenLayers.Util.createImage=function(e,t,n,r,i,s,o,u){var a=document.createElement("img");e||(e=OpenLayers.Util.createUniqueID("OpenLayersDiv")),i||(i="relative"),OpenLayers.Util.modifyDOMElement(a,e,t,n,i,s,null,o);if(u){a.style.display="none";function f(){a.style.display="",OpenLayers.Event.stopObservingElement(a)}OpenLayers.Event.observe(a,"load",f),OpenLayers.Event.observe(a,"error",f)}return a.style.alt=e,a.galleryImg="no",r&&(a.src=r),a},OpenLayers.IMAGE_RELOAD_ATTEMPTS=0,OpenLayers.Util.alphaHackNeeded=null,OpenLayers.Util.alphaHack=function(){if(OpenLayers.Util.alphaHackNeeded==null){var e=navigator.appVersion.split("MSIE"),t=parseFloat(e[1]),n=!1;try{n=!!document.body.filters}catch(r){}OpenLayers.Util.alphaHackNeeded=n&&t>=5.5&&t<7}return OpenLayers.Util.alphaHackNeeded},OpenLayers.Util.modifyAlphaImageDiv=function(e,t,n,r,i,s,o,u,a){OpenLayers.Util.modifyDOMElement(e,t,n,r,s,null,null,a);var f=e.childNodes[0];i&&(f.src=i),OpenLayers.Util.modifyDOMElement(f,e.id+"_innerImage",null,r,"relative",o),OpenLayers.Util.alphaHack()&&(e.style.display!="none"&&(e.style.display="inline-block"),u==null&&(u="scale"),e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+f.src+"', "+"sizingMethod='"+u+"')",parseFloat(e.style.opacity)>=0&&parseFloat(e.style.opacity)<1&&(e.style.filter+=" alpha(opacity="+e.style.opacity*100+")"),f.style.filter="alpha(opacity=0)")},OpenLayers.Util.createAlphaImageDiv=function(e,t,n,r,i,s,o,u,a){var f=OpenLayers.Util.createDiv(),l=OpenLayers.Util.createImage(null,null,null,null,null,null,null,a);return l.className="olAlphaImg",f.appendChild(l),OpenLayers.Util.modifyAlphaImageDiv(f,e,t,n,r,i,s,o,u),f},OpenLayers.Util.upperCaseObject=function(e){var t={};for(var n in e)t[n.toUpperCase()]=e[n];return t},OpenLayers.Util.applyDefaults=function(e,t){e=e||{};var n=typeof window.Event=="function"&&t instanceof window.Event;for(var r in t)if(e[r]===undefined||!n&&t.hasOwnProperty&&t.hasOwnProperty(r)&&!e.hasOwnProperty(r))e[r]=t[r];return!n&&t&&t.hasOwnProperty&&t.hasOwnProperty("toString")&&!e.hasOwnProperty("toString")&&(e.toString=t.toString),e},OpenLayers.Util.getParameterString=function(e){var t=[];for(var n in e){var r=e[n];if(r!=null&&typeof r!="function"){var i;if(typeof r=="object"&&r.constructor==Array){var s=[],o;for(var u=0,a=r.length;u<a;u++)o=r[u],s.push(encodeURIComponent(o===null||o===undefined?"":o));i=s.join(",")}else i=encodeURIComponent(r);t.push(encodeURIComponent(n)+"="+i)}}return t.join("&")},OpenLayers.Util.urlAppend=function(e,t){var n=e;if(t){var r=(e+" ").split(/[?&]/);n+=r.pop()===" "?t:r.length?"&"+t:"?"+t}return n},OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||OpenLayers._getScriptLocation()+"img/"},OpenLayers.Util.getImageLocation=function(e){return OpenLayers.Util.getImagesLocation()+e},OpenLayers.Util.Try=function(){var e=null;for(var t=0,n=arguments.length;t<n;t++){var r=arguments[t];try{e=r();break}catch(i){}}return e},OpenLayers.Util.getXmlNodeValue=function(e){var t=null;return OpenLayers.Util.Try(function(){t=e.text,t||(t=e.textContent),t||(t=e.firstChild.nodeValue)},function(){t=e.textContent}),t},OpenLayers.Util.mouseLeft=function(e,t){var n=e.relatedTarget?e.relatedTarget:e.toElement;while(n!=t&&n!=null)n=n.parentNode;return n!=t},OpenLayers.Util.DEFAULT_PRECISION=14,OpenLayers.Util.toFloat=function(e,t){return t==null&&(t=OpenLayers.Util.DEFAULT_PRECISION),typeof e!="number"&&(e=parseFloat(e)),t===0?e:parseFloat(e.toPrecision(t))},OpenLayers.Util.rad=function(e){return e*Math.PI/180},OpenLayers.Util.deg=function(e){return e*180/Math.PI},OpenLayers.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563},OpenLayers.Util.distVincenty=function(e,t){var n=OpenLayers.Util.VincentyConstants,r=n.a,i=n.b,s=n.f,o=OpenLayers.Util.rad(t.lon-e.lon),u=Math.atan((1-s)*Math.tan(OpenLayers.Util.rad(e.lat))),a=Math.atan((1-s)*Math.tan(OpenLayers.Util.rad(t.lat))),f=Math.sin(u),l=Math.cos(u),c=Math.sin(a),h=Math.cos(a),p=o,d=2*Math.PI,v=20;while(Math.abs(p-d)>1e-12&&--v>0){var m=Math.sin(p),g=Math.cos(p),y=Math.sqrt(h*m*h*m+(l*c-f*h*g)*(l*c-f*h*g));if(y==0)return 0;var b=f*c+l*h*g,w=Math.atan2(y,b),E=Math.asin(l*h*m/y),S=Math.cos(E)*Math.cos(E),x=b-2*f*c/S,T=s/16*S*(4+s*(4-3*S));d=p,p=o+(1-T)*s*Math.sin(E)*(w+T*y*(x+T*b*(-1+2*x*x)))}if(v==0)return NaN;var N=S*(r*r-i*i)/(i*i),C=1+N/16384*(4096+N*(-768+N*(320-175*N))),k=N/1024*(256+N*(-128+N*(74-47*N))),L=k*y*(x+k/4*(b*(-1+2*x*x)-k/6*x*(-3+4*y*y)*(-3+4*x*x))),A=i*C*(w-L),O=A.toFixed(3)/1e3;return O},OpenLayers.Util.destinationVincenty=function(e,t,n){var r=OpenLayers.Util,i=r.VincentyConstants,s=i.a,o=i.b,u=i.f,a=e.lon,f=e.lat,l=n,c=r.rad(t),h=Math.sin(c),p=Math.cos(c),d=(1-u)*Math.tan(r.rad(f)),v=1/Math.sqrt(1+d*d),m=d*v,g=Math.atan2(d,p),y=v*h,b=1-y*y,w=b*(s*s-o*o)/(o*o),E=1+w/16384*(4096+w*(-768+w*(320-175*w))),S=w/1024*(256+w*(-128+w*(74-47*w))),x=l/(o*E),T=2*Math.PI;while(Math.abs(x-T)>1e-12){var N=Math.cos(2*g+x),C=Math.sin(x),k=Math.cos(x),L=S*C*(N+S/4*(k*(-1+2*N*N)-S/6*N*(-3+4*C*C)*(-3+4*N*N)));T=x,x=l/(o*E)+L}var A=m*C-v*k*p,O=Math.atan2(m*k+v*C*p,(1-u)*Math.sqrt(y*y+A*A)),M=Math.atan2(C*h,v*k-m*C*p),_=u/16*b*(4+u*(4-3*b)),D=M-(1-_)*u*y*(x+_*C*(N+_*k*(-1+2*N*N))),P=Math.atan2(y,-A);return new OpenLayers.LonLat(a+r.deg(D),r.deg(O))},OpenLayers.Util.getParameters=function(e){e=e===null||e===undefined?window.location.href:e;var t="";if(OpenLayers.String.contains(e,"?")){var n=e.indexOf("?")+1,r=OpenLayers.String.contains(e,"#")?e.indexOf("#"):e.length;t=e.substring(n,r)}var i={},s=t.split(/[&;]/);for(var o=0,u=s.length;o<u;++o){var a=s[o].split("=");if(a[0]){var f=a[0];try{f=decodeURIComponent(f)}catch(l){f=unescape(f)}var c=(a[1]||"").replace(/\+/g," ");try{c=decodeURIComponent(c)}catch(l){c=unescape(c)}c=c.split(","),c.length==1&&(c=c[0]),i[f]=c}}return i},OpenLayers.Util.lastSeqID=0,OpenLayers.Util.createUniqueID=function(e){return e==null&&(e="id_"),OpenLayers.Util.lastSeqID+=1,e+OpenLayers.Util.lastSeqID},OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36},OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches,OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd,OpenLayers.INCHES_PER_UNIT.nmi=1852*OpenLayers.INCHES_PER_UNIT.m,OpenLayers.METERS_PER_INCH=.0254000508001016,OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:.0254/OpenLayers.METERS_PER_INCH,MicroInch:254e-7/OpenLayers.METERS_PER_INCH,Mil:2.54e-8/OpenLayers.METERS_PER_INCH,Centimeter:.01/OpenLayers.METERS_PER_INCH,Kilometer:1e3/OpenLayers.METERS_PER_INCH,Yard:.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:.3047996/OpenLayers.METERS_PER_INCH,IndianFt75:.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:.1/OpenLayers.METERS_PER_INCH,Millimeter:.001/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH,Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:.20116782494375873/OpenLayers.METERS_PER_INCH,SearsLink:.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:.304812252984506/OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":5e4/OpenLayers.METERS_PER_INCH,"150kilometers":15e4/OpenLayers.METERS_PER_INCH}),OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT.Meter/1e3,cm:OpenLayers.INCHES_PER_UNIT.Meter/100,dm:OpenLayers.INCHES_PER_UNIT.Meter*100,km:OpenLayers.INCHES_PER_UNIT.Meter*1e3,kmi:OpenLayers.INCHES_PER_UNIT.nmi,fath:OpenLayers.INCHES_PER_UNIT.Fathom,ch:OpenLayers.INCHES_PER_UNIT.IntnlChain,link:OpenLayers.INCHES_PER_UNIT.IntnlLink,"us-in":OpenLayers.INCHES_PER_UNIT.inches,"us-ft":OpenLayers.INCHES_PER_UNIT.Foot,"us-yd":OpenLayers.INCHES_PER_UNIT.Yard,"us-ch":OpenLayers.INCHES_PER_UNIT.GunterChain,"us-mi":OpenLayers.INCHES_PER_UNIT.Mile,"ind-yd":OpenLayers.INCHES_PER_UNIT.IndianYd37,"ind-ft":OpenLayers.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH}),OpenLayers.DOTS_PER_INCH=72,OpenLayers.Util.normalizeScale=function(e){var t=e>1?1/e:e;return t},OpenLayers.Util.getResolutionFromScale=function(e,t){var n;if(e){t==null&&(t="degrees");var r=OpenLayers.Util.normalizeScale(e);n=1/(r*OpenLayers.INCHES_PER_UNIT[t]*OpenLayers.DOTS_PER_INCH)}return n},OpenLayers.Util.getScaleFromResolution=function(e,t){t==null&&(t="degrees");var n=e*OpenLayers.INCHES_PER_UNIT[t]*OpenLayers.DOTS_PER_INCH;return n},OpenLayers.Util.pagePosition=function(e){var t=[0,0],n=OpenLayers.Util.getViewportElement();if(!e||e==window||e==n)return t;var r=OpenLayers.IS_GECKO&&document.getBoxObjectFor&&OpenLayers.Element.getStyle(e,"position")=="absolute"&&(e.style.top==""||e.style.left==""),i=null,s;if(e.getBoundingClientRect){s=e.getBoundingClientRect();var o=n.scrollTop,u=n.scrollLeft;t[0]=s.left+u,t[1]=s.top+o}else if(document.getBoxObjectFor&&!r){s=document.getBoxObjectFor(e);var a=document.getBoxObjectFor(n);t[0]=s.screenX-a.screenX,t[1]=s.screenY-a.screenY}else{t[0]=e.offsetLeft,t[1]=e.offsetTop,i=e.offsetParent;if(i!=e)while(i)t[0]+=i.offsetLeft,t[1]+=i.offsetTop,i=i.offsetParent;var f=OpenLayers.BROWSER_NAME;if(f=="opera"||f=="safari"&&OpenLayers.Element.getStyle(e,"position")=="absolute")t[1]-=document.body.offsetTop;i=e.offsetParent;while(i&&i!=document.body){t[0]-=i.scrollLeft;if(f!="opera"||i.tagName!="TR")t[1]-=i.scrollTop;i=i.offsetParent}}return t},OpenLayers.Util.getViewportElement=function(){var e=arguments.callee.viewportElement;return e==undefined&&(e=OpenLayers.BROWSER_NAME=="msie"&&document.compatMode!="CSS1Compat"?document.body:document.documentElement,arguments.callee.viewportElement=e),e},OpenLayers.Util.isEquivalentUrl=function(e,t,n){n=n||{},OpenLayers.Util.applyDefaults(n,{ignoreCase:!0,ignorePort80:!0,ignoreHash:!0});var r=OpenLayers.Util.createUrlObject(e,n),i=OpenLayers.Util.createUrlObject(t,n);for(var s in r)if(s!=="args"&&r[s]!=i[s])return!1;for(var s in r.args){if(r.args[s]!=i.args[s])return!1;delete i.args[s]}for(var s in i.args)return!1;return!0},OpenLayers.Util.createUrlObject=function(e,t){t=t||{};if(!/^\w+:\/\//.test(e)){var n=window.location,r=n.port?":"+n.port:"",i=n.protocol+"//"+n.host.split(":").shift()+r;if(e.indexOf("/")===0)e=i+e;else{var s=n.pathname.split("/");s.pop(),e=i+s.join("/")+"/"+e}}t.ignoreCase&&(e=e.toLowerCase());var o=document.createElement("a");o.href=e;var u={};u.host=o.host.split(":").shift(),u.protocol=o.protocol,t.ignorePort80?u.port=o.port=="80"||o.port=="0"?"":o.port:u.port=o.port==""||o.port=="0"?"80":o.port,u.hash=t.ignoreHash||o.hash==="#"?"":o.hash;var a=o.search;if(!a){var f=e.indexOf("?");a=f!=-1?e.substr(f):""}return u.args=OpenLayers.Util.getParameters(a),u.pathname=o.pathname.charAt(0)=="/"?o.pathname:"/"+o.pathname,u},OpenLayers.Util.removeTail=function(e){var t=null,n=e.indexOf("?"),r=e.indexOf("#");return n==-1?t=r!=-1?e.substr(0,r):e:t=r!=-1?e.substr(0,Math.min(n,r)):e.substr(0,n),t},OpenLayers.IS_GECKO=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("webkit")==-1&&e.indexOf("gecko")!=-1}(),OpenLayers.CANVAS_SUPPORTED=function(){var e=document.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")}(),OpenLayers.BROWSER_NAME=function(){var e="",t=navigator.userAgent.toLowerCase();return t.indexOf("opera")!=-1?e="opera":t.indexOf("msie")!=-1?e="msie":t.indexOf("safari")!=-1?e="safari":t.indexOf("mozilla")!=-1&&(t.indexOf("firefox")!=-1?e="firefox":e="mozilla"),e}(),OpenLayers.Util.getBrowserName=function(){return OpenLayers.BROWSER_NAME},OpenLayers.Util.getRenderedDimensions=function(e,t,n){var r,i,s=document.createElement("div");s.style.visibility="hidden";var o=n&&n.containerElement?n.containerElement:document.body,u=!1,a=null,f=o;while(f&&f.tagName.toLowerCase()!="body"){var l=OpenLayers.Element.getStyle(f,"position");if(l=="absolute"){u=!0;break}if(l&&l!="static")break;f=f.parentNode}u&&(o.clientHeight===0||o.clientWidth===0)&&(a=document.createElement("div"),a.style.visibility="hidden",a.style.position="absolute",a.style.overflow="visible",a.style.width=document.body.clientWidth+"px",a.style.height=document.body.clientHeight+"px",a.appendChild(s)),s.style.position="absolute",t&&(t.w?(r=t.w,s.style.width=r+"px"):t.h&&(i=t.h,s.style.height=i+"px")),n&&n.displayClass&&(s.className=n.displayClass);var c=document.createElement("div");c.innerHTML=e,c.style.overflow="visible";if(c.childNodes)for(var h=0,p=c.childNodes.length;h<p;h++){if(!
c.childNodes[h].style)continue;c.childNodes[h].style.overflow="visible"}return s.appendChild(c),a?o.appendChild(a):o.appendChild(s),r||(r=parseInt(c.scrollWidth),s.style.width=r+"px"),i||(i=parseInt(c.scrollHeight)),s.removeChild(c),a?(a.removeChild(s),o.removeChild(a)):o.removeChild(s),new OpenLayers.Size(r,i)},OpenLayers.Util.getScrollbarWidth=function(){var e=OpenLayers.Util._scrollbarWidth;if(e==null){var t=null,n=null,r=0,i=0;t=document.createElement("div"),t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.width="100px",t.style.height="50px",t.style.overflow="hidden",n=document.createElement("div"),n.style.width="100%",n.style.height="200px",t.appendChild(n),document.body.appendChild(t),r=n.offsetWidth,t.style.overflow="scroll",i=n.offsetWidth,document.body.removeChild(document.body.lastChild),OpenLayers.Util._scrollbarWidth=r-i,e=OpenLayers.Util._scrollbarWidth}return e},OpenLayers.Util.getFormattedLonLat=function(e,t,n){n||(n="dms"),e=(e+540)%360-180;var r=Math.abs(e),i=Math.floor(r),s=(r-i)/(1/60),o=s;s=Math.floor(s);var u=(o-s)/(1/60);u=Math.round(u*10),u/=10,u>=60&&(u-=60,s+=1,s>=60&&(s-=60,i+=1)),i<10&&(i="0"+i);var a=i+"°";return n.indexOf("dm")>=0&&(s<10&&(s="0"+s),a+=s+"'",n.indexOf("dms")>=0&&(u<10&&(u="0"+u),a+=u+'"')),t=="lon"?a+=e<0?OpenLayers.i18n("W"):OpenLayers.i18n("E"):a+=e<0?OpenLayers.i18n("S"):OpenLayers.i18n("N"),a},OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:null,popup:null,initialize:function(e,t,n){this.layer=e,this.lonlat=t,this.data=n!=null?n:{},this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.layer!=null&&this.layer.map!=null&&this.popup!=null&&this.layer.map.removePopup(this.popup),this.layer!=null&&this.marker!=null&&this.layer.removeMarker(this.marker),this.layer=null,this.id=null,this.lonlat=null,this.data=null,this.marker!=null&&(this.destroyMarker(this.marker),this.marker=null),this.popup!=null&&(this.destroyPopup(this.popup),this.popup=null)},onScreen:function(){var e=!1;if(this.layer!=null&&this.layer.map!=null){var t=this.layer.map.getExtent();e=t.containsLonLat(this.lonlat)}return e},createMarker:function(){return this.lonlat!=null&&(this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon)),this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(e){if(this.lonlat!=null){if(!this.popup){var t=this.marker?this.marker.icon:null,n=this.popupClass?this.popupClass:OpenLayers.Popup.Anchored;this.popup=new n(this.id+"_popup",this.lonlat,this.data.popupSize,this.data.popupContentHTML,t,e)}this.data.overflow!=null&&(this.popup.contentDiv.style.overflow=this.data.overflow),this.popup.feature=this}return this.popup},destroyPopup:function(){this.popup&&(this.popup.feature=null,this.popup.destroy(),this.popup=null)},CLASS_NAME:"OpenLayers.Feature"}),OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"},OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",modified:null,initialize:function(e,t,n){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,t]),this.lonlat=null,this.geometry=e?e:null,this.state=null,this.attributes={},t&&(this.attributes=OpenLayers.Util.extend(this.attributes,t)),this.style=n?n:null},destroy:function(){this.layer&&(this.layer.removeFeatures(this),this.layer=null),this.geometry=null,this.modified=null,OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(e){var t=!1;if(this.layer&&this.layer.map){var n=this.layer.map.getExtent();if(e){var r=this.geometry.getBounds();t=n.intersectsBounds(r)}else{var i=n.toGeometry();t=i.intersects(this.geometry)}}return t},getVisibility:function(){return!(this.style&&this.style.display=="none"||!this.layer||this.layer&&this.layer.styleMap&&this.layer.styleMap.createSymbolizer(this,this.renderIntent).display=="none"||this.layer&&!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(e,t,n){var r=!1;return this.geometry&&(r=this.geometry.atPoint(e,t,n)),r},destroyPopup:function(){},move:function(e){if(!this.layer||!this.geometry.move)return undefined;var t;e.CLASS_NAME=="OpenLayers.LonLat"?t=this.layer.getViewPortPxFromLonLat(e):t=e;var n=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat()),r=this.layer.map.getResolution();return this.geometry.move(r*(t.x-n.x),r*(n.y-t.y)),this.layer.drawFeature(this),n},toState:function(e){if(e==OpenLayers.State.UPDATE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=e;break;case OpenLayers.State.UPDATE:case OpenLayers.State.INSERT:}else if(e==OpenLayers.State.INSERT)switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=e}else if(e==OpenLayers.State.DELETE)switch(this.state){case OpenLayers.State.INSERT:break;case OpenLayers.State.DELETE:break;case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=e}else e==OpenLayers.State.UNKNOWN&&(this.state=e)},CLASS_NAME:"OpenLayers.Feature.Vector"}),OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:.2,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},"delete":{display:"none"}},OpenLayers.Style=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:!1,propertyStyles:null,initialize:function(e,t){OpenLayers.Util.extend(this,t),this.rules=[],t&&t.rules&&this.addRules(t.rules),this.setDefaultStyle(e||OpenLayers.Feature.Vector.style["default"]),this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var e=0,t=this.rules.length;e<t;e++)this.rules[e].destroy(),this.rules[e]=null;this.rules=null,this.defaultStyle=null},createSymbolizer:function(e){var t=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),e),n=this.rules,r,i,s=[],o=!1;for(var u=0,a=n.length;u<a;u++){r=n[u];var f=r.evaluate(e);f&&(r instanceof OpenLayers.Rule&&r.elseFilter?s.push(r):(o=!0,this.applySymbolizer(r,t,e)))}if(o==0&&s.length>0){o=!0;for(var u=0,a=s.length;u<a;u++)this.applySymbolizer(s[u],t,e)}return n.length>0&&o==0&&(t.display="none"),t.label!=null&&typeof t.label!="string"&&(t.label=String(t.label)),t},applySymbolizer:function(e,t,n){var r=n.geometry?this.getSymbolizerPrefix(n.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0],i=e.symbolizer[r]||e.symbolizer;if(this.defaultsPerSymbolizer===!0){var s=this.defaultStyle;OpenLayers.Util.applyDefaults(i,{pointRadius:s.pointRadius}),(i.stroke===!0||i.graphic===!0)&&OpenLayers.Util.applyDefaults(i,{strokeWidth:s.strokeWidth,strokeColor:s.strokeColor,strokeOpacity:s.strokeOpacity,strokeDashstyle:s.strokeDashstyle,strokeLinecap:s.strokeLinecap}),(i.fill===!0||i.graphic===!0)&&OpenLayers.Util.applyDefaults(i,{fillColor:s.fillColor,fillOpacity:s.fillOpacity}),i.graphic===!0&&OpenLayers.Util.applyDefaults(i,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset})}return this.createLiterals(OpenLayers.Util.extend(t,i),n)},createLiterals:function(e,t){var n=OpenLayers.Util.extend({},t.attributes||t.data);OpenLayers.Util.extend(n,this.context);for(var r in this.propertyStyles)e[r]=OpenLayers.Style.createLiteral(e[r],n,t,r);return e},findPropertyStyles:function(){var e={},t=this.defaultStyle;this.addPropertyStyles(e,t);var n=this.rules,r,i;for(var s=0,o=n.length;s<o;s++){r=n[s].symbolizer;for(var u in r){i=r[u];if(typeof i!="object"){this.addPropertyStyles(e,r);break}this.addPropertyStyles(e,i)}}return e},addPropertyStyles:function(e,t){var n;for(var r in t)n=t[r],typeof n=="string"&&n.match(/\$\{\w+\}/)&&(e[r]=!0);return e},addRules:function(e){Array.prototype.push.apply(this.rules,e),this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(e){this.defaultStyle=e,this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(e){var t=OpenLayers.Style.SYMBOLIZER_PREFIXES;for(var n=0,r=t.length;n<r;n++)if(e.CLASS_NAME.indexOf(t[n])!=-1)return t[n]},clone:function(){var e=OpenLayers.Util.extend({},this);if(this.rules){e.rules=[];for(var t=0,n=this.rules.length;t<n;++t)e.rules.push(this.rules[t].clone())}e.context=this.context&&OpenLayers.Util.extend({},this.context);var r=OpenLayers.Util.extend({},this.defaultStyle);return new OpenLayers.Style(r,e)},CLASS_NAME:"OpenLayers.Style"}),OpenLayers.Style.createLiteral=function(e,t,n,r){return typeof e=="string"&&e.indexOf("${")!=-1&&(e=OpenLayers.String.format(e,t,[n,r]),e=isNaN(e)||!e?e:parseFloat(e)),e},OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text","Raster"],OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:!1,size:null,resolution:null,map:null,featureDx:0,initialize:function(e,t){this.container=OpenLayers.Util.getElement(e),OpenLayers.Util.extend(this,t)},destroy:function(){this.container=null,this.extent=null,this.size=null,this.resolution=null,this.map=null},supported:function(){return!1},setExtent:function(e,t){this.extent=e.clone();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var n=e.getWidth()/this.map.getExtent().getWidth(),e=e.scale(1/n);this.extent=e.wrapDateLine(this.map.getMaxExtent()).scale(n)}return t&&(this.resolution=null),!0},setSize:function(e){this.size=e.clone(),this.resolution=null},getResolution:function(){return this.resolution=this.resolution||this.map.getResolution(),this.resolution},drawFeature:function(e,t){t==null&&(t=e.style);if(e.geometry){var n=e.geometry.getBounds();if(n){var r;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(r=this.map.getMaxExtent()),n.intersectsBounds(this.extent,{worldBounds:r})?this.calculateFeatureDx(n,r):t={display:"none"};var i=this.drawGeometry(e.geometry,t,e.id);if(t.display!="none"&&t.label&&i!==!1){var s=e.geometry.getCentroid();if(t.labelXOffset||t.labelYOffset){var o=isNaN(t.labelXOffset)?0:t.labelXOffset,u=isNaN(t.labelYOffset)?0:t.labelYOffset,a=this.getResolution();s.move(o*a,u*a)}this.drawText(e.id,t,s)}else this.removeText(e.id);return i}}},calculateFeatureDx:function(e,t){this.featureDx=0;if(t){var n=t.getWidth(),r=(this.extent.left+this.extent.right)/2,i=(e.left+e.right)/2,s=Math.round((i-r)/n);this.featureDx=s*n}},drawGeometry:function(e,t,n){},drawText:function(e,t,n){},removeText:function(e){},clear:function(){},getFeatureIdFromEvent:function(e){},eraseFeatures:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=0,n=e.length;t<n;++t){var r=e[t];this.eraseGeometry(r.geometry,r.id),this.removeText(r.id)}},eraseGeometry:function(e,t){},moveRoot:function(e){},getRenderLayerId:function(){return this.container.id},applyDefaultSymbolizer:function(e){var t=OpenLayers.Util.extend({},OpenLayers.Renderer.defaultSymbolizer);return e.stroke===!1&&(delete t.strokeWidth,delete t.strokeColor),e.fill===!1&&delete t.fillColor,OpenLayers.Util.extend(t,e),t},CLASS_NAME:"OpenLayers.Renderer"}),OpenLayers.Renderer.defaultSymbolizer={fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1,pointRadius:0,labelAlign:"cm"},OpenLayers.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]},OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(e){this.compare=e?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER,this.clear()},insert:function(e){this.exists(e)&&this.remove(e);var t=e.id;this.determineZIndex(e);var n=-1,r=this.order.length,i;while(r-n>1){i=parseInt((n+r)/2);var s=this.compare(this,e,OpenLayers.Util.getElement(this.order[i]));s>0?n=i:r=i}return this.order.splice(r,0,t),this.indices[t]=this.getZIndex(e),this.getNextElement(r)},remove:function(e){var t=e.id,n=OpenLayers.Util.indexOf(this.order,t);if(n>=0){this.order.splice(n,1),delete this.indices[t];if(this.order.length>0){var r=this.order[this.order.length-1];this.maxZIndex=this.indices[r]}else this.maxZIndex=0}},clear:function(){this.order=[],this.indices={},this.maxZIndex=0},exists:function(e){return this.indices[e.id]!=null},getZIndex:function(e){return e._style.graphicZIndex},determineZIndex:function(e){var t=e._style.graphicZIndex;t==null?(t=this.maxZIndex,e._style.graphicZIndex=t):t>this.maxZIndex&&(this.maxZIndex=t)},getNextElement:function(e){var t=e+1;if(t<this.order.length){var n=OpenLayers.Util.getElement(this.order[t]);return n==undefined&&(n=this.getNextElement(t)),n}return null},CLASS_NAME:"OpenLayers.ElementsIndexer"}),OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(e,t,n){var r=e.getZIndex(t),i=0;if(n){var s=e.getZIndex(n);i=r-s}return i},Z_ORDER_DRAWING_ORDER:function(e,t,n){var r=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(e,t,n);return n&&r==0&&(r=1),r},Z_ORDER_Y_ORDER:function(e,t,n){var r=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(e,t,n);if(n&&r===0){var i=n._boundsBottom-t._boundsBottom;r=i===0?1:i}return r}},OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,xOffset:0,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",LABEL_OUTLINE_SUFFIX:"_outline",initialize:function(e,t){OpenLayers.Renderer.prototype.initialize.apply(this,arguments),this.rendererRoot=this.createRenderRoot(),this.root=this.createRoot("_root"),this.vectorRoot=this.createRoot("_vroot"),this.textRoot=this.createRoot("_troot"),this.root.appendChild(this.vectorRoot),this.root.appendChild(this.textRoot),this.rendererRoot.appendChild(this.root),this.container.appendChild(this.rendererRoot),t&&(t.zIndexing||t.yOrdering)&&(this.indexer=new OpenLayers.ElementsIndexer(t.yOrdering))},destroy:function(){this.clear(),this.rendererRoot=null,this.root=null,this.xmlns=null,OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){var e,t=this.vectorRoot;if(t)while(e=t.firstChild)t.removeChild(e);t=this.textRoot;if(t)while(e=t.firstChild)t.removeChild(e);this.indexer&&this.indexer.clear()},setExtent:function(e,t){var n=OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),r=this.getResolution();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var i,s=e.getWidth()/this.map.getExtent().getWidth(),e=e.scale(1/s),o=this.map.getMaxExtent();o.right>e.left&&o.right<e.right?i=!0:o.left>e.left&&o.left<e.right&&(i=!1);if(i!==this.rightOfDateLine||t)n=!1,this.xOffset=i===!0?o.getWidth()/r:0;this.rightOfDateLine=i}return n},getNodeType:function(e,t){},drawGeometry:function(e,t,n){var r=e.CLASS_NAME,i=!0;if(r=="OpenLayers.Geometry.Collection"||r=="OpenLayers.Geometry.MultiPoint"||r=="OpenLayers.Geometry.MultiLineString"||r=="OpenLayers.Geometry.MultiPolygon"){for(var s=0,o=e.components.length;s<o;s++)i=this.drawGeometry(e.components[s],t,n)&&i;return i}i=!1;var u=!1;t.display!="none"&&(t.backgroundGraphic?this.redrawBackgroundNode(e.id,e,t,n):u=!0,i=this.redrawNode(e.id,e,t,n));if(i==0){var a=document.getElementById(e.id);a&&(a._style.backgroundGraphic&&(u=!0),a.parentNode.removeChild(a))}if(u){var a=document.getElementById(e.id+this.BACKGROUND_ID_SUFFIX);a&&a.parentNode.removeChild(a)}return i},redrawNode:function(e,t,n,r){n=this.applyDefaultSymbolizer(n);var i=this.nodeFactory(e,this.getNodeType(t,n));i._featureId=r,i._boundsBottom=t.getBounds().bottom,i._geometryClass=t.CLASS_NAME,i._style=n;var s=this.drawGeometryNode(i,t,n);if(s===!1)return!1;i=s.node;if(this.indexer){var o=this.indexer.insert(i);o?this.vectorRoot.insertBefore(i,o):this.vectorRoot.appendChild(i)}else i.parentNode!==this.vectorRoot&&this.vectorRoot.appendChild(i);return this.postDraw(i),s.complete},redrawBackgroundNode:function(e,t,n,r){var i=OpenLayers.Util.extend({},n);return i.externalGraphic=i.backgroundGraphic,i.graphicXOffset=i.backgroundXOffset,i.graphicYOffset=i.backgroundYOffset,i.graphicZIndex=i.backgroundGraphicZIndex,i.graphicWidth=i.backgroundWidth||i.graphicWidth,i.graphicHeight=i.backgroundHeight||i.graphicHeight,i.backgroundGraphic=null,i.backgroundXOffset=null,i.backgroundYOffset=null,i.backgroundGraphicZIndex=null,this.redrawNode(e+this.BACKGROUND_ID_SUFFIX,t,i,null)},drawGeometryNode:function(e,t,n){n=n||e._style;var r={isFilled:n.fill===undefined?!0:n.fill,isStroked:n.stroke===undefined?!!n.strokeWidth:n.stroke},i;switch(t.CLASS_NAME){case"OpenLayers.Geometry.Point":n.graphic===!1&&(r.isFilled=!1,r.isStroked=!1),i=this.drawPoint(e,t);break;case"OpenLayers.Geometry.LineString":r.isFilled=!1,i=this.drawLineString(e,t);break;case"OpenLayers.Geometry.LinearRing":i=this.drawLinearRing(e,t);break;case"OpenLayers.Geometry.Polygon":i=this.drawPolygon(e,t);break;case"OpenLayers.Geometry.Rectangle":i=this.drawRectangle(e,t);break;default:}return e._options=r,i!=0?{node:this.setStyle(e,n,r,t),complete:i}:!1},postDraw:function(e){},drawPoint:function(e,t){},drawLineString:function(e,t){},drawLinearRing:function(e,t){},drawPolygon:function(e,t){},drawRectangle:function(e,t){},drawCircle:function(e,t){},removeText:function(e){var t=document.getElementById(e+this.LABEL_ID_SUFFIX);t&&this.textRoot.removeChild(t);var n=document.getElementById(e+this.LABEL_OUTLINE_SUFFIX);n&&this.textRoot.removeChild(n)},getFeatureIdFromEvent:function(e){var t=e.target,n=t&&t.correspondingUseElement,r=n?n:t||e.srcElement;return r._featureId},eraseGeometry:function(e,t){if(e.CLASS_NAME=="OpenLayers.Geometry.MultiPoint"||e.CLASS_NAME=="OpenLayers.Geometry.MultiLineString"||e.CLASS_NAME=="OpenLayers.Geometry.MultiPolygon"||e.CLASS_NAME=="OpenLayers.Geometry.Collection")for(var n=0,r=e.components.length;n<r;n++)this.eraseGeometry(e.components[n],t);else{var i=OpenLayers.Util.getElement(e.id);if(i&&i.parentNode){i.geometry&&(i.geometry.destroy(),i.geometry=null),i.parentNode.removeChild(i),this.indexer&&this.indexer.remove(i);if(i._style.backgroundGraphic){var s=e.id+this.BACKGROUND_ID_SUFFIX,o=OpenLayers.Util.getElement(s);o&&o.parentNode&&o.parentNode.removeChild(o)}}}},nodeFactory:function(e,t){var n=OpenLayers.Util.getElement(e);return n?this.nodeTypeCompare(n,t)||(n.parentNode.removeChild(n),n=this.nodeFactory(e,t)):n=this.createNode(t,e),n},nodeTypeCompare:function(e,t){},createNode:function(e,t){},moveRoot:function(e){var t=this.root;e.root.parentNode==this.rendererRoot&&(t=e.root),t.parentNode.removeChild(t),e.rendererRoot.appendChild(t)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(e){return e!="circle"&&!!e},CLASS_NAME:"OpenLayers.Renderer.Elements"}),OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(e){if(!this.supported())return;if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);var t=document.createStyleSheet(),n=["shape","rect","oval","fill","stroke","imagedata","group","textbox"];for(var r=0,i=n.length;r<i;r++)t.addRule("olv\\:"+n[r],"behavior: url(#default#VML); position: absolute; display: inline-block;")}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments)},supported:function(){return!!document.namespaces},setExtent:function(e,t){var n=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),r=this.getResolution(),i=e.left/r|0,s=e.top/r-this.size.h|0;t||!this.offset?(this.offset={x:i,y:s},i=0,s=0):(i-=this.offset.x,s-=this.offset.y);var o=i-this.xOffset+" "+s;this.root.coordorigin=o;var u=[this.root,this.vectorRoot,this.textRoot],a;for(var f=0,l=u.length;f<l;++f){a=u[f];var c=this.size.w+" "+this.size.h;a.coordsize=c}return this.root.style.flip="y",n},setSize:function(e){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);var t=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot],n=this.size.w+"px",r=this.size.h+"px",i;for(var s=0,o=t.length;s<o;++s)i=t[s],i.style.width=n,i.style.height=r},getNodeType:function(e,t){var n=null;switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":t.externalGraphic?n="olv:rect":this.isComplexSymbol(t.graphicName)?n="olv:shape":n="olv:oval";break;case"OpenLayers.Geometry.Rectangle":n="olv:rect";break;case"OpenLayers.Geometry.LineString":case"OpenLayers.Geometry.LinearRing":case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":n="olv:shape";break;default:}return n},setStyle:function(e,t,n,r){t=t||e._style,n=n||e._options;var i=t.fillColor;if(e._geometryClass==="OpenLayers.Geometry.Point")if(t.externalGraphic){n.isFilled=!0,t.graphicTitle&&(e.title=t.graphicTitle);var s=t.graphicWidth||t.graphicHeight,o=t.graphicHeight||t.graphicWidth;s=s?s:t.pointRadius*2,o=o?o:t.pointRadius*2;var u=this.getResolution(),a=t.graphicXOffset!=undefined?t.graphicXOffset:-(.5*s),f=t.graphicYOffset!=undefined?t.graphicYOffset:-(.5*o);e.style.left=((r.x-this.featureDx)/u-this.offset.x+a|0)+"px",e.style.top=(r.y/u-this.offset.y-(f+o)|0)+"px",e.style.width=s+"px",e.style.height=o+"px",e.style.flip="y",i="none",n.isStroked=!1}else if(this.isComplexSymbol(t.graphicName)){var l=this.importSymbol(t.graphicName);e.path=l.path,e.coordorigin=l.left+","+l.bottom;var c=l.size;e.coordsize=c+","+c,this.drawCircle(e,r,t.pointRadius),e.style.flip="y"}else this.drawCircle(e,r,t.pointRadius);n.isFilled?e.fillcolor=i:e.filled="false";var h=e.getElementsByTagName("fill"),p=h.length==0?null:h[0];if(!n.isFilled)p&&e.removeChild(p);else{p||(p=this.createNode("olv:fill",e.id+"_fill")),p.opacity=t.fillOpacity;if(e._geometryClass==="OpenLayers.Geometry.Point"&&t.externalGraphic){t.graphicOpacity&&(p.opacity=t.graphicOpacity),p.src=t.externalGraphic,p.type="frame";if(!t.graphicWidth||!t.graphicHeight)p.aspect="atmost"}p.parentNode!=e&&e.appendChild(p)}var d=t.rotation;if(d!==undefined||e._rotation!==undefined)e._rotation=d,t.externalGraphic?(this.graphicRotate(e,a,f,t),p.opacity=0):e._geometryClass==="OpenLayers.Geometry.Point"&&(e.style.rotation=d||0);var v=e.getElementsByTagName("stroke"),m=v.length==0?null:v[0];return n.isStroked?(m||(m=this.createNode("olv:stroke",e.id+"_stroke"),e.appendChild(m)),m.on=!0,m.color=t.strokeColor,m.weight=t.strokeWidth+"px",m.opacity=t.strokeOpacity,m.endcap=t.strokeLinecap=="butt"?"flat":t.strokeLinecap||"round",t.strokeDashstyle&&(m.dashstyle=this.dashStyle(t))):(e.stroked=!1,m&&(m.on=!1)),t.cursor!="inherit"&&t.cursor!=null&&(e.style.cursor=t.cursor),e},graphicRotate:function(e,t,n,r){var r=r||e._style,i=r.rotation||0,s,o;if(!r.graphicWidth||!r.graphicHeight){var u=new Image;u.onreadystatechange=OpenLayers.Function.bind(function(){if(u.readyState=="complete"||u.readyState=="interactive")s=u.width/u.height,o=Math.max(r.pointRadius*2,r.graphicWidth||0,r.graphicHeight||0),t*=s,r.graphicWidth=o*s,r.graphicHeight=o,this.graphicRotate(e,t,n,r)},this),u.src=r.externalGraphic;return}o=Math.max(r.graphicWidth,r.graphicHeight),s=r.graphicWidth/r.graphicHeight;var a=Math.round(r.graphicWidth||o*s),f=Math.round(r.graphicHeight||o);e.style.width=a+"px",e.style.height=f+"px";var l=document.getElementById(e.id+"_image");l||(l=this.createNode("olv:imagedata",e.id+"_image"),e.appendChild(l)),l.style.width=a+"px",l.style.height=f+"px",l.src=r.externalGraphic,l.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')";var c=i*Math.PI/180,h=Math.sin(c),p=Math.cos(c),d="progid:DXImageTransform.Microsoft.Matrix(M11="+p+",M12="+ -h+",M21="+h+",M22="+p+",SizingMethod='auto expand')\n",v=r.graphicOpacity||r.fillOpacity;v&&v!=1&&(d+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+v+")\n"),e.style.filter=d;var m=new OpenLayers.Geometry.Point(-t,-n),g=(new OpenLayers.Bounds(0,0,a,f)).toGeometry();g.rotate(r.rotation,m);var y=g.getBounds();e.style.left=Math.round(parseInt(e.style.left)+y.left)+"px",e.style.top=Math.round(parseInt(e.style.top)-y.bottom)+"px"},postDraw:function(e){e.style.visibility="visible";var t=e._style.fillColor,n=e._style.strokeColor;t=="none"&&e.fillcolor!=t&&(e.fillcolor=t),n=="none"&&e.strokecolor!=n&&(e.strokecolor=n)},setNodeDimension:function(e,t){var n=t.getBounds();if(n){var r=this.getResolution(),i=new OpenLayers.Bounds((n.left-this.featureDx)/r-this.offset.x|0,n.bottom/r-this.offset.y|0,(n.right-this.featureDx)/r-this.offset.x|0,n.top/r-this.offset.y|0);e.style.left=i.left+"px",e.style.top=i.top+"px",e.style.width=i.getWidth()+"px",e.style.height=i.getHeight()+"px",e.coordorigin=i.left+" "+i.top,e.coordsize=i.getWidth()+" "+i.getHeight()}},dashStyle:function(e){var t=e.strokeDashstyle;switch(t){case"solid":case"dot":case"dash":case"dashdot":case"longdash":case"longdashdot":return t;default:var n=t.split(/[ ,]/);if(n.length==2)return 1*n[0]>=2*n[1]?"longdash":n[0]==1||n[1]==1?"dot":"dash";if(n.length==4)return 1*n[0]>=2*n[1]?"longdashdot":"dashdot";return"solid"}},createNode:function(e,t){var n=document.createElement(e);return t&&(n.id=t),n.unselectable="on",n.onselectstart=OpenLayers.Function.False,n},nodeTypeCompare:function(e,t){var n=t,r=n.indexOf(":");r!=-1&&(n=n.substr(r+1));var i=e.nodeName;return r=i.indexOf(":"),r!=-1&&(i=i.substr(r+1)),n==i},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_vmlRoot","div")},createRoot:function(e){return this.nodeFactory(this.container.id+e,"olv:group")},drawPoint:function(e,t){return this.drawCircle(e,t,1)},drawCircle:function(e,t,n){if(!isNaN(t.x)&&!isNaN(t.y)){var r=this.getResolution();e.style.left=((t.x-this.featureDx)/r-this.offset.x|0)-n+"px",e.style.top=(t.y/r-this.offset.y|0)-n+"px";var i=n*2;return e.style.width=i+"px",e.style.height=i+"px",e}return!1},drawLineString:function(e,t){return this.drawLine(e,t,!1)},drawLinearRing:function(e,t){return this.drawLine(e,t,!0)},drawLine:function(e,t,n){this.setNodeDimension(e,t);var r=this.getResolution(),i=t.components.length,s=new Array(i),o,u,a;for(var f=0;f<i;f++)o=t.components[f],u=(o.x-this.featureDx)/r-this.offset.x|0,a=o.y/r-this.offset.y|0,s[f]=" "+u+","+a+" l ";var l=n?" x e":" e";return e.path="m"+s.join("")+l,e},drawPolygon:function(e,t){this.setNodeDimension(e,t);var n=this.getResolution(),r=[],i,s,o,u,a,f,l,c,h,p,d,v;for(i=0,s=t.components.length;i<s;i++){r.push("m"),o=t.components[i].components,u=i===0,a=null,f=null;for(l=0,c=o.length;l<c;l++)h=o[l],d=(h.x-this.featureDx)/n-this.offset.x|0,v=h.y/n-this.offset.y|0,p=" "+d+","+v,r.push(p),l==0&&r.push(" l"),u||(a?a!=p&&(f?f!=p&&(u=!0):f=p):a=p);r.push(u?" x ":" ")}return r.push("e"),e.path=r.join(""),e},drawRectangle:function(e,t){var n=this.getResolution();return e.style.left=((t.x-this.featureDx)/n-this.offset.x|0)+"px",e.style.top=(t.y/n-this.offset.y|0)+"px",e.style.width=(t.width/n|0)+"px",e.style.height=(t.height/n|0)+"px",e},drawText:function(e,t,n){var r=this.nodeFactory(e+this.LABEL_ID_SUFFIX,"olv:rect"),i=this.nodeFactory(e+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox"),s=this.getResolution();r.style.left=((n.x-this.featureDx)/s-this.offset.x|0)+"px",r.style.top=(n.y/s-this.offset.y|0)+"px",r.style.flip="y",i.innerText=t.label,t.cursor!="inherit"&&t.cursor!=null&&(i.style.cursor=t.cursor),t.fontColor&&(i.style.color=t.fontColor),t.fontOpacity&&(i.style.filter="alpha(opacity="+t.fontOpacity*100+")"),t.fontFamily&&(i.style.fontFamily=t.fontFamily),t.fontSize&&(i.style.fontSize=t.fontSize),t.fontWeight&&(i.style.fontWeight=t.fontWeight),t.fontStyle&&(i.style.fontStyle=t.fontStyle),t.labelSelect===!0&&(r._featureId=e,i._featureId=e,i._geometry=n,i._geometryClass=n.CLASS_NAME),i.style.whiteSpace="nowrap",i.inset="1px,0px,0px,0px",r.parentNode||(r.appendChild(i),this.textRoot.appendChild(r));var o=t.labelAlign||"cm";o.length==1&&(o+="m");var u=i.clientWidth*OpenLayers.Renderer.VML.LABEL_SHIFT[o.substr(0,1)],a=i.clientHeight*OpenLayers.Renderer.VML.LABEL_SHIFT[o.substr(1,1)];r.style.left=parseInt(r.style.left)-u-1+"px",r.style.top=parseInt(r.style.top)+a+"px"},moveRoot:function(e){var t=this.map.getLayer(e.container.id);t instanceof OpenLayers.Layer.Vector.RootContainer&&(t=this.map.getLayer(this.container.id)),t&&t.renderer.clear(),OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments),t&&t.redraw()},importSymbol:function(e){var t=this.container.id+"-"+e,n=this.symbolCache[t];if(n)return n;var r=OpenLayers.Renderer.symbol[e];if(!r)throw new Error(e+" is not a valid symbol name");var i=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),s=["m"];for(var o=0;o<r.length;o+=2){var u=r[o],a=r[o+1];i.left=Math.min(i.left,u),i.bottom=Math.min(i.bottom,a),i.right=Math.max(i.right,u),i.top=Math.max(i.top,a),s.push(u),s.push(a),o==0&&s.push("l")}s.push("x e");var f=s.join(" "),l=(i.getWidth()-i.getHeight())/2;return l>0?(i.bottom=i.bottom-l,i.top=i.top+l):(i.left=i.left+l,i.right=i.right-l),n={path:f,size:i.getWidth(),left:i.left,bottom:i.bottom},this.symbolCache[t]=n,n},CLASS_NAME:"OpenLayers.Renderer.VML"}),OpenLayers.Renderer.VML.LABEL_SHIFT={l:0,c:.5,r:1,t:0,m:.5,b:1},OpenLayers.Animation=function(e){function s(e,t,s){t=t>0?t:Number.POSITIVE_INFINITY;var o=++r,u=+(new Date);return i[o]=function(){i[o]&&+(new Date)-u<=t?(e(),i[o]&&n(i[o],s)):delete i[o]},n(i[o],s),o}function o(e){delete i[e]}var t=!!(e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame),n=function(){var t=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t,n){e.setTimeout(t,16)};return function(n,r){t.apply(e,[n,r])}}(),r=0,i={};return{isNative:t,requestFrame:n,start:s,stop:o}}(window),OpenLayers.Tween=OpenLayers.Class({easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,animationId:null,playing:!1,initialize:function(e){this.easing=e?e:OpenLayers.Easing.Expo.easeOut},start:function(e,t,n,r){this.playing=!0,this.begin=e,this.finish=t,this.duration=n,this.callbacks=r.callbacks,this.time=0,OpenLayers.Animation.stop(this.animationId),this.animationId=null,this.callbacks&&this.callbacks.start&&this.callbacks.start.call(this,this.begin),this.animationId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.play,this))},stop:function(){if(!this.playing)return;this.callbacks&&this.callbacks.done&&this.callbacks.done.call(this,this.finish),OpenLayers.Animation.stop(this.animationId),this.animationId=null,this.playing=!1},play:function(){var e={};for(var t in this.begin){var n=this.begin[t],r=this.finish[t];if(n==null||r==null||isNaN(n)||isNaN(r))throw new TypeError("invalid value for Tween");var i=r-n;e[t]=this.easing.apply(this,[this.time,n,i,this.duration])}this.time++,this.callbacks&&this.callbacks.eachStep&&this.callbacks.eachStep.call(this,e),this.time>this.duration&&this.stop()},CLASS_NAME:"OpenLayers.Tween"}),OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"},OpenLayers.Easing.Linear={easeIn:function(e,t,n,r){return n*e/r+t},easeOut:function(
e,t,n,r){return n*e/r+t},easeInOut:function(e,t,n,r){return n*e/r+t},CLASS_NAME:"OpenLayers.Easing.Linear"},OpenLayers.Easing.Expo={easeIn:function(e,t,n,r){return e==0?t:n*Math.pow(2,10*(e/r-1))+t},easeOut:function(e,t,n,r){return e==r?t+n:n*(-Math.pow(2,-10*e/r)+1)+t},easeInOut:function(e,t,n,r){return e==0?t:e==r?t+n:(e/=r/2)<1?n/2*Math.pow(2,10*(e-1))+t:n/2*(-Math.pow(2,-10*--e)+2)+t},CLASS_NAME:"OpenLayers.Easing.Expo"},OpenLayers.Easing.Quad={easeIn:function(e,t,n,r){return n*(e/=r)*e+t},easeOut:function(e,t,n,r){return-n*(e/=r)*(e-2)+t},easeInOut:function(e,t,n,r){return(e/=r/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},CLASS_NAME:"OpenLayers.Easing.Quad"},OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.id=null,this.bounds=null},clone:function(){return new OpenLayers.Geometry},setBounds:function(e){e&&(this.bounds=e.clone())},clearBounds:function(){this.bounds=null,this.parent&&this.parent.clearBounds()},extendBounds:function(e){var t=this.getBounds();t?this.bounds.extend(e):this.setBounds(e)},getBounds:function(){return this.bounds==null&&this.calculateBounds(),this.bounds},calculateBounds:function(){},distanceTo:function(e,t){},getVertices:function(e){},atPoint:function(e,t,n){var r=!1,i=this.getBounds();if(i!=null&&e!=null){var s=t!=null?t:0,o=n!=null?n:0,u=new OpenLayers.Bounds(this.bounds.left-s,this.bounds.bottom-o,this.bounds.right+s,this.bounds.top+o);r=u.containsLonLat(e)}return r},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){var e;return OpenLayers.Format&&OpenLayers.Format.WKT?e=OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this)):e=Object.prototype.toString.call(this),e},CLASS_NAME:"OpenLayers.Geometry"}),OpenLayers.Geometry.fromWKT=function(e){var t;if(OpenLayers.Format&&OpenLayers.Format.WKT){var n=OpenLayers.Geometry.fromWKT.format;n||(n=new OpenLayers.Format.WKT,OpenLayers.Geometry.fromWKT.format=n);var r=n.read(e);if(r instanceof OpenLayers.Feature.Vector)t=r.geometry;else if(OpenLayers.Util.isArray(r)){var i=r.length,s=new Array(i);for(var o=0;o<i;++o)s[o]=r[o].geometry;t=new OpenLayers.Geometry.Collection(s)}}return t},OpenLayers.Geometry.segmentsIntersect=function(e,t,n){var r=n&&n.point,i=n&&n.tolerance,s=!1,o=e.x1-t.x1,u=e.y1-t.y1,a=e.x2-e.x1,f=e.y2-e.y1,l=t.y2-t.y1,c=t.x2-t.x1,h=l*a-c*f,p=c*u-l*o,d=a*u-f*o;if(h==0)p==0&&d==0&&(s=!0);else{var v=p/h,m=d/h;if(v>=0&&v<=1&&m>=0&&m<=1)if(!r)s=!0;else{var g=e.x1+v*a,y=e.y1+v*f;s=new OpenLayers.Geometry.Point(g,y)}}if(i){var b;if(s){if(r){var w=[e,t],E,g,y;e:for(var S=0;S<2;++S){E=w[S];for(var x=1;x<3;++x){g=E["x"+x],y=E["y"+x],b=Math.sqrt(Math.pow(g-s.x,2)+Math.pow(y-s.y,2));if(b<i){s.x=g,s.y=y;break e}}}}}else{var w=[e,t],T,N,g,y,C,k;e:for(var S=0;S<2;++S){T=w[S],N=w[(S+1)%2];for(var x=1;x<3;++x){C={x:T["x"+x],y:T["y"+x]},k=OpenLayers.Geometry.distanceToSegment(C,N);if(k.distance<i){r?s=new OpenLayers.Geometry.Point(C.x,C.y):s=!0;break e}}}}}return s},OpenLayers.Geometry.distanceToSegment=function(e,t){var n=e.x,r=e.y,i=t.x1,s=t.y1,o=t.x2,u=t.y2,a=o-i,f=u-s,l=(a*(n-i)+f*(r-s))/(Math.pow(a,2)+Math.pow(f,2)),c,h;return l<=0?(c=i,h=s):l>=1?(c=o,h=u):(c=i+l*a,h=s+l*f),{distance:Math.sqrt(Math.pow(c-n,2)+Math.pow(h-r,2)),x:c,y:h}},OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(e){OpenLayers.Geometry.prototype.initialize.apply(this,arguments),this.components=[],e!=null&&this.addComponents(e)},destroy:function(){this.components.length=0,this.components=null,OpenLayers.Geometry.prototype.destroy.apply(this,arguments)},clone:function(){var geometry=eval("new "+this.CLASS_NAME+"()");for(var i=0,len=this.components.length;i<len;i++)geometry.addComponent(this.components[i].clone());return OpenLayers.Util.applyDefaults(geometry,this),geometry},getComponentsString:function(){var e=[];for(var t=0,n=this.components.length;t<n;t++)e.push(this.components[t].toShortString());return e.join(",")},calculateBounds:function(){this.bounds=null;var e=new OpenLayers.Bounds,t=this.components;if(t)for(var n=0,r=t.length;n<r;n++)e.extend(t[n].getBounds());e.left!=null&&e.bottom!=null&&e.right!=null&&e.top!=null&&this.setBounds(e)},addComponents:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=0,n=e.length;t<n;t++)this.addComponent(e[t])},addComponent:function(e,t){var n=!1;if(e)if(this.componentTypes==null||OpenLayers.Util.indexOf(this.componentTypes,e.CLASS_NAME)>-1){if(t!=null&&t<this.components.length){var r=this.components.slice(0,t),i=this.components.slice(t,this.components.length);r.push(e),this.components=r.concat(i)}else this.components.push(e);e.parent=this,this.clearBounds(),n=!0}return n},removeComponents:function(e){var t=!1;OpenLayers.Util.isArray(e)||(e=[e]);for(var n=e.length-1;n>=0;--n)t=this.removeComponent(e[n])||t;return t},removeComponent:function(e){return OpenLayers.Util.removeItem(this.components,e),this.clearBounds(),!0},getLength:function(){var e=0;for(var t=0,n=this.components.length;t<n;t++)e+=this.components[t].getLength();return e},getArea:function(){var e=0;for(var t=0,n=this.components.length;t<n;t++)e+=this.components[t].getArea();return e},getGeodesicArea:function(e){var t=0;for(var n=0,r=this.components.length;n<r;n++)t+=this.components[n].getGeodesicArea(e);return t},getCentroid:function(e){if(!e)return this.components.length&&this.components[0].getCentroid();var t=this.components.length;if(!t)return!1;var n=[],r=[],i=0,s=Number.MAX_VALUE,o;for(var u=0;u<t;++u){o=this.components[u];var a=o.getArea(),f=o.getCentroid(!0);if(isNaN(a)||isNaN(f.x)||isNaN(f.y))continue;n.push(a),i+=a,s=a<s&&a>0?a:s,r.push(f)}t=n.length;if(i===0){for(var u=0;u<t;++u)n[u]=1;i=n.length}else{for(var u=0;u<t;++u)n[u]/=s;i/=s}var l=0,c=0,f,a;for(var u=0;u<t;++u)f=r[u],a=n[u],l+=f.x*a,c+=f.y*a;return new OpenLayers.Geometry.Point(l/i,c/i)},getGeodesicLength:function(e){var t=0;for(var n=0,r=this.components.length;n<r;n++)t+=this.components[n].getGeodesicLength(e);return t},move:function(e,t){for(var n=0,r=this.components.length;n<r;n++)this.components[n].move(e,t)},rotate:function(e,t){for(var n=0,r=this.components.length;n<r;++n)this.components[n].rotate(e,t)},resize:function(e,t,n){for(var r=0;r<this.components.length;++r)this.components[r].resize(e,t,n);return this},distanceTo:function(e,t){var n=!t||t.edge!==!1,r=n&&t&&t.details,i,s,o,u=Number.POSITIVE_INFINITY;for(var a=0,f=this.components.length;a<f;++a){i=this.components[a].distanceTo(e,t),o=r?i.distance:i;if(o<u){u=o,s=i;if(u==0)break}}return s},equals:function(e){var t=!0;if(!e||!e.CLASS_NAME||this.CLASS_NAME!=e.CLASS_NAME)t=!1;else if(!OpenLayers.Util.isArray(e.components)||e.components.length!=this.components.length)t=!1;else for(var n=0,r=this.components.length;n<r;++n)if(!this.components[n].equals(e.components[n])){t=!1;break}return t},transform:function(e,t){if(e&&t){for(var n=0,r=this.components.length;n<r;n++){var i=this.components[n];i.transform(e,t)}this.bounds=null}return this},intersects:function(e){var t=!1;for(var n=0,r=this.components.length;n<r;++n){t=e.intersects(this.components[n]);if(t)break}return t},getVertices:function(e){var t=[];for(var n=0,r=this.components.length;n<r;++n)Array.prototype.push.apply(t,this.components[n].getVertices(e));return t},CLASS_NAME:"OpenLayers.Geometry.Collection"}),OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(e,t){OpenLayers.Geometry.prototype.initialize.apply(this,arguments),this.x=parseFloat(e),this.y=parseFloat(t)},clone:function(e){return e==null&&(e=new OpenLayers.Geometry.Point(this.x,this.y)),OpenLayers.Util.applyDefaults(e,this),e},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(e,t){var n=!t||t.edge!==!1,r=n&&t&&t.details,i,s,o,u,a,f;return e instanceof OpenLayers.Geometry.Point?(s=this.x,o=this.y,u=e.x,a=e.y,i=Math.sqrt(Math.pow(s-u,2)+Math.pow(o-a,2)),f=r?{x0:s,y0:o,x1:u,y1:a,distance:i}:i):(f=e.distanceTo(this,t),r&&(f={x0:f.x1,y0:f.y1,x1:f.x0,y1:f.y0,distance:f.distance})),f},equals:function(e){var t=!1;return e!=null&&(t=this.x==e.x&&this.y==e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)),t},toShortString:function(){return this.x+", "+this.y},move:function(e,t){this.x=this.x+e,this.y=this.y+t,this.clearBounds()},rotate:function(e,t){e*=Math.PI/180;var n=this.distanceTo(t),r=e+Math.atan2(this.y-t.y,this.x-t.x);this.x=t.x+n*Math.cos(r),this.y=t.y+n*Math.sin(r),this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(e,t,n){return n=n==undefined?1:n,this.x=t.x+e*n*(this.x-t.x),this.y=t.y+e*(this.y-t.y),this.clearBounds(),this},intersects:function(e){var t=!1;return e.CLASS_NAME=="OpenLayers.Geometry.Point"?t=this.equals(e):t=e.intersects(this),t},transform:function(e,t){return e&&t&&(OpenLayers.Projection.transform(this,e,t),this.bounds=null),this},getVertices:function(e){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"}),OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],addPoint:function(e,t){this.addComponent(e,t)},removePoint:function(e){this.removeComponent(e)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"}),OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],getLength:function(){var e=0;if(this.components&&this.components.length>1)for(var t=1,n=this.components.length;t<n;t++)e+=this.components[t-1].distanceTo(this.components[t]);return e},getGeodesicLength:function(e){var t=this;if(e){var n=new OpenLayers.Projection("EPSG:4326");n.equals(e)||(t=this.clone().transform(e,n))}var r=0;if(t.components&&t.components.length>1){var i,s;for(var o=1,u=t.components.length;o<u;o++)i=t.components[o-1],s=t.components[o],r+=OpenLayers.Util.distVincenty({lon:i.x,lat:i.y},{lon:s.x,lat:s.y})}return r*1e3},CLASS_NAME:"OpenLayers.Geometry.Curve"}),OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{removeComponent:function(e){var t=this.components&&this.components.length>2;return t&&OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments),t},intersects:function(e){var t=!1,n=e.CLASS_NAME;if(n=="OpenLayers.Geometry.LineString"||n=="OpenLayers.Geometry.LinearRing"||n=="OpenLayers.Geometry.Point"){var r=this.getSortedSegments(),i;n=="OpenLayers.Geometry.Point"?i=[{x1:e.x,y1:e.y,x2:e.x,y2:e.y}]:i=e.getSortedSegments();var s,o,u,a,f,l,c,h;e:for(var p=0,d=r.length;p<d;++p){s=r[p],o=s.x1,u=s.x2,a=s.y1,f=s.y2;for(var v=0,m=i.length;v<m;++v){l=i[v];if(l.x1>u)break;if(l.x2<o)continue;c=l.y1,h=l.y2;if(Math.min(c,h)>Math.max(a,f))continue;if(Math.max(c,h)<Math.min(a,f))continue;if(OpenLayers.Geometry.segmentsIntersect(s,l)){t=!0;break e}}}}else t=e.intersects(this);return t},getSortedSegments:function(){function s(e,t){return e.x1-t.x1}var e=this.components.length-1,t=new Array(e),n,r;for(var i=0;i<e;++i)n=this.components[i],r=this.components[i+1],n.x<r.x?t[i]={x1:n.x,y1:n.y,x2:r.x,y2:r.y}:t[i]={x1:r.x,y1:r.y,x2:n.x,y2:n.y};return t.sort(s)},splitWithSegment:function(e,t){var n=!t||t.edge!==!1,r=t&&t.tolerance,i=[],s=this.getVertices(),o=[],u=[],a=!1,f,l,c,h,p,d,v={point:!0,tolerance:r},m=null;for(var g=0,y=s.length-2;g<=y;++g){f=s[g],o.push(f.clone()),l=s[g+1],d={x1:f.x,y1:f.y,x2:l.x,y2:l.y},c=OpenLayers.Geometry.segmentsIntersect(e,d,v);if(c instanceof OpenLayers.Geometry.Point){c.x===e.x1&&c.y===e.y1||c.x===e.x2&&c.y===e.y2||c.equals(f)||c.equals(l)?p=!0:p=!1;if(p||n){c.equals(u[u.length-1])||u.push(c.clone());if(g===0&&c.equals(f))continue;if(c.equals(l))continue;a=!0,c.equals(f)||o.push(c),i.push(new OpenLayers.Geometry.LineString(o)),o=[c.clone()]}}}a&&(o.push(l.clone()),i.push(new OpenLayers.Geometry.LineString(o)));if(u.length>0){var b=e.x1<e.x2?1:-1,w=e.y1<e.y2?1:-1;m={lines:i,points:u.sort(function(e,t){return b*e.x-b*t.x||w*e.y-w*t.y})}}return m},split:function(e,t){var n=null,r=t&&t.mutual,i,s,o,u;if(e instanceof OpenLayers.Geometry.LineString){var a=this.getVertices(),f,l,c,h,p,d,v=[];o=[];for(var m=0,g=a.length-2;m<=g;++m){f=a[m],l=a[m+1],c={x1:f.x,y1:f.y,x2:l.x,y2:l.y},u=u||[e],r&&v.push(f.clone());for(var y=0;y<u.length;++y){h=u[y].splitWithSegment(c,t);if(h){p=h.lines,p.length>0&&(p.unshift(y,1),Array.prototype.splice.apply(u,p),y+=p.length-2);if(r)for(var b=0,w=h.points.length;b<w;++b)d=h.points[b],d.equals(f)||(v.push(d),o.push(new OpenLayers.Geometry.LineString(v)),d.equals(l)?v=[]:v=[d.clone()])}}}r&&o.length>0&&v.length>0&&(v.push(l.clone()),o.push(new OpenLayers.Geometry.LineString(v)))}else n=e.splitWith(this,t);u&&u.length>1?s=!0:u=[],o&&o.length>1?i=!0:o=[];if(s||i)r?n=[o,u]:n=u;return n},splitWith:function(e,t){return e.split(this,t)},getVertices:function(e){var t;return e===!0?t=[this.components[0],this.components[this.components.length-1]]:e===!1?t=this.components.slice(1,this.components.length-1):t=this.components.slice(),t},distanceTo:function(e,t){var n=!t||t.edge!==!1,r=n&&t&&t.details,i,s={},o=Number.POSITIVE_INFINITY;if(e instanceof OpenLayers.Geometry.Point){var u=this.getSortedSegments(),a=e.x,f=e.y,l;for(var c=0,h=u.length;c<h;++c){l=u[c],i=OpenLayers.Geometry.distanceToSegment(e,l);if(i.distance<o){o=i.distance,s=i;if(o===0)break}else if(l.x2>a&&(f>l.y1&&f<l.y2||f<l.y1&&f>l.y2))break}r?s={distance:s.distance,x0:s.x,y0:s.y,x1:a,y1:f}:s=s.distance}else if(e instanceof OpenLayers.Geometry.LineString){var p=this.getSortedSegments(),d=e.getSortedSegments(),v,m,g,y,b,w=d.length,E={point:!0};e:for(var c=0,h=p.length;c<h;++c){v=p[c],y=v.x1,b=v.y1;for(var S=0;S<w;++S){m=d[S],g=OpenLayers.Geometry.segmentsIntersect(v,m,E);if(g){o=0,s={distance:0,x0:g.x,y0:g.y,x1:g.x,y1:g.y};break e}i=OpenLayers.Geometry.distanceToSegment({x:y,y:b},m),i.distance<o&&(o=i.distance,s={distance:o,x0:y,y0:b,x1:i.x,y1:i.y})}}r||(s=s.distance);if(o!==0&&v){i=e.distanceTo(new OpenLayers.Geometry.Point(v.x2,v.y2),t);var x=r?i.distance:i;x<o&&(r?s={distance:o,x0:i.x1,y0:i.y1,x1:i.x0,y1:i.y0}:s=x)}}else s=e.distanceTo(this,t),r&&(s={distance:s.distance,x0:s.x1,y0:s.y1,x1:s.x0,y1:s.y0});return s},simplify:function(e){if(this&&this!==null){var t=this.getVertices();if(t.length<3)return this;var n=function(e,t){return e-t},r=function(e,t,n,s){var o=0,a=0;for(var f=t,l;f<n;f++)l=i(e[t],e[n],e[f]),l>o&&(o=l,a=f);o>s&&a!=t&&(u.push(a),r(e,t,a,s),r(e,a,n,s))},i=function(e,t,n){var r=Math.abs(.5*(e.x*t.y+t.x*n.y+n.x*e.y-t.x*e.y-n.x*t.y-e.x*n.y)),i=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),s=r/i*2;return s},s=0,o=t.length-1,u=[];u.push(s),u.push(o);while(t[s].equals(t[o]))o--,u.push(o);r(t,s,o,e);var a=[];u.sort(n);for(var f=0;f<u.length;f++)a.push(t[u[f]]);return new OpenLayers.Geometry.LineString(a)}return this},CLASS_NAME:"OpenLayers.Geometry.LineString"}),OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],addComponent:function(e,t){var n=!1,r=this.components.pop();if(t!=null||!e.equals(r))n=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments);var i=this.components[0];return OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[i]),n},removeComponent:function(e){var t=this.components&&this.components.length>3;if(t){this.components.pop(),OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);var n=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[n])}return t},move:function(e,t){for(var n=0,r=this.components.length;n<r-1;n++)this.components[n].move(e,t)},rotate:function(e,t){for(var n=0,r=this.components.length;n<r-1;++n)this.components[n].rotate(e,t)},resize:function(e,t,n){for(var r=0,i=this.components.length;r<i-1;++r)this.components[r].resize(e,t,n);return this},transform:function(e,t){if(e&&t){for(var n=0,r=this.components.length;n<r-1;n++){var i=this.components[n];i.transform(e,t)}this.bounds=null}return this},getCentroid:function(){if(this.components&&this.components.length>2){var e=0,t=0;for(var n=0;n<this.components.length-1;n++){var r=this.components[n],i=this.components[n+1];e+=(r.x+i.x)*(r.x*i.y-i.x*r.y),t+=(r.y+i.y)*(r.x*i.y-i.x*r.y)}var s=-1*this.getArea(),o=e/(6*s),u=t/(6*s);return new OpenLayers.Geometry.Point(o,u)}return null},getArea:function(){var e=0;if(this.components&&this.components.length>2){var t=0;for(var n=0,r=this.components.length;n<r-1;n++){var i=this.components[n],s=this.components[n+1];t+=(i.x+s.x)*(s.y-i.y)}e=-t/2}return e},getGeodesicArea:function(e){var t=this;if(e){var n=new OpenLayers.Projection("EPSG:4326");n.equals(e)||(t=this.clone().transform(e,n))}var r=0,i=t.components&&t.components.length;if(i>2){var s,o;for(var u=0;u<i-1;u++)s=t.components[u],o=t.components[u+1],r+=OpenLayers.Util.rad(o.x-s.x)*(2+Math.sin(OpenLayers.Util.rad(s.y))+Math.sin(OpenLayers.Util.rad(o.y)));r=r*6378137*6378137/2}return r},containsPoint:function(e){function s(e,t,n,r,i){return(e-i)*((r-t)/(i-n))+r}var t=OpenLayers.Number.limitSigDigs,n=14,r=t(e.x,n),i=t(e.y,n),o=this.components.length-1,u,a,f,l,c,h,p,d,v=0;for(var m=0;m<o;++m){u=this.components[m],f=t(u.x,n),l=t(u.y,n),a=this.components[m+1],c=t(a.x,n),h=t(a.y,n);if(l==h){if(i==l)if(f<=c&&r>=f&&r<=c||f>=c&&r<=f&&r>=c){v=-1;break}continue}p=t(s(i,f,l,c,h),n);if(p==r)if(l<h&&i>=l&&i<=h||l>h&&i<=l&&i>=h){v=-1;break}if(p<=r)continue;if(f!=c&&(p<Math.min(f,c)||p>Math.max(f,c)))continue;(l<h&&i>=l&&i<h||l>h&&i<l&&i>=h)&&++v}var g=v==-1?1:!!(v&1);return g},intersects:function(e){var t=!1;if(e.CLASS_NAME=="OpenLayers.Geometry.Point")t=this.containsPoint(e);else if(e.CLASS_NAME=="OpenLayers.Geometry.LineString")t=e.intersects(this);else if(e.CLASS_NAME=="OpenLayers.Geometry.LinearRing")t=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[e]);else for(var n=0,r=e.components.length;n<r;++n){t=e.components[n].intersects(this);if(t)break}return t},getVertices:function(e){return e===!0?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"}),OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],getArea:function(){var e=0;if(this.components&&this.components.length>0){e+=Math.abs(this.components[0].getArea());for(var t=1,n=this.components.length;t<n;t++)e-=Math.abs(this.components[t].getArea())}return e},getGeodesicArea:function(e){var t=0;if(this.components&&this.components.length>0){t+=Math.abs(this.components[0].getGeodesicArea(e));for(var n=1,r=this.components.length;n<r;n++)t-=Math.abs(this.components[n].getGeodesicArea(e))}return t},containsPoint:function(e){var t=this.components.length,n=!1;if(t>0){n=this.components[0].containsPoint(e);if(n!==1&&n&&t>1){var r;for(var i=1;i<t;++i){r=this.components[i].containsPoint(e);if(r){r===1?n=1:n=!1;break}}}}return n},intersects:function(e){var t=!1,n,r;if(e.CLASS_NAME=="OpenLayers.Geometry.Point")t=this.containsPoint(e);else if(e.CLASS_NAME=="OpenLayers.Geometry.LineString"||e.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){for(n=0,r=this.components.length;n<r;++n){t=e.intersects(this.components[n]);if(t)break}if(!t)for(n=0,r=e.components.length;n<r;++n){t=this.containsPoint(e.components[n]);if(t)break}}else for(n=0,r=e.components.length;n<r;++n){t=this.intersects(e.components[n]);if(t)break}if(!t&&e.CLASS_NAME=="OpenLayers.Geometry.Polygon"){var i=this.components[0];for(n=0,r=i.components.length;n<r;++n){t=e.containsPoint(i.components[n]);if(t)break}}return t},distanceTo:function(e,t){var n=!t||t.edge!==!1,r;return!n&&this.intersects(e)?r=0:r=OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,[e,t]),r},CLASS_NAME:"OpenLayers.Geometry.Polygon"}),OpenLayers.Geometry.Polygon.createRegularPolygon=function(e,t,n,r){var i=Math.PI*(1/n-.5);r&&(i+=r/180*Math.PI);var s,o,u,a=[];for(var f=0;f<n;++f)s=i+f*2*Math.PI/n,o=e.x+t*Math.cos(s),u=e.y+t*Math.sin(s),a.push(new OpenLayers.Geometry.Point(o,u));var l=new OpenLayers.Geometry.LinearRing(a);return new OpenLayers.Geometry.Polygon([l])},OpenLayers.Event={observers:!1,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(e){return e.target||e.srcElement},isSingleTouch:function(e){return e.touches&&e.touches.length==1},isMultiTouch:function(e){return e.touches&&e.touches.length>1},isLeftClick:function(e){return e.which&&e.which==1||e.button&&e.button==1},isRightClick:function(e){return e.which&&e.which==3||e.button&&e.button==2},stop:function(e,t){t||(e.preventDefault?e.preventDefault():e.returnValue=!1),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},findElement:function(e,t){var n=OpenLayers.Event.element(e);while(n.parentNode&&(!n.tagName||n.tagName.toUpperCase()!=t.toUpperCase()))n=n.parentNode;return n},observe:function(e,t,n,r){var i=OpenLayers.Util.getElement(e);r=r||!1,t=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||i.attachEvent)&&(t="keydown"),this.observers||(this.observers={});if(!i._eventCacheID){var s="eventCacheID_";i.id&&(s=i.id+"_"+s),i._eventCacheID=OpenLayers.Util.createUniqueID(s)}var o=i._eventCacheID;this.observers[o]||(this.observers[o]=[]),this.observers[o].push({element:i,name:t,observer:n,useCapture:r}),i.addEventListener?i.addEventListener(t,n,r):i.attachEvent&&i.attachEvent("on"+t,n)},stopObservingElement:function(e){var t=OpenLayers.Util.getElement(e),n=t._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[n])},_removeElementObservers:function(e){if(e)for(var t=e.length-1;t>=0;t--)var n=e[t],r=new Array(n.element,n.name,n.observer,n.useCapture),i=OpenLayers.Event.stopObserving.apply(this,r)},stopObserving:function(e,t,n,r){r=r||!1;var i=OpenLayers.Util.getElement(e),s=i._eventCacheID;t=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||i.detachEvent)&&(t="keydown");var o=!1,u=OpenLayers.Event.observers[s];if(u){var a=0;while(!o&&a<u.length){var f=u[a];if(f.name==t&&f.observer==n&&f.useCapture==r){u.splice(a,1),u.length==0&&delete OpenLayers.Event.observers[s],o=!0;break}a++}}return o&&(i.removeEventListener?i.removeEventListener(t,n,r):i&&i.detachEvent&&i.detachEvent("on"+t,n)),o},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var e in OpenLayers.Event.observers){var t=OpenLayers.Event.observers[e];OpenLayers.Event._removeElementObservers.apply(this,[t])}OpenLayers.Event.observers=!1}},CLASS_NAME:"OpenLayers.Event"},OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,!1),OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur","touchstart","touchmove","touchend","keydown"],listeners:null,object:null,element:null,eventHandler:null,fallThrough:null,includeXY:!1,extensions:null,extensionCount:null,clearMouseListener:null,initialize:function(e,t,n,r,i){OpenLayers.Util.extend(this,i),this.object=e,this.fallThrough=r,this.listeners={},this.extensions={},this.extensionCount={},t!=null&&this.attachToElement(t)},destroy:function(){for(var e in this.extensions)typeof this.extensions[e]!="boolean"&&this.extensions[e].destroy();this.extensions=null,this.element&&(OpenLayers.Event.stopObservingElement(this.element),this.element.hasScrollEvent&&OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener)),this.element=null,this.listeners=null,this.object=null,this.fallThrough=null,this.eventHandler=null},addEventType:function(e){},attachToElement:function(e){this.element?OpenLayers.Event.stopObservingElement(this.element):(this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this),this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this)),this.element=e;for(var t=0,n=this.BROWSER_EVENTS.length;t<n;t++)OpenLayers.Event.observe(e,this.BROWSER_EVENTS[t],this.eventHandler);OpenLayers.Event.observe(e,"dragstart",OpenLayers.Event.stop)},on:function(e){for(var t in e)t!="scope"&&e.hasOwnProperty(t)&&this.register(t,e.scope,e[t])},register:function(e,t,n,r){e in OpenLayers.Events&&!this.extensions[e]&&(this.extensions[e]=new OpenLayers.Events[e](this));if(n!=null){t==null&&(t=this.object);var i=this.listeners[e];i||(i=[],this.listeners[e]=i,this.extensionCount[e]=0);var s={obj:t,func:n};r?(i.splice(this.extensionCount[e],0,s),typeof r=="object"&&r.extension&&this.extensionCount[e]++):i.push(s)}},registerPriority:function(e,t,n){this.register(e,t,n,!0)},un:function(e){for(var t in e)t!="scope"&&e.hasOwnProperty(t)&&this.unregister(t,e.scope,e[t])},unregister:function(e,t,n){t==null&&(t=this.object);var r=this.listeners[e];if(r!=null)for(var i=0,s=r.length;i<s;i++)if(r[i].obj==t&&r[i].func==n){r.splice(i,1);break}},remove:function(e){this.listeners[e]!=null&&(this.listeners[e]=[])},triggerEvent:function(e,t){var n=this.listeners[e];if(!n||n.length==0)return undefined;t==null&&(t={}),t.object=this.object,t.element=this.element,t.type||(t.type=e),n=n.slice();var r;for(var i=0,s=n.length;i<s;i++){var o=n[i];r=o.func.apply(o.obj,[t]);if(r!=undefined&&r==0)break}return this.fallThrough||OpenLayers.Event.stop(t,!0),r},handleBrowserEvent:function(e){var t=e.type,n=this.listeners[t];if(!n||n.length==0)return;var r=e.touches;if(r&&r[0]){var i=0,s=0,o=r.length,u;for(var a=0;a<o;++a)u=r[a],i+=u.clientX,s+=u.clientY;e.clientX=i/o,e.clientY=s/o}this.includeXY&&(e.xy=this.getMousePosition(e)),this.triggerEvent(t,e)},clearMouseCache:function(){this.element.scrolls=null,this.element.lefttop=null;var e=document.body;e&&(e.scrollTop==0&&e.scrollLeft==0||!navigator.userAgent.match(/iPhone/i))&&(this.element.offsets=null)},getMousePosition:function(e){this.includeXY?this.element.hasScrollEvent||(OpenLayers.Event.observe(window,"scroll",this.clearMouseListener),this.element.hasScrollEvent=!0):this.clearMouseCache();if(!this.element.scrolls){var t=OpenLayers.Util.getViewportElement();this.element.scrolls=[t.scrollLeft,t.scrollTop]}return this.element.lefttop||(this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0]),this.element.offsets||(this.element.offsets=OpenLayers.Util.pagePosition(this.element)),new OpenLayers.Pixel(e.clientX+this.element.scrolls[0]-this.element.offsets[0]-this.element.lefttop[0],e.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])},CLASS_NAME:"OpenLayers.Events"}),OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,titleRegEx:/\+title=[^\+]*/,initialize:function(e,t){OpenLayers.Util.extend(this,t),this.projCode=e,window.Proj4js&&(this.proj=new Proj4js.Proj(e))},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(e){var t=e,n=!1;if(t){t instanceof OpenLayers.Projection||(t=new OpenLayers.Projection(t));if(window.Proj4js&&this.proj.defData&&t.proj.defData)n=this.proj.defData.replace(this.titleRegEx,"")==t.proj.defData.replace(this.titleRegEx,"");else if(t.getCode){var r=this.getCode(),i=t.getCode();n=r==i||!!OpenLayers.Projection.transforms[r]&&OpenLayers.Projection.transforms[r][i]===OpenLayers.Projection.nullTransform}}return n},destroy:function(){delete this.proj,delete this.projCode},CLASS_NAME:"OpenLayers.Projection"}),OpenLayers.Projection.transforms={},OpenLayers.Projection.defaults={"EPSG:4326":{units:"degrees",maxExtent:[-180,-90,180,90],yx:!0},"CRS:84":{units:"degrees",maxExtent:[-180,-90,180,90]},"EPSG:900913":{units:"m",maxExtent:[-20037508.34,-20037508.34,20037508.34,20037508.34]}},OpenLayers.Projection.addTransform=function(e,t,n){if(n===OpenLayers.Projection.nullTransform){var r=OpenLayers.Projection.defaults[e];r&&!OpenLayers.Projection.defaults[t]&&(OpenLayers.Projection.defaults[t]=r)}OpenLayers.Projection.transforms[e]||(OpenLayers.Projection.transforms[e]={}),OpenLayers.Projection.transforms[e][t]=n},OpenLayers.Projection.transform=function(e,t,n){if(t&&n){t instanceof OpenLayers.Projection||(t=new OpenLayers.Projection(t)),n instanceof OpenLayers.Projection||(n=new OpenLayers.Projection(n));if(t.proj&&n.proj)e=Proj4js.transform(t.proj,n.proj,e);else{var r=t.getCode(),i=n.getCode(),s=OpenLayers.Projection.transforms;s[r]&&s[r][i]&&s[r][i](e)}}return e},OpenLayers.Projection.nullTransform=function(e){return e},function(){function t(t){return t.x=180*t.x/e,t.y=180/Math.PI*(2*Math.atan(Math.exp(t.y/e*Math.PI))-Math.PI/2),t}function n(t){return t.x=t.x*e/180,t.y=Math.log(Math.tan((90+t.y)*Math.PI/360))/Math.PI*e,t}function r(e,r){var i=OpenLayers.Projection.addTransform,s=OpenLayers.Projection.nullTransform,o,u,a,f,l;for(o=0,u=r.length;o<u;++o){a=r[o],i(e,a,n),i(a,e,t);for(l=o+1;l<u;++l)f=r[l],i(a,f,s),i(f,a,s)}}var e=20037508.34,i=["EPSG:900913","EPSG:3857","EPSG:102113","EPSG:102100"],s=["CRS:84","urn:ogc:def:crs:EPSG:6.6:4326","EPSG:4326"],o;for(o=i.length-1;o>=0;--o)r(i[o],s);for(o=s.length-1;o>=0;--o)r(s[o],i)}(),OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1e3},id:null,fractionalZoom:!1,events:null,allOverlays:!1,div:null,dragging:!1,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,options:null,tileSize:null,projection:"EPSG:4326",units:null,resolutions:null,maxResolution:null,minResolution:null,maxScale:null,minScale:null,maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:!0,panTween:null,eventListeners:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,paddingForPopups:null,minPx:null,maxPx:null,initialize:function(e,t){arguments.length===1&&typeof e=="object"&&(t=e,e=t&&t.div),this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT),this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15),this.theme=OpenLayers._getScriptLocation()+"theme/default/style.css",this.options=OpenLayers.Util.extend({},t),OpenLayers.Util.extend(this,t);var n=this.projection instanceof OpenLayers.Projection?this.projection.projCode:this.projection;OpenLayers.Util.applyDefaults(this,OpenLayers.Projection.defaults[n]),this.maxExtent&&!(this.maxExtent instanceof OpenLayers.Bounds)&&(this.maxExtent=new OpenLayers.Bounds(this.maxExtent)),this.minExtent&&!(this.minExtent instanceof OpenLayers.Bounds)&&(this.minExtent=new OpenLayers.Bounds(this.minExtent)),this.restrictedExtent&&!(this.restrictedExtent instanceof OpenLayers.Bounds)&&(this.restrictedExtent=new OpenLayers.Bounds(this.restrictedExtent)),this.center&&!(this.center instanceof OpenLayers.LonLat)&&(this.center=new OpenLayers.LonLat(this.center)),this.layers=[],this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_"),this.div=OpenLayers.Util.getElement(e),this.div||(this.div=document.createElement("div"),this.div.style.height="1px",this.div.style.width="1px"),OpenLayers.Element.addClass(this.div,"olMap");var r=this.id+"_OpenLayers_ViewPort";this.viewPortDiv=OpenLayers.Util.createDiv(r,null,null,null,"relative",null,"hidden"),this.viewPortDiv.style.width="100%",this.viewPortDiv.style.height="100%",this.viewPortDiv.className="olMapViewport",this.div.appendChild(this.viewPortDiv),this.events=new OpenLayers.Events(this,this.viewPortDiv,null,this.fallThrough,{includeXY:!0}),r=this.id+"_OpenLayers_Container",this.layerContainerDiv=OpenLayers.Util.createDiv(r),this.layerContainerDiv.style.width="100px",this.layerContainerDiv.style.height="100px",this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1,this.viewPortDiv.appendChild(this.layerContainerDiv),this.updateSize(),this.eventListeners instanceof Object&&this.events.on(this.eventListeners),parseFloat(navigator.appVersion.split("MSIE")[1])<9?this.events.register("resize",this,this.updateSize):(this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this),OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy));if(this.theme){var i=!0,s=document.getElementsByTagName("link");for(var o=0,u=s.length;o<u;++o)if(OpenLayers.Util.isEquivalentUrl(s.item(o).href,this.theme)){i=!1;break}if(i){var a=document.createElement("link");a.setAttribute("rel","stylesheet"),a.setAttribute("type","text/css"),a.setAttribute("href",this.theme),document.getElementsByTagName("head")[0].appendChild(a)}}this.controls==null&&(this.controls=[],OpenLayers.Control!=null&&(OpenLayers.Control.Navigation?this.controls.push(new OpenLayers.Control.Navigation):OpenLayers.Control.TouchNavigation&&this.controls.push(new OpenLayers
.Control.TouchNavigation),OpenLayers.Control.Zoom?this.controls.push(new OpenLayers.Control.Zoom):OpenLayers.Control.PanZoom&&this.controls.push(new OpenLayers.Control.PanZoom),OpenLayers.Control.ArgParser&&this.controls.push(new OpenLayers.Control.ArgParser),OpenLayers.Control.Attribution&&this.controls.push(new OpenLayers.Control.Attribution)));for(var o=0,u=this.controls.length;o<u;o++)this.addControlToMap(this.controls[o]);this.popups=[],this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this),OpenLayers.Event.observe(window,"unload",this.unloadDestroy),t&&t.layers&&(delete this.center,this.addLayers(t.layers),t.center&&!this.getCenter()&&this.setCenter(t.center,t.zoom))},getViewport:function(){return this.viewPortDiv},render:function(e){this.div=OpenLayers.Util.getElement(e),OpenLayers.Element.addClass(this.div,"olMap"),this.viewPortDiv.parentNode.removeChild(this.viewPortDiv),this.div.appendChild(this.viewPortDiv),this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy)return!1;this.panTween&&(this.panTween.stop(),this.panTween=null),OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy),this.unloadDestroy=null,this.updateSizeDestroy?OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy):this.events.unregister("resize",this,this.updateSize),this.paddingForPopups=null;if(this.controls!=null){for(var e=this.controls.length-1;e>=0;--e)this.controls[e].destroy();this.controls=null}if(this.layers!=null){for(var e=this.layers.length-1;e>=0;--e)this.layers[e].destroy(!1);this.layers=null}this.viewPortDiv&&this.div.removeChild(this.viewPortDiv),this.viewPortDiv=null,this.eventListeners&&(this.events.un(this.eventListeners),this.eventListeners=null),this.events.destroy(),this.events=null,this.options=null},setOptions:function(e){var t=this.minPx&&e.restrictedExtent!=this.restrictedExtent;OpenLayers.Util.extend(this,e),t&&this.moveTo(this.getCachedCenter(),this.zoom,{forceZoomChange:!0})},getTileSize:function(){return this.tileSize},getBy:function(e,t,n){var r=typeof n.test=="function",i=OpenLayers.Array.filter(this[e],function(e){return e[t]==n||r&&n.test(e[t])});return i},getLayersBy:function(e,t){return this.getBy("layers",e,t)},getLayersByName:function(e){return this.getLayersBy("name",e)},getLayersByClass:function(e){return this.getLayersBy("CLASS_NAME",e)},getControlsBy:function(e,t){return this.getBy("controls",e,t)},getControlsByClass:function(e){return this.getControlsBy("CLASS_NAME",e)},getLayer:function(e){var t=null;for(var n=0,r=this.layers.length;n<r;n++){var i=this.layers[n];if(i.id==e){t=i;break}}return t},setLayerZIndex:function(e,t){e.setZIndex(this.Z_INDEX_BASE[e.isBaseLayer?"BaseLayer":"Overlay"]+t*5)},resetLayersZIndex:function(){for(var e=0,t=this.layers.length;e<t;e++){var n=this.layers[e];this.setLayerZIndex(n,e)}},addLayer:function(e){for(var t=0,n=this.layers.length;t<n;t++)if(this.layers[t]==e)return!1;return this.events.triggerEvent("preaddlayer",{layer:e})===!1?!1:(this.allOverlays&&(e.isBaseLayer=!1),e.div.className="olLayerDiv",e.div.style.overflow="",this.setLayerZIndex(e,this.layers.length),e.isFixed?this.viewPortDiv.appendChild(e.div):this.layerContainerDiv.appendChild(e.div),this.layers.push(e),e.setMap(this),e.isBaseLayer||this.allOverlays&&!this.baseLayer?this.baseLayer==null?this.setBaseLayer(e):e.setVisibility(!1):e.redraw(),this.events.triggerEvent("addlayer",{layer:e}),e.events.triggerEvent("added",{map:this,layer:e}),e.afterAdd(),!0)},addLayers:function(e){for(var t=0,n=e.length;t<n;t++)this.addLayer(e[t])},removeLayer:function(e,t){if(this.events.triggerEvent("preremovelayer",{layer:e})===!1)return;t==null&&(t=!0),e.isFixed?this.viewPortDiv.removeChild(e.div):this.layerContainerDiv.removeChild(e.div),OpenLayers.Util.removeItem(this.layers,e),e.removeMap(this),e.map=null;if(this.baseLayer==e){this.baseLayer=null;if(t)for(var n=0,r=this.layers.length;n<r;n++){var i=this.layers[n];if(i.isBaseLayer||this.allOverlays){this.setBaseLayer(i);break}}}this.resetLayersZIndex(),this.events.triggerEvent("removelayer",{layer:e}),e.events.triggerEvent("removed",{map:this,layer:e})},getNumLayers:function(){return this.layers.length},getLayerIndex:function(e){return OpenLayers.Util.indexOf(this.layers,e)},setLayerIndex:function(e,t){var n=this.getLayerIndex(e);t<0?t=0:t>this.layers.length&&(t=this.layers.length);if(n!=t){this.layers.splice(n,1),this.layers.splice(t,0,e);for(var r=0,i=this.layers.length;r<i;r++)this.setLayerZIndex(this.layers[r],r);this.events.triggerEvent("changelayer",{layer:e,property:"order"}),this.allOverlays&&(t===0?this.setBaseLayer(e):this.baseLayer!==this.layers[0]&&this.setBaseLayer(this.layers[0]))}},raiseLayer:function(e,t){var n=this.getLayerIndex(e)+t;this.setLayerIndex(e,n)},setBaseLayer:function(e){if(e!=this.baseLayer&&OpenLayers.Util.indexOf(this.layers,e)!=-1){var t=this.getCachedCenter(),n=OpenLayers.Util.getResolutionFromScale(this.getScale(),e.units);this.baseLayer!=null&&!this.allOverlays&&this.baseLayer.setVisibility(!1),this.baseLayer=e;if(!this.allOverlays||this.baseLayer.visibility)this.baseLayer.setVisibility(!0),this.baseLayer.inRange===!1&&this.baseLayer.redraw();if(t!=null){var r=this.getZoomForResolution(n||this.resolution,!0);this.setCenter(t,r,!1,!0)}this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}},addControl:function(e,t){this.controls.push(e),this.addControlToMap(e,t)},addControls:function(e,t){var n=arguments.length===1?[]:t;for(var r=0,i=e.length;r<i;r++){var s=e[r],o=n[r]?n[r]:null;this.addControl(s,o)}},addControlToMap:function(e,t){e.outsideViewport=e.div!=null,this.displayProjection&&!e.displayProjection&&(e.displayProjection=this.displayProjection),e.setMap(this);var n=e.draw(t);n&&(e.outsideViewport||(n.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length,this.viewPortDiv.appendChild(n))),e.autoActivate&&e.activate()},getControl:function(e){var t=null;for(var n=0,r=this.controls.length;n<r;n++){var i=this.controls[n];if(i.id==e){t=i;break}}return t},removeControl:function(e){e&&e==this.getControl(e.id)&&(e.div&&e.div.parentNode==this.viewPortDiv&&this.viewPortDiv.removeChild(e.div),OpenLayers.Util.removeItem(this.controls,e))},addPopup:function(e,t){if(t)for(var n=this.popups.length-1;n>=0;--n)this.removePopup(this.popups[n]);e.map=this,this.popups.push(e);var r=e.draw();r&&(r.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length,this.layerContainerDiv.appendChild(r))},removePopup:function(e){OpenLayers.Util.removeItem(this.popups,e);if(e.div)try{this.layerContainerDiv.removeChild(e.div)}catch(t){}e.map=null},getSize:function(){var e=null;return this.size!=null&&(e=this.size.clone()),e},updateSize:function(){var e=this.getCurrentSize();if(e&&!isNaN(e.h)&&!isNaN(e.w)){this.events.clearMouseCache();var t=this.getSize();t==null&&(this.size=t=e);if(!e.equals(t)){this.size=e;for(var n=0,r=this.layers.length;n<r;n++)this.layers[n].onMapResize();var i=this.getCachedCenter();if(this.baseLayer!=null&&i!=null){var s=this.getZoom();this.zoom=null,this.setCenter(i,s)}}}},getCurrentSize:function(){var e=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);if(e.w==0&&e.h==0||isNaN(e.w)&&isNaN(e.h))e.w=this.div.offsetWidth,e.h=this.div.offsetHeight;if(e.w==0&&e.h==0||isNaN(e.w)&&isNaN(e.h))e.w=parseInt(this.div.style.width),e.h=parseInt(this.div.style.height);return e},calculateBounds:function(e,t){var n=null;e==null&&(e=this.getCachedCenter()),t==null&&(t=this.getResolution());if(e!=null&&t!=null){var r=this.size.w*t/2,i=this.size.h*t/2;n=new OpenLayers.Bounds(e.lon-r,e.lat-i,e.lon+r,e.lat+i)}return n},getCenter:function(){var e=null,t=this.getCachedCenter();return t&&(e=t.clone()),e},getCachedCenter:function(){return!this.center&&this.size&&(this.center=this.getLonLatFromViewPortPx({x:this.size.w/2,y:this.size.h/2})),this.center},getZoom:function(){return this.zoom},pan:function(e,t,n){n=OpenLayers.Util.applyDefaults(n,{animate:!0,dragging:!1});if(n.dragging)(e!=0||t!=0)&&this.moveByPx(e,t);else{var r=this.getViewPortPxFromLonLat(this.getCachedCenter()),i=r.add(e,t);if(this.dragging||!i.equals(r)){var s=this.getLonLatFromViewPortPx(i);n.animate?this.panTo(s):(this.moveTo(s),this.dragging&&(this.dragging=!1,this.events.triggerEvent("moveend")))}}},panTo:function(e){if(this.panMethod&&this.getExtent().scale(this.panRatio).containsLonLat(e)){this.panTween||(this.panTween=new OpenLayers.Tween(this.panMethod));var t=this.getCachedCenter();if(e.equals(t))return;var n=this.getPixelFromLonLat(t),r=this.getPixelFromLonLat(e),i={x:r.x-n.x,y:r.y-n.y},s={x:0,y:0};this.panTween.start({x:0,y:0},i,this.panDuration,{callbacks:{eachStep:OpenLayers.Function.bind(function(e){var t=e.x-s.x,n=e.y-s.y;this.moveByPx(t,n),s.x=Math.round(e.x),s.y=Math.round(e.y)},this),done:OpenLayers.Function.bind(function(t){this.moveTo(e),this.dragging=!1,this.events.triggerEvent("moveend")},this)}})}else this.setCenter(e)},setCenter:function(e,t,n,r){this.panTween&&this.panTween.stop(),this.moveTo(e,t,{dragging:n,forceZoomChange:r})},moveByPx:function(e,t){var n=this.size.w/2,r=this.size.h/2,i=n+e,s=r+t,o=this.baseLayer.wrapDateLine,u=0,a=0;this.restrictedExtent&&(u=n,a=r,o=!1),e=o||i<=this.maxPx.x-u&&i>=this.minPx.x+u?Math.round(e):0,t=s<=this.maxPx.y-a&&s>=this.minPx.y+a?Math.round(t):0;if(e||t){this.dragging||(this.dragging=!0,this.events.triggerEvent("movestart")),this.center=null,e&&(this.layerContainerDiv.style.left=parseInt(this.layerContainerDiv.style.left)-e+"px",this.minPx.x-=e,this.maxPx.x-=e),t&&(this.layerContainerDiv.style.top=parseInt(this.layerContainerDiv.style.top)-t+"px",this.minPx.y-=t,this.maxPx.y-=t);var f,l,c;for(l=0,c=this.layers.length;l<c;++l)f=this.layers[l],f.visibility&&(f===this.baseLayer||f.inRange)&&(f.moveByPx(e,t),f.events.triggerEvent("move"));this.events.triggerEvent("move")}},adjustZoom:function(e){var t,n=this.baseLayer.resolutions,r=this.getMaxExtent().getWidth()/this.size.w;if(this.getResolutionForZoom(e)>r)for(var i=e|0,s=n.length;i<s;++i)if(n[i]<=r){e=i;break}return e},moveTo:function(e,t,n){e!=null&&!(e instanceof OpenLayers.LonLat)&&(e=new OpenLayers.LonLat(e)),n||(n={}),t!=null&&(t=parseFloat(t),this.fractionalZoom||(t=Math.round(t)));if(this.baseLayer.wrapDateLine){var r=t;t=this.adjustZoom(t),t!==r&&(e=this.getCenter())}var i=n.dragging||this.dragging,s=n.forceZoomChange;!this.getCachedCenter()&&!this.isValidLonLat(e)&&(e=this.maxExtent.getCenterLonLat(),this.center=e.clone());if(this.restrictedExtent!=null){e==null&&(e=this.center),t==null&&(t=this.getZoom());var o=this.getResolutionForZoom(t),u=this.calculateBounds(e,o);if(!this.restrictedExtent.containsBounds(u)){var a=this.restrictedExtent.getCenterLonLat();u.getWidth()>this.restrictedExtent.getWidth()?e=new OpenLayers.LonLat(a.lon,e.lat):u.left<this.restrictedExtent.left?e=e.add(this.restrictedExtent.left-u.left,0):u.right>this.restrictedExtent.right&&(e=e.add(this.restrictedExtent.right-u.right,0)),u.getHeight()>this.restrictedExtent.getHeight()?e=new OpenLayers.LonLat(e.lon,a.lat):u.bottom<this.restrictedExtent.bottom?e=e.add(0,this.restrictedExtent.bottom-u.bottom):u.top>this.restrictedExtent.top&&(e=e.add(0,this.restrictedExtent.top-u.top))}}var f=s||this.isValidZoomLevel(t)&&t!=this.getZoom(),l=this.isValidLonLat(e)&&!e.equals(this.center);if(f||l||i){i||this.events.triggerEvent("movestart"),l&&(!f&&this.center&&this.centerLayerContainer(e),this.center=e.clone());var c=f?this.getResolutionForZoom(t):this.getResolution();if(f||this.layerContainerOrigin==null){this.layerContainerOrigin=this.getCachedCenter(),this.layerContainerDiv.style.left="0px",this.layerContainerDiv.style.top="0px";var h=this.getMaxExtent({restricted:!0}),p=h.getCenterLonLat(),d=this.center.lon-p.lon,v=p.lat-this.center.lat,m=Math.round(h.getWidth()/c),g=Math.round(h.getHeight()/c);this.minPx={x:(this.size.w-m)/2-d/c,y:(this.size.h-g)/2-v/c},this.maxPx={x:this.minPx.x+Math.round(h.getWidth()/c),y:this.minPx.y+Math.round(h.getHeight()/c)}}f&&(this.zoom=t,this.resolution=c);var y=this.getExtent();this.baseLayer.visibility&&(this.baseLayer.moveTo(y,f,n.dragging),n.dragging||this.baseLayer.events.triggerEvent("moveend",{zoomChanged:f})),y=this.baseLayer.getExtent();for(var b=this.layers.length-1;b>=0;--b){var w=this.layers[b];if(w!==this.baseLayer&&!w.isBaseLayer){var E=w.calculateInRange();w.inRange!=E&&(w.inRange=E,E||w.display(!1),this.events.triggerEvent("changelayer",{layer:w,property:"visibility"})),E&&w.visibility&&(w.moveTo(y,f,n.dragging),n.dragging||w.events.triggerEvent("moveend",{zoomChanged:f}))}}this.events.triggerEvent("move"),i||this.events.triggerEvent("moveend");if(f){for(var b=0,S=this.popups.length;b<S;b++)this.popups[b].updatePosition();this.events.triggerEvent("zoomend")}}},centerLayerContainer:function(e){var t=this.getViewPortPxFromLonLat(this.layerContainerOrigin),n=this.getViewPortPxFromLonLat(e);if(t!=null&&n!=null){var r=parseInt(this.layerContainerDiv.style.left),i=parseInt(this.layerContainerDiv.style.top),s=Math.round(t.x-n.x),o=Math.round(t.y-n.y);this.layerContainerDiv.style.left=s+"px",this.layerContainerDiv.style.top=o+"px";var u=r-s,a=i-o;this.minPx.x-=u,this.maxPx.x-=u,this.minPx.y-=a,this.maxPx.y-=a}},isValidZoomLevel:function(e){return e!=null&&e>=0&&e<this.getNumZoomLevels()},isValidLonLat:function(e){var t=!1;if(e!=null){var n=this.getMaxExtent(),r=this.baseLayer.wrapDateLine&&n;t=n.containsLonLat(e,{worldBounds:r})}return t},getProjection:function(){var e=this.getProjectionObject();return e?e.getCode():null},getProjectionObject:function(){var e=null;return this.baseLayer!=null&&(e=this.baseLayer.projection),e},getMaxResolution:function(){var e=null;return this.baseLayer!=null&&(e=this.baseLayer.maxResolution),e},getMaxExtent:function(e){var t=null;return e&&e.restricted&&this.restrictedExtent?t=this.restrictedExtent:this.baseLayer!=null&&(t=this.baseLayer.maxExtent),t},getNumZoomLevels:function(){var e=null;return this.baseLayer!=null&&(e=this.baseLayer.numZoomLevels),e},getExtent:function(){var e=null;return this.baseLayer!=null&&(e=this.baseLayer.getExtent()),e},getResolution:function(){var e=null;return this.baseLayer!=null?e=this.baseLayer.getResolution():this.allOverlays===!0&&this.layers.length>0&&(e=this.layers[0].getResolution()),e},getUnits:function(){var e=null;return this.baseLayer!=null&&(e=this.baseLayer.units),e},getScale:function(){var e=null;if(this.baseLayer!=null){var t=this.getResolution(),n=this.baseLayer.units;e=OpenLayers.Util.getScaleFromResolution(t,n)}return e},getZoomForExtent:function(e,t){var n=null;return this.baseLayer!=null&&(n=this.baseLayer.getZoomForExtent(e,t)),n},getResolutionForZoom:function(e){var t=null;return this.baseLayer&&(t=this.baseLayer.getResolutionForZoom(e)),t},getZoomForResolution:function(e,t){var n=null;return this.baseLayer!=null&&(n=this.baseLayer.getZoomForResolution(e,t)),n},zoomTo:function(e){this.isValidZoomLevel(e)&&this.setCenter(null,e)},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(e,t){e instanceof OpenLayers.Bounds||(e=new OpenLayers.Bounds(e));var n=e.getCenterLonLat();if(this.baseLayer.wrapDateLine){var r=this.getMaxExtent();e=e.clone();while(e.right<e.left)e.right+=r.getWidth();n=e.getCenterLonLat().wrapDateLine(r)}this.setCenter(n,this.getZoomForExtent(e,t))},zoomToMaxExtent:function(e){var t=e?e.restricted:!0,n=this.getMaxExtent({restricted:t});this.zoomToExtent(n)},zoomToScale:function(e,t){var n=OpenLayers.Util.getResolutionFromScale(e,this.baseLayer.units),r=this.size.w*n/2,i=this.size.h*n/2,s=this.getCachedCenter(),o=new OpenLayers.Bounds(s.lon-r,s.lat-i,s.lon+r,s.lat+i);this.zoomToExtent(o,t)},getLonLatFromViewPortPx:function(e){var t=null;return this.baseLayer!=null&&(t=this.baseLayer.getLonLatFromViewPortPx(e)),t},getViewPortPxFromLonLat:function(e){var t=null;return this.baseLayer!=null&&(t=this.baseLayer.getViewPortPxFromLonLat(e)),t},getLonLatFromPixel:function(e){return this.getLonLatFromViewPortPx(e)},getPixelFromLonLat:function(e){var t=this.getViewPortPxFromLonLat(e);return t.x=Math.round(t.x),t.y=Math.round(t.y),t},getGeodesicPixelSize:function(e){var t=e?this.getLonLatFromPixel(e):this.getCachedCenter()||new OpenLayers.LonLat(0,0),n=this.getResolution(),r=t.add(-n/2,0),i=t.add(n/2,0),s=t.add(0,-n/2),o=t.add(0,n/2),u=new OpenLayers.Projection("EPSG:4326"),a=this.getProjectionObject()||u;return a.equals(u)||(r.transform(a,u),i.transform(a,u),s.transform(a,u),o.transform(a,u)),new OpenLayers.Size(OpenLayers.Util.distVincenty(r,i),OpenLayers.Util.distVincenty(s,o))},getViewPortPxFromLayerPx:function(e){var t=null;if(e!=null){var n=parseInt(this.layerContainerDiv.style.left),r=parseInt(this.layerContainerDiv.style.top);t=e.add(n,r)}return t},getLayerPxFromViewPortPx:function(e){var t=null;if(e!=null){var n=-parseInt(this.layerContainerDiv.style.left),r=-parseInt(this.layerContainerDiv.style.top);t=e.add(n,r);if(isNaN(t.x)||isNaN(t.y))t=null}return t},getLonLatFromLayerPx:function(e){return e=this.getViewPortPxFromLayerPx(e),this.getLonLatFromViewPortPx(e)},getLayerPxFromLonLat:function(e){var t=this.getPixelFromLonLat(e);return this.getLayerPxFromViewPortPx(t)},CLASS_NAME:"OpenLayers.Map"}),OpenLayers.Map.TILE_WIDTH=256,OpenLayers.Map.TILE_HEIGHT=256,OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:1,alwaysInRange:null,RESOLUTION_PROPERTIES:["scales","resolutions","maxScale","minScale","maxResolution","minResolution","numZoomLevels","maxZoomLevel"],events:null,map:null,isBaseLayer:!1,alpha:!1,displayInLayerSwitcher:!0,visibility:!0,attribution:null,inRange:!1,imageSize:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:!1,wrapDateLine:!1,metadata:null,initialize:function(e,t){this.metadata={},this.addOptions(t),this.name=e,this.id==null&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"),this.div=OpenLayers.Util.createDiv(this.id),this.div.style.width="100%",this.div.style.height="100%",this.div.dir="ltr",this.events=new OpenLayers.Events(this,this.div),this.eventListeners instanceof Object&&this.events.on(this.eventListeners))},destroy:function(e){e==null&&(e=!0),this.map!=null&&this.map.removeLayer(this,e),this.projection=null,this.map=null,this.name=null,this.div=null,this.options=null,this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy()),this.eventListeners=null,this.events=null},clone:function(e){return e==null&&(e=new OpenLayers.Layer(this.name,this.getOptions())),OpenLayers.Util.applyDefaults(e,this),e.map=null,e},getOptions:function(){var e={};for(var t in this.options)e[t]=this[t];return e},setName:function(e){e!=this.name&&(this.name=e,this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"name"}))},addOptions:function(e,t){this.options==null&&(this.options={}),e&&(typeof e.projection=="string"&&(e.projection=new OpenLayers.Projection(e.projection)),e.projection&&OpenLayers.Util.applyDefaults(e,OpenLayers.Projection.defaults[e.projection.getCode()]),e.maxExtent&&!(e.maxExtent instanceof OpenLayers.Bounds)&&(e.maxExtent=new OpenLayers.Bounds(e.maxExtent)),e.minExtent&&!(e.minExtent instanceof OpenLayers.Bounds)&&(e.minExtent=new OpenLayers.Bounds(e.minExtent))),OpenLayers.Util.extend(this.options,e),OpenLayers.Util.extend(this,e),this.projection&&this.projection.getUnits()&&(this.units=this.projection.getUnits());if(this.map){var n=this.map.getResolution(),r=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]);for(var i in e)if(e.hasOwnProperty(i)&&OpenLayers.Util.indexOf(r,i)>=0){this.initResolutions(),t&&this.map.baseLayer===this&&(this.map.setCenter(this.map.getCenter(),this.map.getZoomForResolution(n),!1,!0),this.map.events.triggerEvent("changebaselayer",{layer:this}));break}}},onMapResize:function(){},redraw:function(){var e=!1;if(this.map){this.inRange=this.calculateInRange();var t=this.getExtent();if(t&&this.inRange&&this.visibility){var n=!0;this.moveTo(t,n,!1),this.events.triggerEvent("moveend",{zoomChanged:n}),e=!0}}return e},moveTo:function(e,t,n){var r=this.visibility;this.isBaseLayer||(r=r&&this.inRange),this.display(r)},moveByPx:function(e,t){},setMap:function(e){if(this.map==null){this.map=e,this.maxExtent=this.maxExtent||this.map.maxExtent,this.minExtent=this.minExtent||this.map.minExtent,this.projection=this.projection||this.map.projection,typeof this.projection=="string"&&(this.projection=new OpenLayers.Projection(this.projection)),this.units=this.projection.getUnits()||this.units||this.map.units,this.initResolutions();if(!this.isBaseLayer){this.inRange=this.calculateInRange();var t=this.visibility&&this.inRange;this.div.style.display=t?"":"none"}this.setTileSize()}},afterAdd:function(){},removeMap:function(e){},getImageSize:function(e){return this.imageSize||this.tileSize},setTileSize:function(e){var t=e?e:this.tileSize?this.tileSize:this.map.getTileSize();this.tileSize=t,this.gutter&&(this.imageSize=new OpenLayers.Size(t.w+2*this.gutter,t.h+2*this.gutter))},getVisibility:function(){return this.visibility},setVisibility:function(e){e!=this.visibility&&(this.visibility=e,this.display(e),this.redraw(),this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"}),this.events.triggerEvent("visibilitychanged"))},display:function(e){e!=(this.div.style.display!="none")&&(this.div.style.display=e&&this.calculateInRange()?"block":"none")},calculateInRange:function(){var e=!1;if(this.alwaysInRange)e=!0;else if(this.map){var t=this.map.getResolution();e=t>=this.minResolution&&t<=this.maxResolution}return e},setIsBaseLayer:function(e){e!=this.isBaseLayer&&(this.isBaseLayer=e,this.map!=null&&this.map.events.triggerEvent("changebaselayer",{layer:this}))},initResolutions:function(){var e,t,n,r={},i=!0;for(e=0,t=this.RESOLUTION_PROPERTIES.length;e<t;e++)n=this.RESOLUTION_PROPERTIES[e],r[n]=this.options[n],i&&this.options[n]&&(i=!1);this.alwaysInRange==null&&(this.alwaysInRange=i),r.resolutions==null&&(r.resolutions=this.resolutionsFromScales(r.scales)),r.resolutions==null&&(r.resolutions=this.calculateResolutions(r));if(r.resolutions==null){for(e=0,t=this.RESOLUTION_PROPERTIES.length;e<t;e++)n=this.RESOLUTION_PROPERTIES[e],r[n]=this.options[n]!=null?this.options[n]:this.map[n];r.resolutions==null&&(r.resolutions=this.resolutionsFromScales(r.scales)),r.resolutions==null&&(r.resolutions=this.calculateResolutions(r))}var s;this.options.maxResolution&&this.options.maxResolution!=="auto"&&(s=this.options.maxResolution),this.options.minScale&&(s=OpenLayers.Util.getResolutionFromScale(this.options.minScale,this.units));var o;this.options.minResolution&&this.options.minResolution!=="auto"&&(o=this.options.minResolution),this.options.maxScale&&(o=OpenLayers.Util.getResolutionFromScale(this.options.maxScale,this.units));if(r.resolutions){r.resolutions.sort(function(e,t){return t-e}),s||(s=r.resolutions[0]);if(!o){var u=r.resolutions.length-1;o=r.resolutions[u]}}this.resolutions=r.resolutions;if(this.resolutions){t=this.resolutions.length,this.scales=new Array(t);for(e=0;e<t;e++)this.scales[e]=OpenLayers.Util.getScaleFromResolution(this.resolutions[e],this.units);this.numZoomLevels=t}this.minResolution=o,o&&(this.maxScale=OpenLayers.Util.getScaleFromResolution(o,this.units)),this.maxResolution=s,s&&(this.minScale=OpenLayers.Util.getScaleFromResolution(s,this.units))},resolutionsFromScales:function(e){if(e==null)return;var t,n,r;r=e.length,t=new Array(r);for(n=0;n<r;n++)t[n]=OpenLayers.Util.getResolutionFromScale(e[n],this.units);return t},calculateResolutions:function(e){var t,n,r,i=e.maxResolution;e.minScale!=null?i=OpenLayers.Util.getResolutionFromScale(e.minScale,this.units):i=="auto"&&this.maxExtent!=null&&(t=this.map.getSize(),n=this.maxExtent.getWidth()/t.w,r=this.maxExtent.getHeight()/t.h,i=Math.max(n,r));var s=e.minResolution;e.maxScale!=null?s=OpenLayers.Util.getResolutionFromScale(e.maxScale,this.units):e.minResolution=="auto"&&this.minExtent!=null&&(t=this.map.getSize(),n=this.minExtent.getWidth()/t.w,r=this.minExtent.getHeight()/t.h,s=Math.max(n,r));if(typeof i!="number"&&typeof s!="number"&&this.maxExtent!=null){var o=this.map.getTileSize();i=Math.max(this.maxExtent.getWidth()/o.w,this.maxExtent.getHeight()/o.h)}var u=e.maxZoomLevel,a=e.numZoomLevels;if(typeof s=="number"&&typeof i=="number"&&a===undefined){var f=i/s;a=Math.floor(Math.log(f)/Math.log(2))+1}else a===undefined&&u!=null&&(a=u+1);if(typeof a!="number"||a<=0||typeof i!="number"&&typeof s!="number")return;var l=new Array(a),c=2;typeof s=="number"&&typeof i=="number"&&(c=Math.pow(i/s,1/(a-1)));var h;if(typeof i=="number")for(h=0;h<a;h++)l[h]=i/Math.pow(c,h);else for(h=0;h<a;h++)l[a-1-h]=s*Math.pow(c,h);return l},getResolution:function(){var e=this.map.getZoom();return this.getResolutionForZoom(e)},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(e,t){var n=this.map.getSize(),r=Math.max(e.getWidth()/n.w,e.getHeight()/n.h);return this.getZoomForResolution(r,t)},getDataExtent:function(){},getResolutionForZoom:function(e){e=Math.max(0,Math.min(e,this.resolutions.length-1));var t;if(this.map.fractionalZoom){var n=Math.floor(e),r=Math.ceil(e);t=this.resolutions[n]-(e-n)*(this.resolutions[n]-this.resolutions[r])}else t=this.resolutions[Math.round(e)];return t},getZoomForResolution:function(e,t){var n,r,i;if(this.map.fractionalZoom){var s=0,o=this.resolutions.length-1,u=this.resolutions[s],a=this.resolutions[o],f;for(r=0,i=this.resolutions.length;r<i;++r){f=this.resolutions[r],f>=e&&(u=f,s=r);if(f<=e){a=f,o=r;break}}var l=u-a;l>0?n=s+(u-e)/l:n=s}else{var c,h=Number.POSITIVE_INFINITY;for(r=0,i=this.resolutions.length;r<i;r++)if(t){c=Math.abs(this.resolutions[r]-e);if(c>h)break;h=c}else if(this.resolutions[r]<e)break;n=Math.max(0,r-1)}return n},getLonLatFromViewPortPx:function(e){var t=null,n=this.map;if(e!=null&&n.minPx){var r=n.getResolution(),i=n.getMaxExtent({restricted:!0}),s=(e.x-n.minPx.x)*r+i.left,o=(n.minPx.y-e.y)*r+i.top;t=new OpenLayers.LonLat(s,o),this.wrapDateLine&&(t=t.wrapDateLine(this.maxExtent))}return t},getViewPortPxFromLonLat:function(e,t){var n=null;if(e!=null){t=t||this.map.getResolution();var r=this.map.calculateBounds(null,t);n=new OpenLayers.Pixel(1/t*(e.lon-r.left),1/t*(r.top-e.lat))}return n},setOpacity:function(e){if(e!=this.opacity){this.opacity=e;var t=this.div.childNodes;for(var n=0,r=t.length;n<r;++n){var i=t[n].firstChild||t[n],s=t[n].lastChild;s&&s.nodeName.toLowerCase()==="iframe"&&(i=s.parentNode),OpenLayers.Util.modifyDOMElement(i,null,null,null,null,null,null,e)}this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(e){this.div.style.zIndex=e},adjustBounds:function(e){if(this.gutter){var t=this.gutter*this.map.getResolution();e=new OpenLayers.Bounds(e.left-t,e.bottom-t,e.right+t,e.top+t)}if(this.wrapDateLine){var n={rightTolerance:this.getResolution(),leftTolerance:this.getResolution()};e=e.wrapDateLine(this.maxExtent,n)}return e},CLASS_NAME:"OpenLayers.Layer"}),OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:!1,initialize:function(e,t,n,r){OpenLayers.Layer.prototype.initialize.apply(this,[e,r]),this.url=t,this.params||(this.params=OpenLayers.Util.extend({},n))},destroy:function(){this.url=null,this.params=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(e){return e==null&&(e=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.prototype.clone.apply(this,[e]),e},setUrl:function(e){this.url=e},mergeNewParams:function(e){this.params=OpenLayers.Util.extend(this.params,e);var t=this.redraw();return this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"params"}),t},redraw:function(e){return e?this.mergeNewParams({_olSalt:Math.random()}):OpenLayers.Layer.prototype.redraw.apply(this,[])},selectUrl:function(e,t){var n=1;for(var r=0,i=e.length;r<i;r++)n*=e.charCodeAt(r)*this.URL_HASH_FACTOR,n-=Math.floor(n);return t[Math.floor(n*t.length)]},getFullRequestString:function(e,t){var n=t||this.url,r=OpenLayers.Util.extend({},this.params);r=OpenLayers.Util.extend(r,e);var i=OpenLayers.Util.getParameterString(r);OpenLayers.Util.isArray(n)&&(n=this.selectUrl(i,n));var s=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(n));for(var o in r)o.toUpperCase()in s&&delete r[o];return i=OpenLayers.Util.getParameterString(r),OpenLayers.Util.urlAppend(n,i)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"}),OpenLayers.Tile=OpenLayers.Class({events:null,eventListeners:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:!1,initialize:function(e,t,n,r,i,s){this.layer=e,this.position=t.clone(),this.setBounds(n),this.url=r,i&&(this.size=i.clone()),this.id=OpenLayers.Util.createUniqueID("Tile_"),OpenLayers.Util.extend(this,s),this.events=new OpenLayers.Events(this),this.eventListeners instanceof Object&&this.events.on(this.eventListeners)},unload:function(){this.isLoading&&(this.isLoading=!1,this.events.triggerEvent("unload"))},destroy:function(){this.layer=null,this.bounds=null,this.size=null,this.position=null,this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy(),this.eventListeners=null,this.events=null},draw:function(e){e||this.clear();var t=this.shouldDraw();return t&&!e&&(t=this.events.triggerEvent("beforedraw")!==!1),t},shouldDraw:function(){var e=!1,t=this.layer.maxExtent;if(t){var n=this.layer.map,r=n.baseLayer.wrapDateLine&&n.getMaxExtent();this.bounds.intersectsBounds(t,{inclusive:!1,worldBounds:r})&&(e=!0)}return e||this.layer.displayOutsideMaxExtent},setBounds:function(e){e=e.clone();if(this.layer.map.baseLayer.wrapDateLine){var t=this.layer.map.getMaxExtent(),n=this.layer.map.getResolution();e=e.wrapDateLine(t,{leftTolerance:n,rightTolerance:n})}this.bounds=e},moveTo:function(e,t,n){n==null&&(n=!0),this.setBounds(e),this.position=t.clone(),n&&this.draw()},clear:function(e){},CLASS_NAME:"OpenLayers.Tile"}),OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,imageReloadAttempts:null,layerAlphaHack:null,asyncRequestId:null,blankImageUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7",maxGetUrlLength:null,canvasContext:null,crossOriginKeyword:null,initialize:function(e,t,n,r,i,s){OpenLayers.Tile.prototype.initialize.apply(this,arguments),this.url=r,this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack();if(this.maxGetUrlLength!=null||this.layer.gutter||this.layerAlphaHack)this.frame=document.createElement("div"),this.frame.style.position="absolute",this.frame.style.overflow="hidden";this.maxGetUrlLength!=null&&OpenLayers.Util.extend(this,OpenLayers.Tile.Image.IFrame)},destroy:function(){this.imgDiv&&(this.clear(),this.imgDiv=null,this.frame=null),this.asyncRequestId=null,OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var e=OpenLayers.Tile.prototype.draw.apply(this,arguments);return e?(this.layer!=this.layer.map.baseLayer&&this.layer.reproject&&(this.bounds=this.getBoundsFromBaseLayer(this.position)),this.isLoading?this._loadEvent="reload":(this.isLoading=!0,this._loadEvent="loadstart"),this.positionTile(),this.renderTile()):this.unload(),e},renderTile:function(){this.layer.div.appendChild(this.getTile());if(this.layer.async){var e=this.asyncRequestId=(this.asyncRequestId||0)+1;this.layer.getURLasync(this.bounds,function(t){e==this.asyncRequestId&&(this.url=t,this.initImage())},this)}else this.url=this.layer.getURL(this.bounds),this.initImage()},positionTile:function(){var e=this.getTile().style,t=this.frame?this.size:this.layer.getImageSize(this.bounds);e.left=this.position.x+"%",e.top=this.position.y+"%",e.width=t.w+"%",e.height=t.h+"%"},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments);var e=this.imgDiv;if(e){OpenLayers.Event.stopObservingElement(e);var t=this.getTile();t.parentNode===this.layer.div&&this.layer.div.removeChild(t),this.setImgSrc(),this.layerAlphaHack===!0&&(e.style.filter=""),OpenLayers.Element.removeClass(e,"olImageLoadError")}this.canvasContext=null},getImage:function(){if(!this.imgDiv){this.imgDiv=document.createElement("img"),this.imgDiv.className="olTileImage",this.imgDiv.galleryImg="no";var e=this.imgDiv.style;if(this.frame){var t=0,n=0;this.layer.gutter&&(t=this.layer.gutter/this.layer.tileSize.w*100,n=this.layer.gutter/this.layer.tileSize.h*100),e.left=-t+"%",e.top=-n+"%"
,e.width=2*t+100+"%",e.height=2*n+100+"%"}e.visibility="hidden",e.opacity=0,this.layer.opacity<1&&(e.filter="alpha(opacity="+this.layer.opacity*100+")"),e.position="absolute",this.layerAlphaHack&&(e.paddingTop=e.height,e.height="0",e.width="100%"),this.frame&&this.frame.appendChild(this.imgDiv)}return this.imgDiv},initImage:function(){this.events.triggerEvent(this._loadEvent);var e=this.getImage();if(this.url&&e.getAttribute("src")==this.url)this.onImageLoad();else{var t=OpenLayers.Function.bind(function(){OpenLayers.Event.stopObservingElement(e),OpenLayers.Event.observe(e,"load",OpenLayers.Function.bind(this.onImageLoad,this)),OpenLayers.Event.observe(e,"error",OpenLayers.Function.bind(this.onImageError,this)),this.imageReloadAttempts=0,this.setImgSrc(this.url)},this);e.getAttribute("src")==this.blankImageUrl?t():(OpenLayers.Event.observe(e,"load",t),OpenLayers.Event.observe(e,"error",t),this.crossOriginKeyword&&e.removeAttribute("crossorigin"),e.src=this.blankImageUrl)}},setImgSrc:function(e){var t=this.imgDiv;t.style.visibility="hidden",t.style.opacity=0,e&&(this.crossOriginKeyword&&(e.substr(0,5)!=="data:"?t.setAttribute("crossorigin",this.crossOriginKeyword):t.removeAttribute("crossorigin")),t.src=e)},getTile:function(){return this.frame?this.frame:this.getImage()},createBackBuffer:function(){if(!this.imgDiv||this.isLoading)return;var e;return this.frame?(e=this.frame.cloneNode(!1),e.appendChild(this.imgDiv)):e=this.imgDiv,this.imgDiv=null,e},onImageLoad:function(){var e=this.imgDiv;OpenLayers.Event.stopObservingElement(e),e.style.visibility="inherit",e.style.opacity=this.layer.opacity,this.isLoading=!1,this.canvasContext=null,this.events.triggerEvent("loadend");if(parseFloat(navigator.appVersion.split("MSIE")[1])<7&&this.layer&&this.layer.div){var t=document.createElement("span");t.style.display="none";var n=this.layer.div;n.appendChild(t),window.setTimeout(function(){t.parentNode===n&&t.parentNode.removeChild(t)},0)}this.layerAlphaHack===!0&&(e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e.src+"', sizingMethod='scale')")},onImageError:function(){var e=this.imgDiv;e.src!=null&&(this.imageReloadAttempts++,this.imageReloadAttempts<=OpenLayers.IMAGE_RELOAD_ATTEMPTS?this.setImgSrc(this.layer.getURL(this.bounds)):(OpenLayers.Element.addClass(e,"olImageLoadError"),this.events.triggerEvent("loaderror"),this.onImageLoad()))},getCanvasContext:function(){if(OpenLayers.CANVAS_SUPPORTED&&this.imgDiv&&!this.isLoading){if(!this.canvasContext){var e=document.createElement("canvas");e.width=this.size.w,e.height=this.size.h,this.canvasContext=e.getContext("2d"),this.canvasContext.drawImage(this.imgDiv,0,0)}return this.canvasContext}},CLASS_NAME:"OpenLayers.Tile.Image"}),OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,tileOriginCorner:"bl",tileOrigin:null,tileOptions:null,tileClass:OpenLayers.Tile.Image,grid:null,singleTile:!1,ratio:1.5,buffer:0,transitionEffect:null,numLoadingTiles:0,tileLoadingDelay:85,serverResolutions:null,moveTimerId:null,deferMoveGriddedTiles:null,tileQueueId:null,tileQueue:null,loading:!1,backBuffer:null,gridResolution:null,backBufferResolution:null,backBufferLonLat:null,backBufferTimerId:null,removeBackBufferDelay:null,className:null,initialize:function(e,t,n,r){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments),this.grid=[],this.tileQueue=[],this.removeBackBufferDelay===null&&(this.removeBackBufferDelay=this.singleTile?0:2500),this.className===null&&(this.className=this.singleTile?"olLayerGridSingleTile":"olLayerGrid"),OpenLayers.Animation.isNative||(this.deferMoveGriddedTiles=OpenLayers.Function.bind(function(){this.moveGriddedTiles(!0),this.moveTimerId=null},this))},setMap:function(e){OpenLayers.Layer.HTTPRequest.prototype.setMap.call(this,e),OpenLayers.Element.addClass(this.div,this.className)},removeMap:function(e){this.moveTimerId!==null&&(window.clearTimeout(this.moveTimerId),this.moveTimerId=null),this.clearTileQueue(),this.backBufferTimerId!==null&&(window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null)},destroy:function(){this.removeBackBuffer(),this.clearGrid(),this.grid=null,this.tileSize=null,OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){this.clearTileQueue();if(this.grid){for(var e=0,t=this.grid.length;e<t;e++){var n=this.grid[e];for(var r=0,i=n.length;r<i;r++){var s=n[r];this.destroyTile(s)}}this.grid=[],this.gridResolution=null}},clone:function(e){return e==null&&(e=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[e]),this.tileSize!=null&&(e.tileSize=this.tileSize.clone()),e.grid=[],e.gridResolution=null,e.backBuffer=null,e.backBufferTimerId=null,e.tileQueue=[],e.tileQueueId=null,e.loading=!1,e.moveTimerId=null,e},moveTo:function(e,t,n){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments),e=e||this.map.getExtent();if(e!=null){var r=!this.grid.length||t,i=this.getTilesBounds(),s=this.map.getResolution(),o=this.getServerResolution(s);if(this.singleTile){if(r||!n&&!i.containsBounds(e))t&&this.transitionEffect!=="resize"&&this.removeBackBuffer(),(!t||this.transitionEffect==="resize")&&this.applyBackBuffer(o),this.initSingleTile(e)}else{r=r||!i.intersectsBounds(e,{worldBounds:this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent()});if(s!==o){e=this.map.calculateBounds(null,o);if(r){var u=o/s;this.transformDiv(u)}}else this.div.style.width="100%",this.div.style.height="100%",this.div.style.left="0%",this.div.style.top="0%";r?(t&&this.transitionEffect==="resize"&&this.applyBackBuffer(o),this.initGriddedTiles(e)):this.moveGriddedTiles()}}},getTileData:function(e){var t=null,n=e.lon,r=e.lat,i=this.grid.length;if(this.map&&i){var s=this.map.getResolution(),o=this.tileSize.w,u=this.tileSize.h,a=this.grid[0][0].bounds,f=a.left,l=a.top;if(n<f&&this.map.baseLayer.wrapDateLine){var c=this.map.getMaxExtent().getWidth(),h=Math.ceil((f-n)/c);n+=c*h}var p=(n-f)/(s*o),d=(l-r)/(s*u),v=Math.floor(p),m=Math.floor(d);if(m>=0&&m<i){var g=this.grid[m][v];g&&(t={tile:g,i:Math.floor((p-v)*o),j:Math.floor((d-m)*u)})}}return t},queueTileDraw:function(e){var t=e.object;return~OpenLayers.Util.indexOf(this.tileQueue,t)||this.tileQueue.push(t),this.tileQueueId||(this.tileQueueId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.drawTileFromQueue,this),null,this.div)),!1},drawTileFromQueue:function(){this.tileQueue.length===0?this.clearTileQueue():this.tileQueue.shift().draw(!0)},clearTileQueue:function(){OpenLayers.Animation.stop(this.tileQueueId),this.tileQueueId=null,this.tileQueue=[]},destroyTile:function(e){this.removeTileMonitoringHooks(e),e.destroy()},getServerResolution:function(e){e=e||this.map.getResolution();if(this.serverResolutions&&OpenLayers.Util.indexOf(this.serverResolutions,e)===-1){var t,n;for(t=this.serverResolutions.length-1;t>=0;t--){n=this.serverResolutions[t];if(n>e){e=n;break}}if(t===-1)throw"no appropriate resolution in serverResolutions"}return e},getServerZoom:function(){var e=this.getServerResolution();return this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,e):this.map.getZoomForResolution(e)+(this.zoomOffset||0)},transformDiv:function(e){this.div.style.width=100*e+"%",this.div.style.height=100*e+"%";var t=this.map.getSize(),n=parseInt(this.map.layerContainerDiv.style.left,10),r=parseInt(this.map.layerContainerDiv.style.top,10),i=(n-t.w/2)*(e-1),s=(r-t.h/2)*(e-1);this.div.style.left=i+"%",this.div.style.top=s+"%"},getResolutionScale:function(){return parseInt(this.div.style.width,10)/100},applyBackBuffer:function(e){this.backBufferTimerId!==null&&this.removeBackBuffer();var t=this.backBuffer;if(!t){t=this.createBackBuffer();if(!t)return;this.div.insertBefore(t,this.div.firstChild),this.backBuffer=t;var n=this.grid[0][0].bounds;this.backBufferLonLat={lon:n.left,lat:n.top},this.backBufferResolution=this.gridResolution}var r=t.style,i=this.backBufferResolution/e;r.width=100*i+"%",r.height=100*i+"%";var s=this.getViewPortPxFromLonLat(this.backBufferLonLat,e),o=parseInt(this.map.layerContainerDiv.style.left,10),u=parseInt(this.map.layerContainerDiv.style.top,10);t.style.left=Math.round(s.x-o)+"%",t.style.top=Math.round(s.y-u)+"%"},createBackBuffer:function(){var e;if(this.grid.length>0){e=document.createElement("div"),e.id=this.div.id+"_bb",e.className="olBackBuffer",e.style.position="absolute",e.style.width="100%",e.style.height="100%";for(var t=0,n=this.grid.length;t<n;t++)for(var r=0,i=this.grid[t].length;r<i;r++){var s=this.grid[t][r].createBackBuffer();if(!s)continue;s.style.top=t*this.tileSize.h+"%",s.style.left=r*this.tileSize.w+"%",e.appendChild(s)}}return e},removeBackBuffer:function(){this.backBuffer&&(this.div.removeChild(this.backBuffer),this.backBuffer=null,this.backBufferResolution=null,this.backBufferTimerId!==null&&(window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null))},moveByPx:function(e,t){this.singleTile||this.moveGriddedTiles()},setTileSize:function(e){this.singleTile&&(e=this.map.getSize(),e.h=parseInt(e.h*this.ratio),e.w=parseInt(e.w*this.ratio)),OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[e])},getTilesBounds:function(){var e=null,t=this.grid.length;if(t){var n=this.grid[t-1][0].bounds,r=this.grid[0].length*n.getWidth(),i=this.grid.length*n.getHeight();e=new OpenLayers.Bounds(n.left,n.bottom,n.left+r,n.bottom+i)}return e},initSingleTile:function(e){this.clearTileQueue();var t=e.getCenterLonLat(),n=e.getWidth()*this.ratio,r=e.getHeight()*this.ratio,i=new OpenLayers.Bounds(t.lon-n/2,t.lat-r/2,t.lon+n/2,t.lat+r/2),s=this.map.getLayerPxFromLonLat({lon:i.left,lat:i.top});this.grid.length||(this.grid[0]=[]);var o=this.grid[0][0];o?o.moveTo(i,s):(o=this.addTile(i,s),this.addTileMonitoringHooks(o),o.draw(),this.grid[0][0]=o),this.removeExcessTiles(1,1),this.gridResolution=this.getServerResolution()},calculateGridLayout:function(e,t,n){var r=n*this.tileSize.w,i=n*this.tileSize.h,s=e.left-t.lon,o=Math.floor(s/r)-this.buffer,u=s/r-o,a=-u*this.tileSize.w,f=t.lon+o*r,l=e.top-(t.lat+i),c=Math.ceil(l/i)+this.buffer,h=c-l/i,p=-h*this.tileSize.h,d=t.lat+c*i;return{tilelon:r,tilelat:i,tileoffsetlon:f,tileoffsetlat:d,tileoffsetx:a,tileoffsety:p}},getTileOrigin:function(){var e=this.tileOrigin;if(!e){var t=this.getMaxExtent(),n={tl:["left","top"],tr:["right","top"],bl:["left","bottom"],br:["right","bottom"]}[this.tileOriginCorner];e=new OpenLayers.LonLat(t[n[0]],t[n[1]])}return e},initGriddedTiles:function(e){this.clearTileQueue();var t=this.map.getSize(),n=Math.ceil(t.h/this.tileSize.h)+Math.max(1,2*this.buffer),r=Math.ceil(t.w/this.tileSize.w)+Math.max(1,2*this.buffer),i=this.getTileOrigin(),s=this.getServerResolution(),o=this.calculateGridLayout(e,i,s),u=Math.round(o.tileoffsetx),a=Math.round(o.tileoffsety),f=o.tileoffsetlon,l=o.tileoffsetlat,c=o.tilelon,h=o.tilelat,p=u,d=f,v=0,m=parseInt(this.map.layerContainerDiv.style.left),g=parseInt(this.map.layerContainerDiv.style.top),y=[],b=this.map.getCenter();do{var w=this.grid[v++];w||(w=[],this.grid.push(w)),f=d,u=p;var E=0;do{var S=new OpenLayers.Bounds(f,l,f+c,l+h),x=u;x-=m;var T=a;T-=g;var N=new OpenLayers.Pixel(x,T),C=w[E++];C?C.moveTo(S,N,!1):(C=this.addTile(S,N),this.addTileMonitoringHooks(C),w.push(C));var k=S.getCenterLonLat();y.push({tile:C,distance:Math.pow(k.lon-b.lon,2)+Math.pow(k.lat-b.lat,2)}),f+=c,u+=this.tileSize.w}while(f<=e.right+c*this.buffer||E<r);l-=h,a+=this.tileSize.h}while(l>=e.bottom-h*this.buffer||v<n);this.removeExcessTiles(v,E),this.gridResolution=this.getServerResolution(),y.sort(function(e,t){return e.distance-t.distance});for(var L=0,A=y.length;L<A;++L)y[L].tile.draw()},getMaxExtent:function(){return this.maxExtent},addTile:function(e,t){var n=new this.tileClass(this,t,e,null,this.tileSize,this.tileOptions);return n.events.register("beforedraw",this,this.queueTileDraw),n},addTileMonitoringHooks:function(e){e.onLoadStart=function(){this.loading===!1&&(this.loading=!0,this.events.triggerEvent("loadstart")),this.events.triggerEvent("tileloadstart",{tile:e}),this.numLoadingTiles++},e.onLoadEnd=function(){this.numLoadingTiles--,this.events.triggerEvent("tileloaded",{tile:e}),this.tileQueue.length===0&&this.numLoadingTiles===0&&(this.loading=!1,this.events.triggerEvent("loadend"),this.backBuffer&&(this.backBufferTimerId=window.setTimeout(OpenLayers.Function.bind(this.removeBackBuffer,this),this.removeBackBufferDelay)))},e.onLoadError=function(){this.events.triggerEvent("tileerror",{tile:e})},e.events.on({loadstart:e.onLoadStart,loadend:e.onLoadEnd,unload:e.onLoadEnd,loaderror:e.onLoadError,scope:this})},removeTileMonitoringHooks:function(e){e.unload(),e.events.un({loadstart:e.onLoadStart,loadend:e.onLoadEnd,unload:e.onLoadEnd,loaderror:e.onLoadError,scope:this})},moveGriddedTiles:function(e){if(!e&&!OpenLayers.Animation.isNative){this.moveTimerId!=null&&window.clearTimeout(this.moveTimerId),this.moveTimerId=window.setTimeout(this.deferMoveGriddedTiles,this.tileLoadingDelay);return}var t=this.buffer||1,n=this.getResolutionScale();for(;;){var r={x:this.grid[0][0].position.x*n+parseInt(this.div.style.left,10)+parseInt(this.map.layerContainerDiv.style.left),y:this.grid[0][0].position.y*n+parseInt(this.div.style.top,10)+parseInt(this.map.layerContainerDiv.style.top)},i={w:this.tileSize.w*n,h:this.tileSize.h*n};if(r.x>-i.w*(t-1))this.shiftColumn(!0);else if(r.x<-i.w*t)this.shiftColumn(!1);else if(r.y>-i.h*(t-1))this.shiftRow(!0);else{if(!(r.y<-i.h*t))break;this.shiftRow(!1)}}},shiftRow:function(e){var t=e?0:this.grid.length-1,n=this.grid,r=n[t],i=this.getServerResolution(),s=e?-this.tileSize.h:this.tileSize.h,o=i*-s,u=e?n.pop():n.shift();for(var a=0,f=r.length;a<f;a++){var l=r[a],c=l.bounds.clone(),h=l.position.clone();c.bottom=c.bottom+o,c.top=c.top+o,h.y=h.y+s,u[a].moveTo(c,h)}e?n.unshift(u):n.push(u)},shiftColumn:function(e){var t=e?-this.tileSize.w:this.tileSize.w,n=this.getServerResolution(),r=n*t;for(var i=0,s=this.grid.length;i<s;i++){var o=this.grid[i],u=e?0:o.length-1,a=o[u],f=a.bounds.clone(),l=a.position.clone();f.left=f.left+r,f.right=f.right+r,l.x=l.x+t;var c=e?this.grid[i].pop():this.grid[i].shift();c.moveTo(f,l),e?o.unshift(c):o.push(c)}},removeExcessTiles:function(e,t){var n,r;while(this.grid.length>e){var i=this.grid.pop();for(n=0,r=i.length;n<r;n++){var s=i[n];this.destroyTile(s)}}for(n=0,r=this.grid.length;n<r;n++)while(this.grid[n].length>t){var i=this.grid[n],s=i.pop();this.destroyTile(s)}},onMapResize:function(){this.singleTile&&(this.clearGrid(),this.setTileSize())},getTileBounds:function(e){var t=this.maxExtent,n=this.getResolution(),r=n*this.tileSize.w,i=n*this.tileSize.h,s=this.getLonLatFromViewPortPx(e),o=t.left+r*Math.floor((s.lon-t.left)/r),u=t.bottom+i*Math.floor((s.lat-t.bottom)/i);return new OpenLayers.Bounds(o,u,o+r,u+i)},CLASS_NAME:"OpenLayers.Layer.Grid"}),OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:!1,displayClass:"",title:"",autoActivate:!1,active:null,handler:null,eventListeners:null,events:null,initialize:function(e){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,""),OpenLayers.Util.extend(this,e),this.events=new OpenLayers.Events(this),this.eventListeners instanceof Object&&this.events.on(this.eventListeners),this.id==null&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"))},destroy:function(){this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy(),this.events=null),this.eventListeners=null,this.handler&&(this.handler.destroy(),this.handler=null);if(this.handlers){for(var e in this.handlers)this.handlers.hasOwnProperty(e)&&typeof this.handlers[e].destroy=="function"&&this.handlers[e].destroy();this.handlers=null}this.map&&(this.map.removeControl(this),this.map=null),this.div=null},setMap:function(e){this.map=e,this.handler&&this.handler.setMap(e)},draw:function(e){return this.div==null&&(this.div=OpenLayers.Util.createDiv(this.id),this.div.className=this.displayClass,this.allowSelection||(this.div.className+=" olControlNoSelect",this.div.setAttribute("unselectable","on",0),this.div.onselectstart=OpenLayers.Function.False),this.title!=""&&(this.div.title=this.title)),e!=null&&(this.position=e.clone()),this.moveTo(this.position),this.div},moveTo:function(e){e!=null&&this.div!=null&&(this.div.style.left=e.x+"px",this.div.style.top=e.y+"px")},activate:function(){return this.active?!1:(this.handler&&this.handler.activate(),this.active=!0,this.map&&OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("activate"),!0)},deactivate:function(){return this.active?(this.handler&&this.handler.deactivate(),this.active=!1,this.map&&OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("deactivate"),!0):!1},CLASS_NAME:"OpenLayers.Control"}),OpenLayers.Control.TYPE_BUTTON=1,OpenLayers.Control.TYPE_TOGGLE=2,OpenLayers.Control.TYPE_TOOL=3,OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:", ",template:"${layers}",destroy:function(){this.map.events.un({removelayer:this.updateAttribution,addlayer:this.updateAttribution,changelayer:this.updateAttribution,changebaselayer:this.updateAttribution,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.map.events.on({changebaselayer:this.updateAttribution,changelayer:this.updateAttribution,addlayer:this.updateAttribution,removelayer:this.updateAttribution,scope:this}),this.updateAttribution(),this.div},updateAttribution:function(){var e=[];if(this.map&&this.map.layers){for(var t=0,n=this.map.layers.length;t<n;t++){var r=this.map.layers[t];r.attribution&&r.getVisibility()&&OpenLayers.Util.indexOf(e,r.attribution)===-1&&e.push(r.attribution)}this.div.innerHTML=OpenLayers.String.format(this.template,{layers:e.join(this.separator)})}},CLASS_NAME:"OpenLayers.Control.Attribution"}),OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:!1,evt:null,initialize:function(e,t,n){OpenLayers.Util.extend(this,n),this.control=e,this.callbacks=t;var r=this.map||e.map;r&&this.setMap(r),this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(e){this.map=e},checkModifiers:function(e){if(this.keyMask==null)return!0;var t=(e.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(e.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(e.altKey?OpenLayers.Handler.MOD_ALT:0);return t==this.keyMask},activate:function(){if(this.active)return!1;var e=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var t=0,n=e.length;t<n;t++)this[e[t]]&&this.register(e[t],this[e[t]]);return this.active=!0,!0},deactivate:function(){if(!this.active)return!1;var e=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var t=0,n=e.length;t<n;t++)this[e[t]]&&this.unregister(e[t],this[e[t]]);return this.active=!1,!0},callback:function(e,t){e&&this.callbacks[e]&&this.callbacks[e].apply(this.control,t)},register:function(e,t){this.map.events.registerPriority(e,this,t),this.map.events.registerPriority(e,this,this.setEvent)},unregister:function(e,t){this.map.events.unregister(e,this,t),this.map.events.unregister(e,this,this.setEvent)},setEvent:function(e){return this.evt=e,!0},destroy:function(){this.deactivate(),this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"}),OpenLayers.Handler.MOD_NONE=0,OpenLayers.Handler.MOD_SHIFT=1,OpenLayers.Handler.MOD_CTRL=2,OpenLayers.Handler.MOD_ALT=4,OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:!0,"double":!1,pixelTolerance:0,dblclickTolerance:13,stopSingle:!1,stopDouble:!1,timerId:null,touch:!1,down:null,last:null,first:null,rightclickTimerId:null,touchstart:function(e){return this.touch||(this.unregisterMouseListeners(),this.touch=!0),this.down=this.getEventInfo(e),this.last=this.getEventInfo(e),!0},touchmove:function(e){return this.last=this.getEventInfo(e),!0},touchend:function(e){return this.down&&(e.xy=this.last.xy,e.lastTouches=this.last.touches,this.handleSingle(e),this.down=null),!0},unregisterMouseListeners:function(){this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,click:this.click,dblclick:this.dblclick,scope:this})},mousedown:function(e){return this.down=this.getEventInfo(e),this.last=this.getEventInfo(e),!0},mouseup:function(e){var t=!0;return this.checkModifiers(e)&&this.control.handleRightClicks&&OpenLayers.Event.isRightClick(e)&&(t=this.rightclick(e)),t},rightclick:function(e){if(this.passesTolerance(e)){if(this.rightclickTimerId!=null)return this.clearTimer(),this.callback("dblrightclick",[e]),!this.stopDouble;var t=this["double"]?OpenLayers.Util.extend({},e):this.callback("rightclick",[e]),n=OpenLayers.Function.bind(this.delayedRightCall,this,t);this.rightclickTimerId=window.setTimeout(n,this.delay)}return!this.stopSingle},delayedRightCall:function(e){this.rightclickTimerId=null,e&&this.callback("rightclick",[e])},click:function(e){return this.last||(this.last=this.getEventInfo(e)),this.handleSingle(e),!this.stopSingle},dblclick:function(e){return this.handleDouble(e),!this.stopDouble},handleDouble:function(e){this.passesDblclickTolerance(e)&&(this["double"]&&this.callback("dblclick",[e]),this.clearTimer())},handleSingle:function(e){if(this.passesTolerance(e))if(this.timerId!=null)this.last.touches&&this.last.touches.length===1&&(this["double"]&&OpenLayers.Event.stop(e),this.handleDouble(e)),(!this.last.touches||this.last.touches.length!==2)&&this.clearTimer();else{this.first=this.getEventInfo(e);var t=this.single?OpenLayers.Util.extend({},e):null;this.queuePotentialClick(t)}},queuePotentialClick:function(e){this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,e),this.delay)},passesTolerance:function(e){var t=!0;if(this.pixelTolerance!=null&&this.down&&this.down.xy){t=this.pixelTolerance>=this.down.xy.distanceTo(e.xy);if(t&&this.touch&&this.down.touches.length===this.last.touches.length)for(var n=0,r=this.down.touches.length;n<r;++n)if(this.getTouchDistance(this.down.touches[n],this.last.touches[n])>this.pixelTolerance){t=!1;break}}return t},getTouchDistance:function(e,t){return Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2))},passesDblclickTolerance:function(e){var t=!0;return this.down&&this.first&&(t=this.down.xy.distanceTo(this.first.xy)<=this.dblclickTolerance),t},clearTimer:function(){this.timerId!=null&&(window.clearTimeout(this.timerId),this.timerId=null),this.rightclickTimerId!=null&&(window.clearTimeout(this.rightclickTimerId),this.rightclickTimerId=null)},delayedCall:function(e){this.timerId=null,e&&this.callback("click",[e])},getEventInfo:function(e){var t;if(e.touches){var n=e.touches.length;t=new Array(n);var r;for(var i=0;i<n;i++)r=e.touches[i],t[i]={clientX:r.clientX,clientY:r.clientY}}return{xy:e.xy,touches:t}},deactivate:function(){var e=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),this.down=null,this.first=null,this.last=null,this.touch=!1,e=!0),e},CLASS_NAME:"OpenLayers.Handler.Click"}),OpenLayers.Kinetic=OpenLayers.Class({threshold:0,deceleration:.0035,nbPoints:100,delay:200,points:undefined,timerId:undefined,initialize:function(e){OpenLayers.Util.extend(this,e)},begin:function(){OpenLayers.Animation.stop(this.timerId),this.timerId=undefined,this.points=[]},update:function(e){this.points.unshift({xy:e,tick:(new Date).getTime()}),this.points.length>this.nbPoints&&this.points.pop()},end:function(e){var t,n=(new Date).getTime();for(var r=0,i=this.points.length,s;r<i;r++){s=this.points[r];if(n-s.tick>this.delay)break;t=s}if(!t)return;var o=(new Date).getTime()-t.tick,u=Math.sqrt(Math.pow(e.x-t.xy.x,2)+Math.pow(e.y-t.xy.y,2)),a=u/o;if(a==0||a<this.threshold)return;var f=Math.asin((e.y-t.xy.y)/u);return t.xy.x<=e.x&&(f=Math.PI-f),{speed:a,theta:f}},move:function(e,t){var n=e.speed,r=Math.cos(e.theta),i=-Math.sin(e.theta),s=(new Date).getTime(),o=0,u=0,a=function(){if(this.timerId==null)return;var e=(new Date).getTime()-s,a=-this.deceleration*Math.pow(e,2)/2+n*e,f=a*r,l=a*i,c={};c.end=!1;var h=-this.deceleration*e+n;h<=0&&(OpenLayers.Animation.stop(this.timerId),this.timerId=null,c.end=!0),c.x=f-o,c.y=l-u,o=f,u=l,t(c.x,c.y,c.end)};this.timerId=OpenLayers.Animation.start(OpenLayers.Function.bind(a,this))},CLASS_NAME:"OpenLayers.Kinetic"}),OpenLayers.Events.buttonclick=OpenLayers.Class({target:null,events:["mousedown","mouseup","click","dblclick","touchstart","touchmove","touchend","keydown"],startRegEx:/^mousedown|touchstart$/,cancelRegEx:/^touchmove$/,completeRegEx:/^mouseup|touchend$/,initialize:function(e){this.target=e;for(var t=this.events.length-1;t>=0;--t)this.target.register(this.events[t],this,this.buttonClick,{extension:!0})},destroy:function(){for(var e=this.events.length-1;e>=0;--e)this.target.unregister(this.events[e],this,this.buttonClick);delete this.target},getPressedButton:function(e){var t=3,n;do{if(OpenLayers.Element.hasClass(e,"olButton")){n=e;break}e=e.parentNode}while(--t>0&&e);return n},buttonClick:function(e){var t=!0,n=OpenLayers.Event.element(e);if(n&&(OpenLayers.Event.isLeftClick(e)||!~e.type.indexOf("mouse"))){var r=this.getPressedButton(n);if(r){if(e.type==="keydown")switch(e.keyCode){case OpenLayers.Event.KEY_RETURN:case OpenLayers.Event.KEY_SPACE:this.target.triggerEvent("buttonclick",{buttonElement:r}),OpenLayers.Event.stop(e),t=!1}else if(this.startEvt){if(this.completeRegEx.test(e.type)){var i=OpenLayers.Util.pagePosition(r);this.target.triggerEvent("buttonclick",{buttonElement:r,buttonXY:{x:this.startEvt.clientX-i[0],y:this.startEvt.clientY-i[1]}})}this.cancelRegEx.test(e.type)&&delete this.startEvt,OpenLayers.Event.stop(e),t=!1}this.startRegEx.test(e.type)&&(this.startEvt=e,OpenLayers.Event.stop(e),t=!1)}else delete this.startEvt}return t}}),OpenLayers.Popup=OpenLayers.Class({events:null,id:"",lonlat:null,div:null,contentSize:null,size:null,contentHTML:null,backgroundColor:"",opacity:"",border:"",contentDiv:null,groupDiv:null,closeDiv:null,autoSize:!1,minSize:null,maxSize:null,displayClass:"olPopup",contentDisplayClass:"olPopupContent",padding:0,disableFirefoxOverflowHack:!1,fixPadding:function(){typeof this.padding=="number"&&(this.padding=new OpenLayers.Bounds(this.padding,this.padding,this.padding,this.padding))},panMapIfOutOfView:!1,keepInMap:!1,closeOnMove:!1,map:null,initialize:function(e,t,n,r,i,s){e==null&&(e=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")),this.id=e,this.lonlat=t,this.contentSize=n!=null?n:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT),r!=null&&(this.contentHTML=r),this.backgroundColor=OpenLayers.Popup.COLOR,this.opacity=OpenLayers.Popup.OPACITY,this.border=OpenLayers.Popup.BORDER,this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,"hidden"),this.div.className=this.displayClass;var o=this.id+"_GroupDiv";this.groupDiv=OpenLayers.Util.createDiv(o,null,null,null,"relative",null,"hidden");var e=this.div.id+"_contentDiv";this.contentDiv=OpenLayers.Util.createDiv(e,null,this.contentSize.clone(),null,"relative"),this.contentDiv.className=this.contentDisplayClass,this.groupDiv.appendChild(this.contentDiv),this.div.appendChild(this.groupDiv),i&&this.addCloseBox(s),this.registerEvents()},destroy:function(){this.id=null,this.lonlat=null,this.size=null,this.contentHTML=null,this.backgroundColor=null,this.opacity=null,this.border=null,this.closeOnMove&&this.map&&this.map.events.unregister("movestart",this,this.hide),this.events.destroy(),this.events=null,this.closeDiv&&(OpenLayers.Event.stopObservingElement(this.closeDiv),this.groupDiv.removeChild(this.closeDiv)),this.closeDiv=null,this.div.removeChild(this.groupDiv),this.groupDiv=null,this.map!=null&&this.map.removePopup(this),this.map=null,this.div=null,this.autoSize=null,this.minSize=null,this.maxSize=null,this.padding=null,this.panMapIfOutOfView=null},draw:function(e){return e==null&&this.lonlat!=null&&this.map!=null&&(e=this.map.getLayerPxFromLonLat(this.lonlat)),this.closeOnMove&&this.map.events.register("movestart",this,this.hide),!this.disableFirefoxOverflowHack&&OpenLayers.BROWSER_NAME=="firefox"&&(this.map.events.register("movestart",this,function(){var e=document.defaultView.getComputedStyle(this.contentDiv,null),t=e.getPropertyValue("overflow");t!="hidden"&&(this.contentDiv._oldOverflow=t,this.contentDiv.style.overflow="hidden")}),this.map.events.register("moveend",this,function(){var e=this.contentDiv._oldOverflow;e&&(this.contentDiv.style.overflow=e,this.contentDiv._oldOverflow=null)})),this.moveTo(e),!this.autoSize&&!this.size&&this.setSize(this.contentSize),this.setBackgroundColor(),this.setOpacity(),this.setBorder(),this.setContentHTML(),this.panMapIfOutOfView&&this.panIntoView(),this.div},updatePosition:function(){if(this.lonlat&&this.map){var e=this.map.getLayerPxFromLonLat(this.lonlat);e&&this.moveTo(e)}},moveTo:function(e){e!=null&&this.div!=null&&(this.div.style.left=e.x+"px",this.div.style.top=e.y+"px")},visible:function(){return OpenLayers.Element.visible(this.div)},toggle:function(){this.visible()?this.hide():this.show()},show:function(){this.div.style.display="",this.panMapIfOutOfView&&this.panIntoView()},hide:function(){this.div.style.display="none"},setSize:function(e){this.size=e.clone();var t=this.getContentDivPadding(),n=t.left+t.right,r=t.top+t.bottom;this.fixPadding(),n+=this.padding.left+this.padding.right,r+=this.padding.top+this.padding.bottom;if(this.closeDiv){var i=parseInt(this.closeDiv.style.width);n+=i+t.right}this.size.w+=n,this.size.h+=r,OpenLayers.BROWSER_NAME=="msie"&&(this.contentSize.w+=t.left+t.right,this.contentSize.h+=t.bottom+t.top),this.div!=null&&(this.div.style.width=this.size.w+"px",this.div.style.height=this.size.h+"px"),this.contentDiv!=null&&(this.contentDiv.style.width=e.w+"px",this.contentDiv.style.height=e.h+"px")},updateSize:function(){var e="<div class='"+this.contentDisplayClass+"'>"+this.contentDiv.innerHTML+"</div>",t=this.map?this.map.div:document.body,n=OpenLayers.Util.getRenderedDimensions(e,null,{displayClass:this.displayClass,containerElement:t}),r=this.getSafeContentSize(n),i=null;if(r.equals(n))i=n;else{var s={w:r.w<n.w?r.w:null,h:r.h<n.h?r.h:null};if(s.w&&s.h)i=r;else{var o=OpenLayers.Util.getRenderedDimensions(e,s,{displayClass:this.contentDisplayClass,containerElement:t}),u=OpenLayers.Element.getStyle(this.contentDiv,"overflow");if(u!="hidden"&&o.equals(r)){var a=OpenLayers.Util.getScrollbarWidth();s.w?o.h+=a:o.w+=a}i=this.getSafeContentSize(o)}}this.setSize(i)},setBackgroundColor:function(e){e!=undefined&&(this.backgroundColor=e),this.div!=null&&(this.div.style.backgroundColor=this.backgroundColor)},setOpacity:function(e){e!=undefined&&(this.opacity=e),this.div!=null&&(this.div.style.opacity=this.opacity,this.div.style.filter="alpha(opacity="+this.opacity*100+")")},setBorder:function(e){e!=undefined&&(this.border=e),this.div!=null&&(this.div.style.border=this.border)},setContentHTML:function(e){e!=null&&(this.contentHTML=e),this.contentDiv!=null&&this.contentHTML!=null&&this.contentHTML!=this.contentDiv.innerHTML&&(this.contentDiv.innerHTML=this.contentHTML,this.autoSize&&(this.registerImageListeners(),this.updateSize()))},registerImageListeners:function(){var e=function(){if(this.popup.id===null)return;this.popup.updateSize(),this.popup.visible()&&this.popup.panMapIfOutOfView&&this.popup.panIntoView(),OpenLayers.Event.stopObserving(this.img,"load",this.img._onImageLoad)},t=this.contentDiv.getElementsByTagName("img");for(var n=0,r=t.length;n<r;n++){var i=t[n];if(i.width==0||i.height==0){var s={popup:this,img:i};i._onImgLoad=OpenLayers.Function.bind(e,s),OpenLayers.Event.observe(i,"load",i._onImgLoad)}}},getSafeContentSize:function(e){var t=e.clone(),n=this.getContentDivPadding(),r=n.left+n.right,i=n.top+n.bottom;this.fixPadding(),r+=this.padding.left+this.padding.right,i+=this.padding.top+this.padding.bottom;if(this.closeDiv){var s=parseInt(this.closeDiv.style.width);r+=s+n.right}this.minSize&&(t.w=Math.max(t.w,this.minSize.w-r),t.h=Math.max(t.h,this.minSize.h-i)),this.maxSize&&(t.w=Math.min(t.w,this.maxSize.w-r),t.h=Math.min(t.h,this.maxSize.h-i));if(this.map&&this.map.size){var o=0,u=0;if(this.keepInMap&&!this.panMapIfOutOfView){var a=this.map.getPixelFromLonLat(this.lonlat);switch(this.relativePosition){case"tr":o=a.x,u=this.map.size.h-a.y;break;case"tl":o=this.map.size.w-a.x,u=this.map.size.h-a.y;break;case"bl":o=this.map.size.w-a.x,u=a.y;break;case"br":o=a.x,u=a.y;break;default:o=a.x,u=this.map.size.h-a.y}}var f=this.map.size.h-this.map.paddingForPopups.top-this.map.paddingForPopups.bottom-i-u,l=this.map.size.w-this.map.paddingForPopups.left-this.map.paddingForPopups.right-r-o;t.w=Math.min(t.w
,l),t.h=Math.min(t.h,f)}return t},getContentDivPadding:function(){var e=this._contentDivPadding;return e||(this.div.parentNode==null&&(this.div.style.display="none",document.body.appendChild(this.div)),e=new OpenLayers.Bounds(OpenLayers.Element.getStyle(this.contentDiv,"padding-left"),OpenLayers.Element.getStyle(this.contentDiv,"padding-bottom"),OpenLayers.Element.getStyle(this.contentDiv,"padding-right"),OpenLayers.Element.getStyle(this.contentDiv,"padding-top")),this._contentDivPadding=e,this.div.parentNode==document.body&&(document.body.removeChild(this.div),this.div.style.display="")),e},addCloseBox:function(e){this.closeDiv=OpenLayers.Util.createDiv(this.id+"_close",null,{w:17,h:17}),this.closeDiv.className="olPopupCloseBox";var t=this.getContentDivPadding();this.closeDiv.style.right=t.right+"px",this.closeDiv.style.top=t.top+"px",this.groupDiv.appendChild(this.closeDiv);var n=e||function(e){this.hide(),OpenLayers.Event.stop(e)};OpenLayers.Event.observe(this.closeDiv,"touchend",OpenLayers.Function.bindAsEventListener(n,this)),OpenLayers.Event.observe(this.closeDiv,"click",OpenLayers.Function.bindAsEventListener(n,this))},panIntoView:function(){var e=this.map.getSize(),t=this.map.getViewPortPxFromLayerPx(new OpenLayers.Pixel(parseInt(this.div.style.left),parseInt(this.div.style.top))),n=t.clone();t.x<this.map.paddingForPopups.left?n.x=this.map.paddingForPopups.left:t.x+this.size.w>e.w-this.map.paddingForPopups.right&&(n.x=e.w-this.map.paddingForPopups.right-this.size.w),t.y<this.map.paddingForPopups.top?n.y=this.map.paddingForPopups.top:t.y+this.size.h>e.h-this.map.paddingForPopups.bottom&&(n.y=e.h-this.map.paddingForPopups.bottom-this.size.h);var r=t.x-n.x,i=t.y-n.y;this.map.pan(r,i)},registerEvents:function(){function e(e){OpenLayers.Event.stop(e,!0)}this.events=new OpenLayers.Events(this,this.div,null,!0),this.events.on({mousedown:this.onmousedown,mousemove:this.onmousemove,mouseup:this.onmouseup,click:this.onclick,mouseout:this.onmouseout,dblclick:this.ondblclick,touchstart:e,scope:this})},onmousedown:function(e){this.mousedown=!0,OpenLayers.Event.stop(e,!0)},onmousemove:function(e){this.mousedown&&OpenLayers.Event.stop(e,!0)},onmouseup:function(e){this.mousedown&&(this.mousedown=!1,OpenLayers.Event.stop(e,!0))},onclick:function(e){OpenLayers.Event.stop(e,!0)},onmouseout:function(e){this.mousedown=!1},ondblclick:function(e){OpenLayers.Event.stop(e,!0)},CLASS_NAME:"OpenLayers.Popup"}),OpenLayers.Popup.WIDTH=200,OpenLayers.Popup.HEIGHT=200,OpenLayers.Popup.COLOR="white",OpenLayers.Popup.OPACITY=1,OpenLayers.Popup.BORDER="0px",OpenLayers.Popup.Anchored=OpenLayers.Class(OpenLayers.Popup,{relativePosition:null,keepInMap:!0,anchor:null,initialize:function(e,t,n,r,i,s,o){var u=[e,t,n,r,s,o];OpenLayers.Popup.prototype.initialize.apply(this,u),this.anchor=i!=null?i:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)}},destroy:function(){this.anchor=null,this.relativePosition=null,OpenLayers.Popup.prototype.destroy.apply(this,arguments)},show:function(){this.updatePosition(),OpenLayers.Popup.prototype.show.apply(this,arguments)},moveTo:function(e){var t=this.relativePosition;this.relativePosition=this.calculateRelativePosition(e);var n=this.calculateNewPx(e),r=new Array(n);OpenLayers.Popup.prototype.moveTo.apply(this,r),this.relativePosition!=t&&this.updateRelativePosition()},setSize:function(e){OpenLayers.Popup.prototype.setSize.apply(this,arguments);if(this.lonlat&&this.map){var t=this.map.getLayerPxFromLonLat(this.lonlat);this.moveTo(t)}},calculateRelativePosition:function(e){var t=this.map.getLonLatFromLayerPx(e),n=this.map.getExtent(),r=n.determineQuadrant(t);return OpenLayers.Bounds.oppositeQuadrant(r)},updateRelativePosition:function(){},calculateNewPx:function(e){var t=e.offset(this.anchor.offset),n=this.size||this.contentSize,r=this.relativePosition.charAt(0)=="t";t.y+=r?-n.h:this.anchor.size.h;var i=this.relativePosition.charAt(1)=="l";return t.x+=i?-n.w:this.anchor.size.w,t},CLASS_NAME:"OpenLayers.Popup.Anchored"}),OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!0,dragging:!1,touch:!1,last:null,start:null,lastMoveEvt:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:!1,documentEvents:null,initialize:function(e,t,n){OpenLayers.Handler.prototype.initialize.apply(this,arguments);if(this.documentDrag===!0){var r=this;this._docMove=function(e){r.mousemove({xy:{x:e.clientX,y:e.clientY},element:document})},this._docUp=function(e){r.mouseup({xy:{x:e.clientX,y:e.clientY}})}}},dragstart:function(e){var t=!0;return this.dragging=!1,this.checkModifiers(e)&&(OpenLayers.Event.isLeftClick(e)||OpenLayers.Event.isSingleTouch(e))?(this.started=!0,this.start=e.xy,this.last=e.xy,OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown"),this.down(e),this.callback("down",[e.xy]),OpenLayers.Event.stop(e),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart?document.onselectstart:OpenLayers.Function.True),document.onselectstart=OpenLayers.Function.False,t=!this.stopDown):(this.started=!1,this.start=null,this.last=null),t},dragmove:function(e){return this.lastMoveEvt=e,this.started&&!this.timeoutId&&(e.xy.x!=this.last.x||e.xy.y!=this.last.y)&&(this.documentDrag===!0&&this.documentEvents&&(e.element===document?(this.adjustXY(e),this.setEvent(e)):this.removeDocumentEvents()),this.interval>0&&(this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)),this.dragging=!0,this.move(e),this.callback("move",[e.xy]),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart,document.onselectstart=OpenLayers.Function.False),this.last=e.xy),!0},dragend:function(e){if(this.started){this.documentDrag===!0&&this.documentEvents&&(this.adjustXY(e),this.removeDocumentEvents());var t=this.start!=this.last;this.started=!1,this.dragging=!1,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"),this.up(e),this.callback("up",[e.xy]),t&&this.callback("done",[e.xy]),document.onselectstart=this.oldOnselectstart}return!0},down:function(e){},move:function(e){},up:function(e){},out:function(e){},mousedown:function(e){return this.dragstart(e)},touchstart:function(e){return this.touch||(this.touch=!0,this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,scope:this})),this.dragstart(e)},mousemove:function(e){return this.dragmove(e)},touchmove:function(e){return this.dragmove(e)},removeTimeout:function(){this.timeoutId=null,this.dragging&&this.mousemove(this.lastMoveEvt)},mouseup:function(e){return this.dragend(e)},touchend:function(e){return e.xy=this.last,this.dragend(e)},mouseout:function(e){if(this.started&&OpenLayers.Util.mouseLeft(e,this.map.viewPortDiv))if(this.documentDrag===!0)this.addDocumentEvents();else{var t=this.start!=this.last;this.started=!1,this.dragging=!1,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"),this.out(e),this.callback("out",[]),t&&this.callback("done",[e.xy]),document.onselectstart&&(document.onselectstart=this.oldOnselectstart)}return!0},click:function(e){return this.start==this.last},activate:function(){var e=!1;return OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.dragging=!1,e=!0),e},deactivate:function(){var e=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.touch=!1,this.started=!1,this.dragging=!1,this.start=null,this.last=null,e=!0,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown")),e},adjustXY:function(e){var t=OpenLayers.Util.pagePosition(this.map.viewPortDiv);e.xy.x-=t[0],e.xy.y-=t[1]},addDocumentEvents:function(){OpenLayers.Element.addClass(document.body,"olDragDown"),this.documentEvents=!0,OpenLayers.Event.observe(document,"mousemove",this._docMove),OpenLayers.Event.observe(document,"mouseup",this._docUp)},removeDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown"),this.documentEvents=!1,OpenLayers.Event.stopObserving(document,"mousemove",this._docMove),OpenLayers.Event.stopObserving(document,"mouseup",this._docUp)},CLASS_NAME:"OpenLayers.Handler.Drag"}),OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxOffsets:null,initialize:function(e,t,n){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.dragHandler=new OpenLayers.Handler.Drag(this,{down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox},{keyMask:this.keyMask})},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments),this.dragHandler&&(this.dragHandler.destroy(),this.dragHandler=null)},setMap:function(e){OpenLayers.Handler.prototype.setMap.apply(this,arguments),this.dragHandler&&this.dragHandler.setMap(e)},startBox:function(e){this.callback("start",[]),this.zoomBox=OpenLayers.Util.createDiv("zoomBox",{x:-9999,y:-9999}),this.zoomBox.className=this.boxDivClassName,this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.viewPortDiv.appendChild(this.zoomBox),OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(e){var t=this.dragHandler.start.x,n=this.dragHandler.start.y,r=Math.abs(t-e.x),i=Math.abs(n-e.y),s=this.getBoxOffsets();this.zoomBox.style.width=r+s.width+1+"px",this.zoomBox.style.height=i+s.height+1+"px",this.zoomBox.style.left=(e.x<t?t-r-s.left:t-s.left)+"px",this.zoomBox.style.top=(e.y<n?n-i-s.top:n-s.top)+"px"},endBox:function(e){var t;if(Math.abs(this.dragHandler.start.x-e.x)>5||Math.abs(this.dragHandler.start.y-e.y)>5){var n=this.dragHandler.start,r=Math.min(n.y,e.y),i=Math.max(n.y,e.y),s=Math.min(n.x,e.x),o=Math.max(n.x,e.x);t=new OpenLayers.Bounds(s,i,o,r)}else t=this.dragHandler.start.clone();this.removeBox(),this.callback("done",[t])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox),this.zoomBox=null,this.boxOffsets=null,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){return OpenLayers.Handler.prototype.activate.apply(this,arguments)?(this.dragHandler.activate(),!0):!1},deactivate:function(){return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)?(this.dragHandler.deactivate()&&this.zoomBox&&this.removeBox(),!0):!1},getBoxOffsets:function(){if(!this.boxOffsets){var e=document.createElement("div");e.style.position="absolute",e.style.border="1px solid black",e.style.width="3px",document.body.appendChild(e);var t=e.clientWidth==3;document.body.removeChild(e);var n=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width")),r=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width")),i=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-top-width")),s=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"));this.boxOffsets={left:n,right:r,top:i,bottom:s,width:t===!1?n+r:0,height:t===!1?i+s:0}}return this.boxOffsets},CLASS_NAME:"OpenLayers.Handler.Box"}),OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:!1,keyMask:null,alwaysZoom:!1,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(e){if(e instanceof OpenLayers.Bounds){var t;if(!this.out){var n=this.map.getLonLatFromPixel({x:e.left,y:e.bottom}),r=this.map.getLonLatFromPixel({x:e.right,y:e.top});t=new OpenLayers.Bounds(n.lon,n.lat,r.lon,r.lat)}else{var i=Math.abs(e.right-e.left),s=Math.abs(e.top-e.bottom),o=Math.min(this.map.size.h/s,this.map.size.w/i),u=this.map.getExtent(),a=this.map.getLonLatFromPixel(e.getCenterPixel()),f=a.lon-u.getWidth()/2*o,l=a.lon+u.getWidth()/2*o,c=a.lat-u.getHeight()/2*o,h=a.lat+u.getHeight()/2*o;t=new OpenLayers.Bounds(f,c,l,h)}var p=this.map.getZoom();this.map.zoomToExtent(t),p==this.map.getZoom()&&this.alwaysZoom==1&&this.map.zoomTo(p+(this.out?-1:1))}else this.out?this.map.setCenter(this.map.getLonLatFromPixel(e),this.map.getZoom()-1):this.map.setCenter(this.map.getLonLatFromPixel(e),this.map.getZoom()+1)},CLASS_NAME:"OpenLayers.Control.ZoomBox"}),OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:!1,interval:1,documentDrag:!1,kinetic:null,enableKinetic:!1,kineticInterval:10,draw:function(){if(this.enableKinetic){var e={interval:this.kineticInterval};typeof this.enableKinetic=="object"&&(e=OpenLayers.Util.extend(e,this.enableKinetic)),this.kinetic=new OpenLayers.Kinetic(e)}this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone,down:this.panMapStart},{interval:this.interval,documentDrag:this.documentDrag})},panMapStart:function(){this.kinetic&&this.kinetic.begin()},panMap:function(e){this.kinetic&&this.kinetic.update(e),this.panned=!0,this.map.pan(this.handler.last.x-e.x,this.handler.last.y-e.y,{dragging:!0,animate:!1})},panMapDone:function(e){if(this.panned){var t=null;this.kinetic&&(t=this.kinetic.end(e)),this.map.pan(this.handler.last.x-e.x,this.handler.last.y-e.y,{dragging:!!t,animate:!1});if(t){var n=this;this.kinetic.move(t,function(e,t,r){n.map.pan(e,t,{dragging:!r,animate:!1})})}this.panned=!1}},CLASS_NAME:"OpenLayers.Control.DragPan"}),OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,mousePosition:null,interval:0,delta:0,cumulative:!0,initialize:function(e,t,n){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments),this.wheelListener=null},onWheelEvent:function(e){if(!this.map||!this.checkModifiers(e))return;var t=!1,n=!1,r=!1,i=OpenLayers.Event.element(e);while(i!=null&&!r&&!t){if(!t)try{if(i.currentStyle)o=i.currentStyle.overflow;else var s=document.defaultView.getComputedStyle(i,null),o=s.getPropertyValue("overflow");t=o&&o=="auto"||o=="scroll"}catch(u){}if(!n)for(var a=0,f=this.map.layers.length;a<f;a++)if(i==this.map.layers[a].div||i==this.map.layers[a].pane){n=!0;break}r=i==this.map.div,i=i.parentNode}if(!t&&r){if(n){var l=0;e||(e=window.event),e.wheelDelta?(l=e.wheelDelta/120,window.opera&&window.opera.version()<9.2&&(l=-l)):e.detail&&(l=-e.detail/3),this.delta=this.delta+l,this.interval?(window.clearTimeout(this._timeoutId),this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(e)},this),this.interval)):this.wheelZoom(e)}OpenLayers.Event.stop(e)}},wheelZoom:function(e){var t=this.delta;this.delta=0,t&&(this.mousePosition&&(e.xy=this.mousePosition),e.xy||(e.xy=this.map.getPixelFromLonLat(this.map.getCenter())),t<0?this.callback("down",[e,this.cumulative?t:-1]):this.callback("up",[e,this.cumulative?t:1]))},mousemove:function(e){this.mousePosition=e.xy},activate:function(e){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var t=this.wheelListener;return OpenLayers.Event.observe(window,"DOMMouseScroll",t),OpenLayers.Event.observe(window,"mousewheel",t),OpenLayers.Event.observe(document,"mousewheel",t),!0}return!1},deactivate:function(e){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var t=this.wheelListener;return OpenLayers.Event.stopObserving(window,"DOMMouseScroll",t),OpenLayers.Event.stopObserving(window,"mousewheel",t),OpenLayers.Event.stopObserving(document,"mousewheel",t),!0}return!1},CLASS_NAME:"OpenLayers.Handler.MouseWheel"}),OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,documentDrag:!1,zoomBox:null,zoomBoxEnabled:!0,zoomWheelEnabled:!0,mouseWheelOptions:null,handleRightClicks:!1,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:!0,initialize:function(e){this.handlers={},OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate(),this.dragPan&&this.dragPan.destroy(),this.dragPan=null,this.zoomBox&&this.zoomBox.destroy(),this.zoomBox=null,this.pinchZoom&&this.pinchZoom.destroy(),this.pinchZoom=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return this.dragPan.activate(),this.zoomWheelEnabled&&this.handlers.wheel.activate(),this.handlers.click.activate(),this.zoomBoxEnabled&&this.zoomBox.activate(),this.pinchZoom&&this.pinchZoom.activate(),OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return this.pinchZoom&&this.pinchZoom.deactivate(),this.zoomBox.deactivate(),this.dragPan.deactivate(),this.handlers.click.deactivate(),this.handlers.wheel.deactivate(),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){this.handleRightClicks&&(this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False);var e={click:this.defaultClick,dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick},t={"double":!0,stopDouble:!0};this.handlers.click=new OpenLayers.Handler.Click(this,e,t),this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions)),this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask}),this.dragPan.draw(),this.zoomBox.draw(),this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},this.mouseWheelOptions),OpenLayers.Control.PinchZoom&&(this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions)))},defaultClick:function(e){e.lastTouches&&e.lastTouches.length==2&&this.map.zoomOut()},defaultDblClick:function(e){var t=this.map.getLonLatFromViewPortPx(e.xy);this.map.setCenter(t,this.map.zoom+1)},defaultDblRightClick:function(e){var t=this.map.getLonLatFromViewPortPx(e.xy);this.map.setCenter(t,this.map.zoom-1)},wheelChange:function(e,t){var n=this.map.getZoom(),r=this.map.getZoom()+Math.round(t);r=Math.max(r,0),r=Math.min(r,this.map.getNumZoomLevels());if(r===n)return;var i=this.map.getSize(),s=i.w/2-e.xy.x,o=e.xy.y-i.h/2,u=this.map.baseLayer.getResolutionForZoom(r),a=this.map.getLonLatFromPixel(e.xy),f=new OpenLayers.LonLat(a.lon+s*u,a.lat+o*u);this.map.setCenter(f,r)},wheelUp:function(e,t){this.wheelChange(e,t||1)},wheelDown:function(e,t){this.wheelChange(e,t||-1)},disableZoomBox:function(){this.zoomBoxEnabled=!1,this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=!0,this.active&&this.zoomBox.activate()},disableZoomWheel:function(){this.zoomWheelEnabled=!1,this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=!0,this.active&&this.handlers.wheel.activate()},CLASS_NAME:"OpenLayers.Control.Navigation"}),OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"},isBaseLayer:!0,encodeBBOX:!1,noMagic:!1,yx:{},initialize:function(e,t,n,r){var i=[];n=OpenLayers.Util.upperCaseObject(n),parseFloat(n.VERSION)>=1.3&&!n.EXCEPTIONS&&(n.EXCEPTIONS="INIMAGE"),i.push(e,t,n,r),OpenLayers.Layer.Grid.prototype.initialize.apply(this,i),OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(!this.noMagic&&this.params.TRANSPARENT&&this.params.TRANSPARENT.toString().toLowerCase()=="true"){if(r==null||!r.isBaseLayer)this.isBaseLayer=!1;this.params.FORMAT=="image/jpeg"&&(this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png")}},clone:function(e){return e==null&&(e=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e]),e},reverseAxisOrder:function(){var e=this.projection.getCode();return parseFloat(this.params.VERSION)>=1.3&&(!!this.yx[e]||!!OpenLayers.Projection.defaults[e].yx)},getURL:function(e){e=this.adjustBounds(e);var t=this.getImageSize(),n={},r=this.reverseAxisOrder();n.BBOX=this.encodeBBOX?e.toBBOX(null,r):e.toArray(r),n.WIDTH=t.w,n.HEIGHT=t.h;var i=this.getFullRequestString(n);return i},mergeNewParams:function(e){var t=OpenLayers.Util.upperCaseObject(e),n=[t];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,n)},getFullRequestString:function(e,t){var n=this.map.getProjectionObject(),r=this.projection&&this.projection.equals(n)?this.projection.getCode():n.getCode(),i=r=="none"?null:r;return parseFloat(this.params.VERSION)>=1.3?this.params.CRS=i:this.params.SRS=i,typeof this.params.TRANSPARENT=="boolean"&&(e.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE"),OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"}),OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:!0,initialize:function(e,t){this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),select:new OpenLayers.Style(OpenLayers.Feature.Vector.style.select),temporary:new OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])};if(e instanceof OpenLayers.Style)this.styles["default"]=e,this.styles.select=e,this.styles.temporary=e,this.styles["delete"]=e;else if(typeof e=="object")for(var n in e)if(e[n]instanceof OpenLayers.Style)this.styles[n]=e[n];else{if(typeof e[n]!="object"){this.styles["default"]=new OpenLayers.Style(e),this.styles.select=new OpenLayers.Style(e),this.styles.temporary=new OpenLayers.Style(e),this.styles["delete"]=new OpenLayers.Style(e);break}this.styles[n]=new OpenLayers.Style(e[n])}OpenLayers.Util.extend(this,t)},destroy:function(){for(var e in this.styles)this.styles[e].destroy();this.styles=null},createSymbolizer:function(e,t){e||(e=new OpenLayers.Feature.Vector),this.styles[t]||(t="default"),e.renderIntent=t;var n={};return this.extendDefault&&t!="default"&&(n=this.styles["default"].createSymbolizer(e)),OpenLayers.Util.extend(n,this.styles[t].createSymbolizer(e))},addUniqueValueRules:function(e,t,n,r){var i=[];for(var s in n)i.push(new OpenLayers.Rule({symbolizer:n[s],context:r,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:t,value:s})}));this.styles[e].addRules(i)},CLASS_NAME:"OpenLayers.StyleMap"}),OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,isFixed:!1,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:!0,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:!1,ratio:1,initialize:function(e,t){OpenLayers.Layer.prototype.initialize.apply(this,arguments),(!this.renderer||!this.renderer.supported())&&this.assignRenderer();if(!this.renderer||!this.renderer.supported())this.renderer=null,this.displayError();this.styleMap||(this.styleMap=new OpenLayers.StyleMap),this.features=[],this.selectedFeatures=[],this.unrenderedFeatures={};if(this.strategies)for(var n=0,r=this.strategies.length;n<r;n++)this.strategies[n].setLayer(this)},destroy:function(){if(this.strategies){var e,t,n;for(t=0,n=this.strategies.length;t<n;t++)e=this.strategies[t],e.autoDestroy&&e.destroy();this.strategies=null}this.protocol&&(this.protocol.autoDestroy&&this.protocol.destroy(),this.protocol=null),this.destroyFeatures(),this.features=null,this.selectedFeatures=null,this.unrenderedFeatures=null,this.renderer&&this.renderer.destroy(),this.renderer=null,this.geometryType=null,this.drawn=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(e){e==null&&(e=new OpenLayers.Layer.Vector(this.name,this.getOptions())),e=OpenLayers.Layer.prototype.clone.apply(this,[e]);var t=this.features,n=t.length,r=new Array(n);for(var i=0;i<n;++i)r[i]=t[i].clone();return e.features=r,e},refresh:function(e){this.calculateInRange()&&this.visibility&&this.events.triggerEvent("refresh",e)},assignRenderer:function(){for(var e=0,t=this.renderers.length;e<t;e++){var n=this.renderers[e],r=typeof n=="function"?n:OpenLayers.Renderer[n];if(r&&r.prototype.supported()){this.renderer=new r(this.div,this.rendererOptions);break}}},displayError:function(){this.reportError&&OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))},setMap:function(e){OpenLayers.Layer.prototype.setMap.apply(this,arguments);if(!this.renderer)this.map.removeLayer(this);else{this.renderer.map=this.map;var t=this.map.getSize();t.w=t.w*this.ratio,t.h=t.h*this.ratio,this.renderer.setSize(t)}},afterAdd:function(){if(this.strategies){var e,t,n;for(t=0,n=this.strategies.length;t<n;t++)e=this.strategies[t],e.autoActivate&&e.activate()}},removeMap:function(e){this.drawn=!1;if(this.strategies){var t,n,r;for(n=0,r=this.strategies.length;n<r;n++)t=this.strategies[n],t.autoActivate&&t.deactivate()}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,arguments);var e=this.map.getSize();e.w=e.w*this.ratio,e.h=e.h*this.ratio,this.renderer.setSize(e)},moveTo:function(e,t,n){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var r=!0;if(!n){this.renderer.root.style.visibility="hidden";var i=this.map.getSize(),s=i.w,o=i.h,u=s/2*this.ratio-s/2,a=o/2*this.ratio-o/2;u+=parseInt(this.map.layerContainerDiv.style.left,10),u=-Math.round(u),a+=parseInt(this.map.layerContainerDiv.style.top,10),a=-Math.round(a),this.div.style.left=u+"px",this.div.style.top=a+"px";var f=this.map.getExtent().scale(this.ratio);r=this.renderer.setExtent(f,t),this.renderer.root.style.visibility="visible",OpenLayers.IS_GECKO===!0&&(this.div.scrollLeft=this.div.scrollLeft);if(!t&&r)for(var l in this.unrenderedFeatures){var c=this.unrenderedFeatures[l];this.drawFeature(c)}}if(!this.drawn||t||!r){this.drawn=!0;var c;for(var l=0,h=this.features.length;l<h;l++)this.renderer.locked=l!==h-1,c=this.features[l],this.drawFeature(c)}},display:function(e){OpenLayers.Layer.prototype.display.apply(this,arguments);var t=this.div.style.display;t!=this.renderer.root.style.display&&(this.renderer.root.style.display=t)},addFeatures:function(e,t){OpenLayers.Util.isArray(e)||(e=[e]);var n=!t||!t.silent;if(n){var r={features:e},i=this.events.triggerEvent("beforefeaturesadded",r);if(i===!1)return;e=r.features}var s=[];for(var o=0,u=e.length;o<u;o++){o!=e.length-1?this.renderer.locked=!0:this.renderer.locked=!1;var a=e[o];if(!(!this.geometryType||a.geometry instanceof this.geometryType))throw new TypeError("addFeatures: component should be an "+this.geometryType.prototype.CLASS_NAME);a.layer=this,!a.style&&this.style&&(a.style=OpenLayers.Util.extend({},this.style));if(n){if(this.events.triggerEvent("beforefeatureadded",{feature:a})===!1)continue;this.preFeatureInsert(a)}s.push(a),this.features.push(a),this.drawFeature(a),n&&(this.events.triggerEvent("featureadded",{feature:a}),this.onFeatureInsert(a))}n&&this.events.triggerEvent("featuresadded",{features:s})},removeFeatures:function(e,t){if(!e||e.length===0)return;if(e===this.features)return this.removeAllFeatures(t);OpenLayers.Util.isArray(e)||(e=[e]),e===this.selectedFeatures&&(e=e.slice());var n=!t||!t.silent;n&&this.events.triggerEvent("beforefeaturesremoved",{features:e});for(var r=e.length-1;r>=0;r--){r!=0&&e[r-1].geometry?this.renderer.locked=!0:this.renderer.locked=!1;var i=e[r];delete this.unrenderedFeatures[i.id],n&&this.events.triggerEvent("beforefeatureremoved",{feature:i}),this.features=OpenLayers.Util.removeItem(this.features,i),i.layer=null,i.geometry&&this.renderer.eraseFeatures(i),OpenLayers.Util.indexOf(this.selectedFeatures,i)!=-1&&OpenLayers.Util.removeItem(this.selectedFeatures,i),n&&this.events.triggerEvent("featureremoved",{feature:i})}n&&this.events.triggerEvent("featuresremoved",{features:e})},removeAllFeatures:function(e){var t=!e||!e.silent,n=this.features;t&&this.events.triggerEvent("beforefeaturesremoved",{features:n});var r;for(var i=n.length-1;i>=0;i--)r=n[i],t&&this.events.triggerEvent("beforefeatureremoved",{feature:r}),r.layer=null,t&&this.events.triggerEvent("featureremoved",{feature:r});this.renderer.clear(),this.features=[],this.unrenderedFeatures={},this.selectedFeatures=[],t&&this.events.triggerEvent("featuresremoved",{features:n})},destroyFeatures:function(e,t){var n=e==undefined;n&&(e=this.features);if(e){this.removeFeatures(e,t);for(var r=e.length-1;r>=0;r--)e[r].destroy()}},drawFeature:function(e,t){if(!this.drawn)return;if(typeof t!="object"){!t&&e.state===OpenLayers.State.DELETE&&(t="delete");var n=t||e.renderIntent;t=e.style||this.style,t||(t=this.styleMap.createSymbolizer(e,n))}var r=this.renderer.drawFeature(e,t);r===!1||r===null?this.unrenderedFeatures[e.id]=e:delete this.unrenderedFeatures[e.id]},eraseFeatures:function(e){this.renderer.eraseFeatures(e)},getFeatureFromEvent:function(e){if(!this.renderer)throw new Error("getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.");var t=null,n=this.renderer.getFeatureIdFromEvent(e);return n&&(typeof n=="string"?t=this.getFeatureById(n):t=n),t},getFeatureBy:function(e,t){var n=null;for(var r=0,i=this.features.length;r<i;++r)if(this.features[r][e]==t){n=this.features[r];break}return n},getFeatureById:function(e){return this.getFeatureBy("id",e)},getFeatureByFid:function(e){return this.getFeatureBy("fid",e)},getFeaturesByAttribute:function(e,t){var n,r,i=this.features.length,s=[];for(n=0;n<i;n++)r=this.features[n],r&&r.attributes&&r.attributes[e]===t&&s.push(r);return s},onFeatureInsert:function(e){},preFeatureInsert:function(e){},getDataExtent:function(){var e=null,t=this.features;if(t&&t.length>0){var n=null;for(var r=0,i=t.length;r<i;r++)n=t[r].geometry,n&&(e===null&&(e=new OpenLayers.Bounds),e.extend(n.getBounds()))}return e},CLASS_NAME:"OpenLayers.Layer.Vector"}),OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,sphericalMercator:!1,zoomOffset:0,serverResolutions:null,initialize:function(e,t,n){if(n&&n.sphericalMercator||this.sphericalMercator)n=OpenLayers.Util.extend({projection:"EPSG:900913",numZoomLevels:19},n);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[e||this.name,t||this.url,{},n])},clone:function(e){return e==null&&(e=new OpenLayers.Layer.XYZ(this.name,this.url,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e]),e},getURL:function(e){var t=this.getXYZ(e),n=this.url;if(OpenLayers.Util.isArray(n)){var r=""+t.x+t.y+t.z;n=this.selectUrl(r,n)}return OpenLayers.String.format(n,t)},getXYZ:function(e){var t=this.getServerResolution(),n=Math.round((e.left-this.maxExtent.left)/(t*this.tileSize.w)),r=Math.round((this.maxExtent.top-e.top)/(t*this.tileSize.h)),i=this.getServerZoom();if(this.wrapDateLine){var s=Math.pow(2,i);n=(n%s+s)%s}return{x:n,y:r,z:i}},setMap:function(e){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.XYZ"}),OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15e3,translationParameters:null,symbolMetrics:null,initialize:function(e){if(!this.supported())return;OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments),this.translationParameters={x:0,y:0},this.symbolMetrics={}},supported:function(){var e="http://www.w3.org/TR/SVG11/feature#";return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature(e+"SVG","1.1")||document.implementation.hasFeature(e+"BasicStructure","1.1"))},inValidRange:function(e,t,n){var r=e+(n?0:this.translationParameters.x),i=t+(n?0:this.translationParameters.y);return r>=-this.MAX_PIXEL&&r<=this.MAX_PIXEL&&i>=-this.MAX_PIXEL&&i<=this.MAX_PIXEL},setExtent:function(e,t){var n=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),r=this.getResolution(),i=-e.left/r,s=e.top/r;if(t){this.left=i,this.top=s;var o="0 0 "+this.size.w+" "+this.size.h;return this.rendererRoot.setAttributeNS(null,"viewBox",o),this.translate(this.xOffset,0),!0}var u=this.translate(i-this.left+this.xOffset,s-this.top);return u||this.setExtent(e,!0),n&&u},translate:function(e,t){if(!this.inValidRange(e,t,!0))return!1;var n="";if(e||t)n="translate("+e+","+t+")";return this.root.setAttributeNS(null,"transform",n),this.translationParameters={x:e,y:t},!0},setSize:function(e){OpenLayers.Renderer.prototype.setSize.apply(this,arguments),this.rendererRoot.setAttributeNS(null,"width",this.size.w),this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(e,t){var n=null;switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":t.externalGraphic?n="image":this.isComplexSymbol(t.graphicName)?n="svg":n="circle";break;case"OpenLayers.Geometry.Rectangle":n="rect";break;case"OpenLayers.Geometry.LineString":n="polyline";break;case"OpenLayers.Geometry.LinearRing":n="polygon";break;case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve"
:n="path";break;default:}return n},setStyle:function(e,t,n){t=t||e._style,n=n||e._options;var r=parseFloat(e.getAttributeNS(null,"r")),i=1,s;if(e._geometryClass=="OpenLayers.Geometry.Point"&&r){e.style.visibility="";if(t.graphic===!1)e.style.visibility="hidden";else if(t.externalGraphic){s=this.getPosition(e);if(t.graphicTitle){e.setAttributeNS(null,"title",t.graphicTitle);var o=e.getElementsByTagName("title");if(o.length>0)o[0].firstChild.textContent=t.graphicTitle;else{var u=this.nodeFactory(null,"title");u.textContent=t.graphicTitle,e.appendChild(u)}}t.graphicWidth&&t.graphicHeight&&e.setAttributeNS(null,"preserveAspectRatio","none");var a=t.graphicWidth||t.graphicHeight,f=t.graphicHeight||t.graphicWidth;a=a?a:t.pointRadius*2,f=f?f:t.pointRadius*2;var l=t.graphicXOffset!=undefined?t.graphicXOffset:-(.5*a),c=t.graphicYOffset!=undefined?t.graphicYOffset:-(.5*f),h=t.graphicOpacity||t.fillOpacity;e.setAttributeNS(null,"x",(s.x+l).toFixed()),e.setAttributeNS(null,"y",(s.y+c).toFixed()),e.setAttributeNS(null,"width",a),e.setAttributeNS(null,"height",f),e.setAttributeNS(this.xlinkns,"href",t.externalGraphic),e.setAttributeNS(null,"style","opacity: "+h),e.onclick=OpenLayers.Renderer.SVG.preventDefault}else if(this.isComplexSymbol(t.graphicName)){var p=t.pointRadius*3,d=p*2,v=this.importSymbol(t.graphicName);s=this.getPosition(e),i=this.symbolMetrics[v.id][0]*3/d;var m=e.parentNode,g=e.nextSibling;m&&m.removeChild(e),e.firstChild&&e.removeChild(e.firstChild),e.appendChild(v.firstChild.cloneNode(!0)),e.setAttributeNS(null,"viewBox",v.getAttributeNS(null,"viewBox")),e.setAttributeNS(null,"width",d),e.setAttributeNS(null,"height",d),e.setAttributeNS(null,"x",s.x-p),e.setAttributeNS(null,"y",s.y-p),g?m.insertBefore(e,g):m&&m.appendChild(e)}else e.setAttributeNS(null,"r",t.pointRadius);var y=t.rotation;if((y!==undefined||e._rotation!==undefined)&&s){e._rotation=y,y|=0;if(e.nodeName!=="svg")e.setAttributeNS(null,"transform","rotate("+y+" "+s.x+" "+s.y+")");else{var b=this.symbolMetrics[v.id];e.firstChild.setAttributeNS(null,"transform","rotate("+y+" "+b[1]+" "+b[2]+")")}}}return n.isFilled?(e.setAttributeNS(null,"fill",t.fillColor),e.setAttributeNS(null,"fill-opacity",t.fillOpacity)):e.setAttributeNS(null,"fill","none"),n.isStroked?(e.setAttributeNS(null,"stroke",t.strokeColor),e.setAttributeNS(null,"stroke-opacity",t.strokeOpacity),e.setAttributeNS(null,"stroke-width",t.strokeWidth*i),e.setAttributeNS(null,"stroke-linecap",t.strokeLinecap||"round"),e.setAttributeNS(null,"stroke-linejoin","round"),t.strokeDashstyle&&e.setAttributeNS(null,"stroke-dasharray",this.dashStyle(t,i))):e.setAttributeNS(null,"stroke","none"),t.pointerEvents&&e.setAttributeNS(null,"pointer-events",t.pointerEvents),t.cursor!=null&&e.setAttributeNS(null,"cursor",t.cursor),e},dashStyle:function(e,t){var n=e.strokeWidth*t,r=e.strokeDashstyle;switch(r){case"solid":return"none";case"dot":return[1,4*n].join();case"dash":return[4*n,4*n].join();case"dashdot":return[4*n,4*n,1,4*n].join();case"longdash":return[8*n,4*n].join();case"longdashdot":return[8*n,4*n,1,4*n].join();default:return OpenLayers.String.trim(r).replace(/\s+/g,",")}},createNode:function(e,t){var n=document.createElementNS(this.xmlns,e);return t&&n.setAttributeNS(null,"id",t),n},nodeTypeCompare:function(e,t){return t==e.nodeName},createRenderRoot:function(){var e=this.nodeFactory(this.container.id+"_svgRoot","svg");return e.style.display="block",e},createRoot:function(e){return this.nodeFactory(this.container.id+e,"g")},createDefs:function(){var e=this.nodeFactory(this.container.id+"_defs","defs");return this.rendererRoot.appendChild(e),e},drawPoint:function(e,t){return this.drawCircle(e,t,1)},drawCircle:function(e,t,n){var r=this.getResolution(),i=(t.x-this.featureDx)/r+this.left,s=this.top-t.y/r;return this.inValidRange(i,s)?(e.setAttributeNS(null,"cx",i),e.setAttributeNS(null,"cy",s),e.setAttributeNS(null,"r",n),e):!1},drawLineString:function(e,t){var n=this.getComponentsString(t.components);return n.path?(e.setAttributeNS(null,"points",n.path),n.complete?e:null):!1},drawLinearRing:function(e,t){var n=this.getComponentsString(t.components);return n.path?(e.setAttributeNS(null,"points",n.path),n.complete?e:null):!1},drawPolygon:function(e,t){var n="",r=!0,i=!0,s,o;for(var u=0,a=t.components.length;u<a;u++)n+=" M",s=this.getComponentsString(t.components[u].components," "),o=s.path,o?(n+=" "+o,i=s.complete&&i):r=!1;return n+=" z",r?(e.setAttributeNS(null,"d",n),e.setAttributeNS(null,"fill-rule","evenodd"),i?e:null):!1},drawRectangle:function(e,t){var n=this.getResolution(),r=(t.x-this.featureDx)/n+this.left,i=this.top-t.y/n;return this.inValidRange(r,i)?(e.setAttributeNS(null,"x",r),e.setAttributeNS(null,"y",i),e.setAttributeNS(null,"width",t.width/n),e.setAttributeNS(null,"height",t.height/n),e):!1},drawText:function(e,t,n){var r=!!t.labelOutlineWidth;if(r){var i=OpenLayers.Util.extend({},t);i.fontColor=i.labelOutlineColor,i.fontStrokeColor=i.labelOutlineColor,i.fontStrokeWidth=t.labelOutlineWidth,delete i.labelOutlineWidth,this.drawText(e,i,n)}var s=this.getResolution(),o=(n.x-this.featureDx)/s+this.left,u=n.y/s-this.top,a=r?this.LABEL_OUTLINE_SUFFIX:this.LABEL_ID_SUFFIX,f=this.nodeFactory(e+a,"text");f.setAttributeNS(null,"x",o),f.setAttributeNS(null,"y",-u),t.fontColor&&f.setAttributeNS(null,"fill",t.fontColor),t.fontStrokeColor&&f.setAttributeNS(null,"stroke",t.fontStrokeColor),t.fontStrokeWidth&&f.setAttributeNS(null,"stroke-width",t.fontStrokeWidth),t.fontOpacity&&f.setAttributeNS(null,"opacity",t.fontOpacity),t.fontFamily&&f.setAttributeNS(null,"font-family",t.fontFamily),t.fontSize&&f.setAttributeNS(null,"font-size",t.fontSize),t.fontWeight&&f.setAttributeNS(null,"font-weight",t.fontWeight),t.fontStyle&&f.setAttributeNS(null,"font-style",t.fontStyle),t.labelSelect===!0?(f.setAttributeNS(null,"pointer-events","visible"),f._featureId=e):f.setAttributeNS(null,"pointer-events","none");var l=t.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;f.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[l[0]]||"middle"),OpenLayers.IS_GECKO===!0&&f.setAttributeNS(null,"dominant-baseline",OpenLayers.Renderer.SVG.LABEL_ALIGN[l[1]]||"central");var c=t.label.split("\n"),h=c.length;while(f.childNodes.length>h)f.removeChild(f.lastChild);for(var p=0;p<h;p++){var d=this.nodeFactory(e+a+"_tspan_"+p,"tspan");t.labelSelect===!0&&(d._featureId=e,d._geometry=n,d._geometryClass=n.CLASS_NAME),OpenLayers.IS_GECKO===!1&&d.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[l[1]]||"-35%"),d.setAttribute("x",o);if(p==0){var v=OpenLayers.Renderer.SVG.LABEL_VFACTOR[l[1]];v==null&&(v=-0.5),d.setAttribute("dy",v*(h-1)+"em")}else d.setAttribute("dy","1em");d.textContent=c[p]===""?" ":c[p],d.parentNode||f.appendChild(d)}f.parentNode||this.textRoot.appendChild(f)},getComponentsString:function(e,t){var n=[],r=!0,i=e.length,s=[],o,u;for(var a=0;a<i;a++)u=e[a],n.push(u),o=this.getShortString(u),o?s.push(o):(a>0&&this.getShortString(e[a-1])&&s.push(this.clipLine(e[a],e[a-1])),a<i-1&&this.getShortString(e[a+1])&&s.push(this.clipLine(e[a],e[a+1])),r=!1);return{path:s.join(t||","),complete:r}},clipLine:function(e,t){if(t.equals(e))return"";var n=this.getResolution(),r=this.MAX_PIXEL-this.translationParameters.x,i=this.MAX_PIXEL-this.translationParameters.y,s=(t.x-this.featureDx)/n+this.left,o=this.top-t.y/n,u=(e.x-this.featureDx)/n+this.left,a=this.top-e.y/n,f;if(u<-r||u>r)f=(a-o)/(u-s),u=u<0?-r:r,a=o+(u-s)*f;if(a<-i||a>i)f=(u-s)/(a-o),a=a<0?-i:i,u=s+(a-o)*f;return u+","+a},getShortString:function(e){var t=this.getResolution(),n=(e.x-this.featureDx)/t+this.left,r=this.top-e.y/t;return this.inValidRange(n,r)?n+","+r:!1},getPosition:function(e){return{x:parseFloat(e.getAttributeNS(null,"cx")),y:parseFloat(e.getAttributeNS(null,"cy"))}},importSymbol:function(e){this.defs||(this.defs=this.createDefs());var t=this.container.id+"-"+e,n=document.getElementById(t);if(n!=null)return n;var r=OpenLayers.Renderer.symbol[e];if(!r)throw new Error(e+" is not a valid symbol name");var i=this.nodeFactory(t,"symbol"),s=this.nodeFactory(null,"polygon");i.appendChild(s);var o=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),u=[],a,f;for(var l=0;l<r.length;l+=2)a=r[l],f=r[l+1],o.left=Math.min(o.left,a),o.bottom=Math.min(o.bottom,f),o.right=Math.max(o.right,a),o.top=Math.max(o.top,f),u.push(a,",",f);s.setAttributeNS(null,"points",u.join(" "));var c=o.getWidth(),h=o.getHeight(),p=[o.left-c,o.bottom-h,c*3,h*3];return i.setAttributeNS(null,"viewBox",p.join(" ")),this.symbolMetrics[t]=[Math.max(c,h),o.getCenterLonLat().lon,o.getCenterLonLat().lat],this.defs.appendChild(i),i},getFeatureIdFromEvent:function(e){var t=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);if(!t){var n=e.target;t=n.parentNode&&n!=this.rendererRoot?n.parentNode._featureId:undefined}return t},CLASS_NAME:"OpenLayers.Renderer.SVG"}),OpenLayers.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"},OpenLayers.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"},OpenLayers.Renderer.SVG.LABEL_VFACTOR={t:0,b:-1},OpenLayers.Renderer.SVG.preventDefault=function(e){e.preventDefault&&e.preventDefault()},OpenLayers.Control.ScaleLine=OpenLayers.Class(OpenLayers.Control,{maxWidth:100,topOutUnits:"km",topInUnits:"m",bottomOutUnits:"mi",bottomInUnits:"ft",eTop:null,eBottom:null,geodesic:!1,draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.eTop){this.eTop=document.createElement("div"),this.eTop.className=this.displayClass+"Top";var e=this.topInUnits.length;this.div.appendChild(this.eTop),this.topOutUnits==""||this.topInUnits==""?this.eTop.style.visibility="hidden":this.eTop.style.visibility="visible",this.eBottom=document.createElement("div"),this.eBottom.className=this.displayClass+"Bottom",this.div.appendChild(this.eBottom),this.bottomOutUnits==""||this.bottomInUnits==""?this.eBottom.style.visibility="hidden":this.eBottom.style.visibility="visible"}return this.map.events.register("moveend",this,this.update),this.update(),this.div},getBarLen:function(e){var t=parseInt(Math.log(e)/Math.log(10)),n=Math.pow(10,t),r=parseInt(e/n),i;return r>5?i=5:r>2?i=2:i=1,i*n},update:function(){var e=this.map.getResolution();if(!e)return;var t=this.map.getUnits(),n=OpenLayers.INCHES_PER_UNIT,r=this.maxWidth*e*n[t],i=1;if(this.geodesic===!0){var s=(this.map.getGeodesicPixelSize().w||1e-6)*this.maxWidth,o=r/n.km;i=s/o,r*=i}var u,a;r>1e5?(u=this.topOutUnits,a=this.bottomOutUnits):(u=this.topInUnits,a=this.bottomInUnits);var f=r/n[u],l=r/n[a],c=this.getBarLen(f),h=this.getBarLen(l);f=c/n[t]*n[u],l=h/n[t]*n[a];var p=f/e/i,d=l/e/i;this.eBottom.style.visibility=="visible"&&(this.eBottom.style.width=Math.round(d)+"px",this.eBottom.innerHTML=h+" "+a),this.eTop.style.visibility=="visible"&&(this.eTop.style.width=Math.round(p)+"px",this.eTop.innerHTML=c+" "+u)},CLASS_NAME:"OpenLayers.Control.ScaleLine"}),OpenLayers.Control.PanZoom=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,buttons:null,position:null,initialize:function(e){this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y),OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick),this.removeButtons(),this.buttons=null,this.position=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(e){OpenLayers.Control.prototype.setMap.apply(this,arguments),this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(e){OpenLayers.Control.prototype.draw.apply(this,arguments),e=this.position,this.buttons=[];var t={w:18,h:18},n=new OpenLayers.Pixel(e.x+t.w/2,e.y);return this._addButton("panup","north-mini.png",n,t),e.y=n.y+t.h,this._addButton("panleft","west-mini.png",e,t),this._addButton("panright","east-mini.png",e.add(t.w,0),t),this._addButton("pandown","south-mini.png",n.add(0,t.h*2),t),this._addButton("zoomin","zoom-plus-mini.png",n.add(0,t.h*3+5),t),this._addButton("zoomworld","zoom-world-mini.png",n.add(0,t.h*4+5),t),this._addButton("zoomout","zoom-minus-mini.png",n.add(0,t.h*5+5),t),this.div},_addButton:function(e,t,n,r){var i=OpenLayers.Util.getImageLocation(t),s=OpenLayers.Util.createAlphaImageDiv(this.id+"_"+e,n,r,i,"absolute");return s.style.cursor="pointer",this.div.appendChild(s),s.action=e,s.className="olButton",this.buttons.push(s),s},_removeButton:function(e){this.div.removeChild(e),OpenLayers.Util.removeItem(this.buttons,e)},removeButtons:function(){for(var e=this.buttons.length-1;e>=0;--e)this._removeButton(this.buttons[e])},onButtonClick:function(e){var t=e.buttonElement;switch(t.action){case"panup":this.map.pan(0,-this.getSlideFactor("h"));break;case"pandown":this.map.pan(0,this.getSlideFactor("h"));break;case"panleft":this.map.pan(-this.getSlideFactor("w"),0);break;case"panright":this.map.pan(this.getSlideFactor("w"),0);break;case"zoomin":this.map.zoomIn();break;case"zoomout":this.map.zoomOut();break;case"zoomworld":this.map.zoomToMaxExtent()}},getSlideFactor:function(e){return this.slideRatio?this.map.getSize()[e]*this.slideRatio:this.slideFactor},CLASS_NAME:"OpenLayers.Control.PanZoom"}),OpenLayers.Control.PanZoom.X=4,OpenLayers.Control.PanZoom.Y=4,OpenLayers.Icon=OpenLayers.Class({url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(e,t,n,r){this.url=e,this.size=t||{w:20,h:20},this.offset=n||{x:-(this.size.w/2),y:-(this.size.h/2)},this.calculateOffset=r;var i=OpenLayers.Util.createUniqueID("OL_Icon_");this.imageDiv=OpenLayers.Util.createAlphaImageDiv(i)},destroy:function(){this.erase(),OpenLayers.Event.stopObservingElement(this.imageDiv.firstChild),this.imageDiv.innerHTML="",this.imageDiv=null},clone:function(){return new OpenLayers.Icon(this.url,this.size,this.offset,this.calculateOffset)},setSize:function(e){e!=null&&(this.size=e),this.draw()},setUrl:function(e){e!=null&&(this.url=e),this.draw()},draw:function(e){return OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,"absolute"),this.moveTo(e),this.imageDiv},erase:function(){this.imageDiv!=null&&this.imageDiv.parentNode!=null&&OpenLayers.Element.remove(this.imageDiv)},setOpacity:function(e){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null,null,null,null,e)},moveTo:function(e){e!=null&&(this.px=e),this.imageDiv!=null&&(this.px==null?this.display(!1):(this.calculateOffset&&(this.offset=this.calculateOffset(this.size)),OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,{x:this.px.x+this.offset.x,y:this.px.y+this.offset.y})))},display:function(e){this.imageDiv.style.display=e?"":"none"},isDrawn:function(){var e=this.imageDiv&&this.imageDiv.parentNode&&this.imageDiv.parentNode.nodeType!=11;return e},CLASS_NAME:"OpenLayers.Icon"}),OpenLayers.Marker=OpenLayers.Class({icon:null,lonlat:null,events:null,map:null,initialize:function(e,t){this.lonlat=e;var n=t?t:OpenLayers.Marker.defaultIcon();this.icon==null?this.icon=n:(this.icon.url=n.url,this.icon.size=n.size,this.icon.offset=n.offset,this.icon.calculateOffset=n.calculateOffset),this.events=new OpenLayers.Events(this,this.icon.imageDiv)},destroy:function(){this.erase(),this.map=null,this.events.destroy(),this.events=null,this.icon!=null&&(this.icon.destroy(),this.icon=null)},draw:function(e){return this.icon.draw(e)},erase:function(){this.icon!=null&&this.icon.erase()},moveTo:function(e){e!=null&&this.icon!=null&&this.icon.moveTo(e),this.lonlat=this.map.getLonLatFromLayerPx(e)},isDrawn:function(){var e=this.icon&&this.icon.isDrawn();return e},onScreen:function(){var e=!1;if(this.map){var t=this.map.getExtent();e=t.containsLonLat(this.lonlat)}return e},inflate:function(e){this.icon&&this.icon.setSize({w:this.icon.size.w*e,h:this.icon.size.h*e})},setOpacity:function(e){this.icon.setOpacity(e)},setUrl:function(e){this.icon.setUrl(e)},display:function(e){this.icon.display(e)},CLASS_NAME:"OpenLayers.Marker"}),OpenLayers.Marker.defaultIcon=function(){return new OpenLayers.Icon(OpenLayers.Util.getImageLocation("marker.png"),{w:21,h:25},{x:-10.5,y:-25})},OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],split:function(e,t){var n=null,r=t&&t.mutual,i,s,o,u,a,f=[],l=[e];for(var c=0,h=this.components.length;c<h;++c){s=this.components[c],u=!1;for(var p=0;p<l.length;++p){i=s.split(l[p],t);if(i){if(r){o=i[0];for(var d=0,v=o.length;d<v;++d)d===0&&f.length?f[f.length-1].addComponent(o[d]):f.push(new OpenLayers.Geometry.MultiLineString([o[d]]));u=!0,i=i[1]}if(i.length){i.unshift(p,1),Array.prototype.splice.apply(l,i);break}}}u||(f.length?f[f.length-1].addComponent(s.clone()):f=[new OpenLayers.Geometry.MultiLineString(s.clone())])}f&&f.length>1?u=!0:f=[],l&&l.length>1?a=!0:l=[];if(u||a)r?n=[f,l]:n=l;return n},splitWith:function(e,t){var n=null,r=t&&t.mutual,i,s,o,u,a,f,l;if(e instanceof OpenLayers.Geometry.LineString){l=[],f=[e];for(var c=0,h=this.components.length;c<h;++c){a=!1,s=this.components[c];for(var p=0;p<f.length;++p){i=f[p].split(s,t);if(i){r&&(o=i[0],o.length&&(o.unshift(p,1),Array.prototype.splice.apply(f,o),p+=o.length-2),i=i[1],i.length===0&&(i=[s.clone()]));for(var d=0,v=i.length;d<v;++d)d===0&&l.length?l[l.length-1].addComponent(i[d]):l.push(new OpenLayers.Geometry.MultiLineString([i[d]]));a=!0}}a||(l.length?l[l.length-1].addComponent(s.clone()):l=[new OpenLayers.Geometry.MultiLineString([s.clone()])])}}else n=e.split(this);f&&f.length>1?u=!0:f=[],l&&l.length>1?a=!0:l=[];if(u||a)r?n=[f,l]:n=l;return n},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"}),OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,{element:null,ovmap:null,size:{w:180,h:90},layers:null,minRectSize:15,minRectDisplayClass:"RectReplacement",minRatio:8,maxRatio:32,mapOptions:null,autoPan:!1,handlers:null,resolutionFactor:1,maximized:!1,initialize:function(e){this.layers=[],this.handlers={},OpenLayers.Control.prototype.initialize.apply(this,[e])},destroy:function(){if(!this.mapDiv)return;this.handlers.click&&this.handlers.click.destroy(),this.handlers.drag&&this.handlers.drag.destroy(),this.ovmap&&this.ovmap.viewPortDiv.removeChild(this.extentRectangle),this.extentRectangle=null,this.rectEvents&&(this.rectEvents.destroy(),this.rectEvents=null),this.ovmap&&(this.ovmap.destroy(),this.ovmap=null),this.element.removeChild(this.mapDiv),this.mapDiv=null,this.div.removeChild(this.element),this.element=null,this.maximizeDiv&&(this.div.removeChild(this.maximizeDiv),this.maximizeDiv=null),this.minimizeDiv&&(this.div.removeChild(this.minimizeDiv),this.minimizeDiv=null),this.map.events.un({buttonclick:this.onButtonClick,moveend:this.update,changebaselayer:this.baseLayerDraw,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(this.layers.length===0){if(!this.map.baseLayer)return this.map.events.register("changebaselayer",this,this.baseLayerDraw),this.div;var e=this.map.baseLayer.clone();this.layers=[e]}this.element=document.createElement("div"),this.element.className=this.displayClass+"Element",this.element.style.display="none",this.mapDiv=document.createElement("div"),this.mapDiv.style.width=this.size.w+"px",this.mapDiv.style.height=this.size.h+"px",this.mapDiv.style.position="relative",this.mapDiv.style.overflow="hidden",this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap"),this.extentRectangle=document.createElement("div"),this.extentRectangle.style.position="absolute",this.extentRectangle.style.zIndex=1e3,this.extentRectangle.className=this.displayClass+"ExtentRectangle",this.element.appendChild(this.mapDiv),this.div.appendChild(this.element);if(!this.outsideViewport){this.div.className+=" "+this.displayClass+"Container";var t=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.displayClass+"MaximizeButton",null,null,t,"absolute"),this.maximizeDiv.style.display="none",this.maximizeDiv.className=this.displayClass+"MaximizeButton olButton",this.div.appendChild(this.maximizeDiv);var t=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv",null,null,t,"absolute"),this.minimizeDiv.style.display="none",this.minimizeDiv.className=this.displayClass+"MinimizeButton olButton",this.div.appendChild(this.minimizeDiv),this.minimizeControl()}else this.element.style.display="";return this.map.getExtent()&&this.update(),this.map.events.on({buttonclick:this.onButtonClick,moveend:this.update,scope:this}),this.maximized&&this.maximizeControl(),this.div},baseLayerDraw:function(){this.draw(),this.map.events.unregister("changebaselayer",this,this.baseLayerDraw)},rectDrag:function(e){var t=this.handlers.drag.last.x-e.x,n=this.handlers.drag.last.y-e.y;if(t!=0||n!=0){var r=this.rectPxBounds.top,i=this.rectPxBounds.left,s=Math.abs(this.rectPxBounds.getHeight()),o=this.rectPxBounds.getWidth(),u=Math.max(0,r-n);u=Math.min(u,this.ovmap.size.h-this.hComp-s);var a=Math.max(0,i-t);a=Math.min(a,this.ovmap.size.w-this.wComp-o),this.setRectPxBounds(new OpenLayers.Bounds(a,u+s,a+o,u))}},mapDivClick:function(e){var t=this.rectPxBounds.getCenterPixel(),n=e.xy.x-t.x,r=e.xy.y-t.y,i=this.rectPxBounds.top,s=this.rectPxBounds.left,o=Math.abs(this.rectPxBounds.getHeight()),u=this.rectPxBounds.getWidth(),a=Math.max(0,i+r);a=Math.min(a,this.ovmap.size.h-o);var f=Math.max(0,s+n);f=Math.min(f,this.ovmap.size.w-u),this.setRectPxBounds(new OpenLayers.Bounds(f,a+o,f+u,a)),this.updateMapToRect()},onButtonClick:function(e){e.buttonElement===this.minimizeDiv?this.minimizeControl():e.buttonElement===this.maximizeDiv&&this.maximizeControl()},maximizeControl:function(e){this.element.style.display="",this.showToggle(!1),e!=null&&OpenLayers.Event.stop(e)},minimizeControl:function(e){this.element.style.display="none",this.showToggle(!0),e!=null&&OpenLayers.Event.stop(e)},showToggle:function(e){this.maximizeDiv.style.display=e?"":"none",this.minimizeDiv.style.display=e?"none":""},update:function(){this.ovmap==null&&this.createMap(),(this.autoPan||!this.isSuitableOverview())&&this.updateOverview(),this.updateRectToMap()},isSuitableOverview:function(){var e=this.map.getExtent(),t=this.map.maxExtent,n=new OpenLayers.Bounds(Math.max(e.left,t.left),Math.max(e.bottom,t.bottom),Math.min(e.right,t.right),Math.min(e.top,t.top));this.ovmap.getProjection()!=this.map.getProjection()&&(n=n.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()));var r=this.ovmap.getResolution()/this.map.getResolution();return r>this.minRatio&&r<=this.maxRatio&&this.ovmap.getExtent().containsBounds(n)},updateOverview:function(){var e=this.map.getResolution(),t=this.ovmap.getResolution(),n=t/e;n>this.maxRatio?t=this.minRatio*e:n<=this.minRatio&&(t=this.maxRatio*e);var r;this.ovmap.getProjection()!=this.map.getProjection()?(r=this.map.center.clone(),r.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())):r=this.map.center,this.ovmap.setCenter(r,this.ovmap.getZoomForResolution(t*this.resolutionFactor)),this.updateRectToMap()},createMap:function(){var e=OpenLayers.Util.extend({controls:[],maxResolution:"auto",fallThrough:!1},this.mapOptions);this.ovmap=new OpenLayers.Map(this.mapDiv,e),this.ovmap.viewPortDiv.appendChild(this.extentRectangle),OpenLayers.Event.stopObserving(window,"unload",this.ovmap.unloadDestroy),this.ovmap.addLayers(this.layers),this.ovmap.zoomToMaxExtent(),this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-right-width")),this.wComp=this.wComp?this.wComp:2,this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-bottom-width")),this.hComp=this.hComp?this.hComp:2,this.handlers.drag=new OpenLayers.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap}),this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.mapDivClick},{single:!0,"double":!1,stopSingle:!0,stopDouble:!0,pixelTolerance:1,map:this.ovmap}),this.handlers.click.activate(),this.rectEvents=new OpenLayers.Events(this,this.extentRectangle,null,!0),this.rectEvents.register("mouseover",this,function(e){!this.handlers.drag.active&&!this.map.dragging&&this.handlers.drag.activate()}),this.rectEvents.register("mouseout",this,function(e){this.handlers.drag.dragging||this.handlers.drag.deactivate()});if(this.ovmap.getProjection()!=this.map.getProjection()){var t=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units,n=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=t&&n?OpenLayers.INCHES_PER_UNIT[t]/OpenLayers.INCHES_PER_UNIT[n]:1}},updateRectToMap:function(){var e;this.ovmap.getProjection()!=this.map.getProjection()?e=this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()):e=this.map.getExtent();var t=this.getRectBoundsFromMapBounds(e);t&&this.setRectPxBounds(t)},updateMapToRect:function(){var e=this.getMapBoundsFromRectBounds(this.rectPxBounds);this.ovmap.getProjection()!=this.map.getProjection()&&(e=e.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject())),this.map.panTo(e.getCenterLonLat())},setRectPxBounds:function(e){var t=Math.max(e.top,0),n=Math.max(e.left,0),r=Math.min(e.top+Math.abs(e.getHeight()),this.ovmap.size.h-this.hComp),i=Math.min(e.left+e.getWidth(),this.ovmap.size.w-this.wComp),s=Math.max(i-n,0),o=Math.max(r-t,0);if(s<this.minRectSize||o<this.minRectSize){this.extentRectangle.className=this.displayClass+this.minRectDisplayClass;var u=n+s/2-this.minRectSize/2,a=t+o/2-this.minRectSize/2;this.extentRectangle.style.top=Math.round(a)+"px",this.extentRectangle.style.left=Math.round(u)+"px",this.extentRectangle.style.height=this.minRectSize+"px",this.extentRectangle.style.width=this.minRectSize+"px"}else this.extentRectangle.className=this.displayClass+"ExtentRectangle",this.extentRectangle.style.top=Math.round(t)+"px",this.extentRectangle.style.left=Math.round(n)+"px",this.extentRectangle.style.height=Math.round(o)+"px",this.extentRectangle.style.width=Math.round(s)+"px";this.rectPxBounds=new OpenLayers.Bounds(Math.round(n),Math.round(r),Math.round(i),Math.round(t))},getRectBoundsFromMapBounds:function(e){var t=this.getOverviewPxFromLonLat({lon:e.left,lat:e.bottom}),n=this.getOverviewPxFromLonLat({lon:e.right,lat:e.top}),r=null;return t&&n&&(r=new OpenLayers.Bounds(t.x,t.y,n.x,n.y)),r},getMapBoundsFromRectBounds:function(e){var t=this.getLonLatFromOverviewPx({x:e.left,y:e.bottom}),n=this.getLonLatFromOverviewPx({x:e.right,y:e.top});return new OpenLayers.Bounds(t.lon,t.lat,n.lon,n.lat)},getLonLatFromOverviewPx:function(e){var t=this.ovmap.size,n=this.ovmap.getResolution(),r=this.ovmap.getExtent().getCenterLonLat(),i=e.x-t.w/2,s=e.y-t.h/2;return{lon:r.lon+i*n,lat:r.lat-s*n}},getOverviewPxFromLonLat:function(e){var t=this.ovmap.getResolution(),n=this.ovmap.getExtent();if(n)return{x:Math.round(1/t*(e.lon-n.left)),y:Math.round(1/t*(n.top-e.lat))}},CLASS_NAME:"OpenLayers.Control.OverviewMap"}),OpenLayers.Layer.Markers=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,markers:null,drawn:!1,initialize:function(e,t){OpenLayers.Layer.prototype.initialize.apply(this,arguments),this.markers=[]},destroy:function(){this.clearMarkers(),this.markers=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setOpacity:function(e){if(e!=this.opacity){this.opacity=e;for(var t=0,n=this.markers.length;t<n;t++)this.markers[t].setOpacity(this.opacity)}},moveTo:function(e,t,n){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);if(t||!this.drawn){for(var r=0,i=this.markers.length;r<i;r++)this.drawMarker(this.markers[r]);this.drawn=!0}},addMarker:function(e){this.markers.push(e),this.opacity<1&&e.setOpacity(this.opacity),this.map&&this.map.getExtent()&&(e.map=this.map,this.drawMarker(e))},removeMarker:function(e){this.markers&&this.markers.length&&(OpenLayers.Util.removeItem(this.markers,e),e.erase())},clearMarkers:function(){if(this.markers!=null)while(this.markers.length>0)this.removeMarker(this.markers[0])},drawMarker:function(e){var t=this.map.getLayerPxFromLonLat(e.lonlat);if(t==null)e.display(!1);else if(!e.isDrawn()){var n=e.draw(t);this.div.appendChild(n)}else e.icon&&e.icon.moveTo(t)},getDataExtent:function(){var e=null;if(this.markers&&this.markers.length>0){var e=new OpenLayers.Bounds;for(var t=0,n=this.markers.length;t<n;t++){var r=this.markers[t];e.extend(r.lonlat)}}return e},CLASS_NAME:"OpenLayers.Layer.Markers"}),OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{hitDetection:!0,hitOverflow:0,canvas:null,features:null,pendingRedraw:!1,cachedSymbolBounds:{},initialize:function(e,t){OpenLayers.Renderer.prototype.initialize.apply(this,arguments),this.root=document.createElement("canvas"),this.container.appendChild(this.root),this.canvas=this.root.getContext("2d"),this.features={},this.hitDetection&&(this.hitCanvas=document.createElement("canvas"),this.hitContext=this.hitCanvas.getContext("2d"))},setExtent:function(){return OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),!1},eraseGeometry:function(e,t){this.eraseFeatures(this.features[t][0])},supported:function(){return OpenLayers.CANVAS_SUPPORTED},setSize:function(e){this.size=e.clone();var t=this.root;t.style.width=e.w+"px",t.style.height=e.h+"px",t.width=e.w,t.height=e.h,this.resolution=null;if(this.hitDetection){var n=this.hitCanvas;n.style.width=e.w+"px",n.style.height=e.h+"px",n.width=e.w,n.height=e.h}},drawFeature:function(e,t){var n;if(e.geometry){t=this.applyDefaultSymbolizer(t||e.style);var r=e.geometry.getBounds(),i;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(i=this.map.getMaxExtent());var s=r&&r.intersectsBounds(this.extent,{worldBounds:i});n=t.display!=="none"&&!!r&&s,n?this.features[e.id]=[e,t]:delete this.features[e.id],this.pendingRedraw=!0}return this.pendingRedraw&&!this.locked&&(this.redraw(),this.pendingRedraw=!1),n},drawGeometry:function(e,t,n){var r=e.CLASS_NAME;if(r=="OpenLayers.Geometry.Collection"||r=="OpenLayers.Geometry.MultiPoint"||r=="OpenLayers.Geometry.MultiLineString"||r=="OpenLayers.Geometry.MultiPolygon"){for(var i=0;i<e.components.length;i++)this.drawGeometry(e.components[i],t,n);return}switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":this.drawPoint(e,t,n);break;case"OpenLayers.Geometry.LineString":this.drawLineString(e,t,n);break;case"OpenLayers.Geometry.LinearRing":this.drawLinearRing(e,t,n);break;case"OpenLayers.Geometry.Polygon":this.drawPolygon(e,t,n);break;default:}},drawExternalGraphic:function(e,t,n){var r=new Image;t.graphicTitle&&(r.title=t.graphicTitle);var i=t.graphicWidth||t.graphicHeight,s=t.graphicHeight||t.graphicWidth;i=i?i:t.pointRadius*2,s=s?s:t.pointRadius*2;var o=t.graphicXOffset!=undefined?t.graphicXOffset:-(.5*i),u=t.graphicYOffset!=undefined?t.graphicYOffset:-(.5*s),a=t.graphicOpacity||t.fillOpacity,f=function(){if(!this.features[n])return;var t=this.getLocalXY(e),f=t[0],l=t[1];if(!isNaN(f)&&!isNaN(l)){var c=f+o|0,h=l+u|0,p=this.canvas;p.globalAlpha=a;var d=OpenLayers.Renderer.Canvas.drawImageScaleFactor||(OpenLayers.Renderer.Canvas.drawImageScaleFactor=/android 2.1/.test(navigator.userAgent.toLowerCase())?320/window.screen.width:1);p.drawImage(r,c*d,h*d,i*d,s*d),this.hitDetection&&(this.setHitContextStyle("fill",n),this.hitContext.fillRect(c,h,i,s))}};r.onload=OpenLayers.Function.bind(f,this),r.src=t.externalGraphic},drawNamedSymbol:function(e,t,n){var r,i,s,o,u,a,f,l,c,h=Math.PI/180,p=OpenLayers.Renderer.symbol[t.graphicName];if(!p)throw new Error(t.graphicName+" is not a valid symbol name");if(!p.length||p.length<2)return;var d=this.getLocalXY(e),v=d[0],m=d[1];if(isNaN(v)||isNaN(m))return;this.canvas.lineCap="round",this.canvas.lineJoin="round",this.hitDetection&&(this.hitContext.lineCap="round",this.hitContext.lineJoin="round");if(t.graphicName in this.cachedSymbolBounds)a=this.cachedSymbolBounds[t.graphicName];else{a=new OpenLayers.Bounds;for(u=0;u<p.length;u+=2)a.extend(new OpenLayers.LonLat(p[u],p[u+1]));this.cachedSymbolBounds[t.graphicName]=a}this.canvas.save(),this.hitDetection&&this.hitContext.save(),this.canvas.translate(v,m),this.hitDetection&&this.hitContext.translate(v,m),l=h*t.rotation,isNaN(l)||(this.canvas.rotate(l),this.hitDetection&&this.hitContext.rotate(l)),f=2*t.pointRadius/Math.max(a.getWidth(),a.getHeight()),this.canvas.scale(f,f),this.hitDetection&&this.hitContext.scale(f,f),s=a.getCenterLonLat().lon,o=a.getCenterLonLat().lat,this.canvas.translate(-s,-o),this.hitDetection&&
this.hitContext.translate(-s,-o),c=t.strokeWidth,t.strokeWidth=c/f;if(t.fill!==!1){this.setCanvasStyle("fill",t),this.canvas.beginPath();for(u=0;u<p.length;u+=2)r=p[u],i=p[u+1],u==0&&this.canvas.moveTo(r,i),this.canvas.lineTo(r,i);this.canvas.closePath(),this.canvas.fill();if(this.hitDetection){this.setHitContextStyle("fill",n,t),this.hitContext.beginPath();for(u=0;u<p.length;u+=2)r=p[u],i=p[u+1],u==0&&this.canvas.moveTo(r,i),this.hitContext.lineTo(r,i);this.hitContext.closePath(),this.hitContext.fill()}}if(t.stroke!==!1){this.setCanvasStyle("stroke",t),this.canvas.beginPath();for(u=0;u<p.length;u+=2)r=p[u],i=p[u+1],u==0&&this.canvas.moveTo(r,i),this.canvas.lineTo(r,i);this.canvas.closePath(),this.canvas.stroke();if(this.hitDetection){this.setHitContextStyle("stroke",n,t,f),this.hitContext.beginPath();for(u=0;u<p.length;u+=2)r=p[u],i=p[u+1],u==0&&this.hitContext.moveTo(r,i),this.hitContext.lineTo(r,i);this.hitContext.closePath(),this.hitContext.stroke()}}t.strokeWidth=c,this.canvas.restore(),this.hitDetection&&this.hitContext.restore(),this.setCanvasStyle("reset")},setCanvasStyle:function(e,t){e==="fill"?(this.canvas.globalAlpha=t.fillOpacity,this.canvas.fillStyle=t.fillColor):e==="stroke"?(this.canvas.globalAlpha=t.strokeOpacity,this.canvas.strokeStyle=t.strokeColor,this.canvas.lineWidth=t.strokeWidth):(this.canvas.globalAlpha=0,this.canvas.lineWidth=1)},featureIdToHex:function(e){var t=Number(e.split("_").pop())+1;t>=16777216&&(this.hitOverflow=t-16777215,t=t%16777216+1);var n="000000"+t.toString(16),r=n.length;return n="#"+n.substring(r-6,r),n},setHitContextStyle:function(e,t,n,r){var i=this.featureIdToHex(t);e=="fill"?(this.hitContext.globalAlpha=1,this.hitContext.fillStyle=i):e=="stroke"?(this.hitContext.globalAlpha=1,this.hitContext.strokeStyle=i,typeof r=="undefined"?this.hitContext.lineWidth=n.strokeWidth+2:isNaN(r)||(this.hitContext.lineWidth=n.strokeWidth+2/r)):(this.hitContext.globalAlpha=0,this.hitContext.lineWidth=1)},drawPoint:function(e,t,n){if(t.graphic!==!1)if(t.externalGraphic)this.drawExternalGraphic(e,t,n);else if(t.graphicName&&t.graphicName!="circle")this.drawNamedSymbol(e,t,n);else{var r=this.getLocalXY(e),i=r[0],s=r[1];if(!isNaN(i)&&!isNaN(s)){var o=Math.PI*2,u=t.pointRadius;t.fill!==!1&&(this.setCanvasStyle("fill",t),this.canvas.beginPath(),this.canvas.arc(i,s,u,0,o,!0),this.canvas.fill(),this.hitDetection&&(this.setHitContextStyle("fill",n,t),this.hitContext.beginPath(),this.hitContext.arc(i,s,u,0,o,!0),this.hitContext.fill())),t.stroke!==!1&&(this.setCanvasStyle("stroke",t),this.canvas.beginPath(),this.canvas.arc(i,s,u,0,o,!0),this.canvas.stroke(),this.hitDetection&&(this.setHitContextStyle("stroke",n,t),this.hitContext.beginPath(),this.hitContext.arc(i,s,u,0,o,!0),this.hitContext.stroke()),this.setCanvasStyle("reset"))}}},drawLineString:function(e,t,n){t=OpenLayers.Util.applyDefaults({fill:!1},t),this.drawLinearRing(e,t,n)},drawLinearRing:function(e,t,n){t.fill!==!1&&(this.setCanvasStyle("fill",t),this.renderPath(this.canvas,e,t,n,"fill"),this.hitDetection&&(this.setHitContextStyle("fill",n,t),this.renderPath(this.hitContext,e,t,n,"fill"))),t.stroke!==!1&&(this.setCanvasStyle("stroke",t),this.renderPath(this.canvas,e,t,n,"stroke"),this.hitDetection&&(this.setHitContextStyle("stroke",n,t),this.renderPath(this.hitContext,e,t,n,"stroke"))),this.setCanvasStyle("reset")},renderPath:function(e,t,n,r,i){var s=t.components,o=s.length;e.beginPath();var u=this.getLocalXY(s[0]),a=u[0],f=u[1];if(!isNaN(a)&&!isNaN(f)){e.moveTo(u[0],u[1]);for(var l=1;l<o;++l){var c=this.getLocalXY(s[l]);e.lineTo(c[0],c[1])}i==="fill"?e.fill():e.stroke()}},drawPolygon:function(e,t,n){var r=e.components,i=r.length;this.drawLinearRing(r[0],t,n);for(var s=1;s<i;++s)this.canvas.globalCompositeOperation="destination-out",this.hitDetection&&(this.hitContext.globalCompositeOperation="destination-out"),this.drawLinearRing(r[s],OpenLayers.Util.applyDefaults({stroke:!1,fillOpacity:1},t),n),this.canvas.globalCompositeOperation="source-over",this.hitDetection&&(this.hitContext.globalCompositeOperation="source-over"),this.drawLinearRing(r[s],OpenLayers.Util.applyDefaults({fill:!1},t),n)},drawText:function(e,t){var n=this.getLocalXY(e);this.setCanvasStyle("reset"),this.canvas.fillStyle=t.fontColor,this.canvas.globalAlpha=t.fontOpacity||1;var r=[t.fontStyle?t.fontStyle:"normal","normal",t.fontWeight?t.fontWeight:"normal",t.fontSize?t.fontSize:"1em",t.fontFamily?t.fontFamily:"sans-serif"].join(" "),i=t.label.split("\n"),s=i.length;if(this.canvas.fillText){this.canvas.font=r,this.canvas.textAlign=OpenLayers.Renderer.Canvas.LABEL_ALIGN[t.labelAlign[0]]||"center",this.canvas.textBaseline=OpenLayers.Renderer.Canvas.LABEL_ALIGN[t.labelAlign[1]]||"middle";var o=OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[1]];o==null&&(o=-0.5);var u=this.canvas.measureText("Mg").height||this.canvas.measureText("xx").width;n[1]+=u*o*(s-1);for(var a=0;a<s;a++)t.labelOutlineWidth&&(this.canvas.save(),this.canvas.strokeStyle=t.labelOutlineColor,this.canvas.lineWidth=t.labelOutlineWidth,this.canvas.strokeText(i[a],n[0],n[1]+u*a+1),this.canvas.restore()),this.canvas.fillText(i[a],n[0],n[1]+u*a)}else if(this.canvas.mozDrawText){this.canvas.mozTextStyle=r;var f=OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[0]];f==null&&(f=-0.5);var o=OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[1]];o==null&&(o=-0.5);var u=this.canvas.mozMeasureText("xx");n[1]+=u*(1+o*s);for(var a=0;a<s;a++){var l=n[0]+f*this.canvas.mozMeasureText(i[a]),c=n[1]+a*u;this.canvas.translate(l,c),this.canvas.mozDrawText(i[a]),this.canvas.translate(-l,-c)}}this.setCanvasStyle("reset")},getLocalXY:function(e){var t=this.getResolution(),n=this.extent,r=(e.x-this.featureDx)/t+ -n.left/t,i=n.top/t-e.y/t;return[r,i]},clear:function(){var e=this.root.height,t=this.root.width;this.canvas.clearRect(0,0,t,e),this.features={},this.hitDetection&&this.hitContext.clearRect(0,0,t,e)},getFeatureIdFromEvent:function(e){var t,n;if(this.hitDetection&&this.root.style.display!=="none"&&!this.map.dragging){var r=e.xy,i=r.x|0,s=r.y|0,o=this.hitContext.getImageData(i,s,1,1).data;if(o[3]===255){var u=o[2]+256*(o[1]+256*o[0]);if(u){t="OpenLayers.Feature.Vector_"+(u-1+this.hitOverflow);try{n=this.features[t][0]}catch(a){}}}}return n},eraseFeatures:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=0;t<e.length;++t)delete this.features[e[t].id];this.redraw()},redraw:function(){if(!this.locked){var e=this.root.height,t=this.root.width;this.canvas.clearRect(0,0,t,e),this.hitDetection&&this.hitContext.clearRect(0,0,t,e);var n=[],r,i,s,o=this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent();for(var u in this.features){if(!this.features.hasOwnProperty(u))continue;r=this.features[u][0],i=r.geometry,this.calculateFeatureDx(i.getBounds(),o),s=this.features[u][1],this.drawGeometry(i,s,r.id),s.label&&n.push([r,s])}var a;for(var f=0,l=n.length;f<l;++f)a=n[f],this.drawText(a[0].geometry.getCentroid(),a[1])}},CLASS_NAME:"OpenLayers.Renderer.Canvas"}),OpenLayers.Renderer.Canvas.LABEL_ALIGN={l:"left",r:"right",t:"top",b:"bottom"},OpenLayers.Renderer.Canvas.LABEL_FACTOR={l:0,r:-1,t:0,b:-1},OpenLayers.Renderer.Canvas.drawImageScaleFactor=null,OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"});