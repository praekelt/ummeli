{% extends "base.xml" %}

{% block title %}
    Ummeli
{% endblock %}

{% block content %}
    <HEADER><LABEL>Profile</LABEL></HEADER>
    <CONTAINER type="data">
    {% if is_self %}
        <LINK href="{% url profile %}?{{uuid}}">
            <TEXT>[edit your profile]</TEXT>
        </LINK><br/>
    {% endif %}
    </CONTAINER>
    <CONTAINER type="list">
        {% if not connected_to_user and not is_self %}
            {% if not already_requested %}
                {% if connection_requested %}
                    <LINK href="{% url confirm_request other_user_pk %}?next={{request.path}}&{{uuid}}">
                        <TEXT>[+ accept]</TEXT>
                    </LINK>
                    <LINK href="{% url reject_request other_user_pk %}?next={{request.path}}&{{uuid}}">
                        <TEXT>[- reject]</TEXT>
                    </LINK>
                {% else %}
                    <LINK href="{% url add_connection other_user_pk %}?next={{request.path}}&{{uuid}}">
                        <TEXT>[+ connect]</TEXT>
                    </LINK>
                {% endif %}
            {% else %}
                <TEXT>[request pending]</TEXT>
            {% endif %}
        {% endif %}
    </CONTAINER>
    <CONTAINER type="data">
        <LINK href="{% url connections other_user_pk %}?{{uuid}}">
            <TEXT>Connections ({{num_connections}})</TEXT>
        </LINK><br/>
        <LINK href="{% url connection_requests %}?{{uuid}}">
            <TEXT>Requests ({{user_profile.connection_requests.count}})</TEXT>
        </LINK><br/>
    </CONTAINER>
</MODULE>
    
    {% if connected_to_user or is_self %}
        {% include "user_profile_detailed.html" with a_user_profile=other_user_profile, user_is_self=is_self %}
    {% endif %}

{% endblock %}
