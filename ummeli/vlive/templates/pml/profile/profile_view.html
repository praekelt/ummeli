{% extends "base.xml" %}

{% block title %}
    Ummeli
{% endblock %}

{% block content %}
    <HEADER><LABEL>Profile</LABEL></HEADER>
    <CONTAINER type="data">
    <TEXT>
    {% if is_self %}
        <LINK href="{% url profile %}?{{uuid}}">
            <TEXT>[edit your profile]</TEXT>
        </LINK><br/>
    {% endif %}
    </TEXT>
    </CONTAINER>
    <CONTAINER type="data">
    <TEXT>
        {{other_user_profile.fullname}} <br/>
        {% if not connected_to_user and not is_self %}
            {% if not already_requested %}
                {% if connection_requested %}
                    <LINK href="{% url confirm_request other_user_pk %}?next={{request.path}}&amp;{{uuid}}">
                        <TEXT>[+ accept]</TEXT>
                    </LINK><br/>
                    <LINK href="{% url reject_request other_user_pk %}?next={{request.path}}&amp;{{uuid}}">
                        <TEXT>[- reject]</TEXT>
                    </LINK><br/>
                {% else %}
                    <LINK href="{% url add_connection other_user_pk %}?next={{request.path}}&amp;{{uuid}}">
                        <TEXT>[+ connect]</TEXT>
                    </LINK><br/>
                {% endif %}
            {% else %}
                <TEXT>[request pending]</TEXT><br/>
            {% endif %}
        {% endif %}
    </TEXT>
    </CONTAINER>
    <CONTAINER type="data">
    <TEXT>
        <LINK href="{% url connections other_user_pk %}?{{uuid}}">
            <TEXT>Connections ({{num_connections}})</TEXT>
        </LINK><br/>
    {% if is_self %}
        <LINK href="{% url connection_requests %}?{{uuid}}">
            <TEXT>Requests ({{user_profile.connection_requests.count}})</TEXT>
        </LINK><br/>
    {% endif %}
    </TEXT>
    </CONTAINER>    

    {% if connected_to_user or is_self %}
</MODULE>
        {% include "profile/user_profile_detailed.html" with a_user_profile=other_user_profile user_is_self=is_self %}
    {% else %}
</MODULE>
        {% include "profile/user_profile_basic.html" with a_user_profile=other_user_profile %}    
    {% endif %}

{% endblock %}
